<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Amazon EC2 Template Snippets - AWS CloudFormation</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="home" href="#top">
      <link rel="up" href="CHAP_TemplateQuickRef.html" title="Template Snippets">
      <link rel="prev" href="quickref-dynamodb.html" title="Amazon DynamoDB Template Snippets">
      <link rel="next" href="quickref-ecs.html" title="Amazon Elastic Container Service Template Snippets">
      <meta name="description" content="Use these sample template snippets with your Amazon EC2 instances with AWS CloudFormation.">
      <meta name="keywords" content="CloudFormation,AWSCloudFormation,resource provisioning,resource configuration,infrastructure management,CloudFormer,CloudFormation Designer,CloudFormation stack,CloudFormation stackset,CloudFormation template,change set">
      <meta name="deployment_region" content="IAD">
      <meta name="product" content="AWS CloudFormation">
      <meta name="guide" content="User Guide">
      <meta name="guide-locale" content="en_us">
      <link rel="icon" type="image/ico" href="/images/favicon.ico">
      <link rel="shortcut icon" type="image/ico" href="/images/favicon.ico">
      <link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/quickref-ec2.html">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/font-awesome.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/google-font.css">
      <link id="code-style" rel="stylesheet" type="text/css" href="../../../css/light.css">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.theme.css">
      <link rel="stylesheet" type="text/css" href="../../../css/colorbox.css">
      <link rel="stylesheet" type="text/css" href="../../../css/awsdocs.css"><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="/js/jquery-ui.min.js"></script><script type="text/javascript" src="/js/handlebars.js"></script><script type="text/javascript" src="/js/jquery.colorbox.js"></script><script type="text/javascript" src="/js/awsdocs.min.js?v=20170615"></script></head>
   <body id="top">
      
      <div id="content-container">
         
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tbody><tr>
                           <td>
                              <div class="breadcrumb"><a href="http://aws.amazon.com/documentation">AWS Documentation</a> &#xBB; <a href="http://aws.amazon.com/documentation/cloudformation">AWS CloudFormation</a> &#xBB; <a href="index.html">User Guide</a> &#xBB; <a href="template-guide.html">Working with AWS CloudFormation Templates</a> &#xBB; <a href="CHAP_TemplateQuickRef.html">Template Snippets</a> &#xBB; <span class="breadcrumb">Amazon EC2 Template Snippets</span></div>
                           </td>
                        </tr>
                     </tbody></table>
                     <div></div>
                     <div id="language-filter" class="page-header" style="display:none">
                        <form> Filter View: 
                           <select name="filter-select" id="filter-select">
                              <option selected="1">All</option>
                              <option value="JSON" selected>JSON</option>
                              <option value="YAML" selected>YAML</option></select></form>
                     </div>
                     <h1 class="topictitle" id="quickref-ec2">Amazon EC2 Template Snippets</h1>
                     <h2 id="scenario-ec2-bdm">EC2 Block Device Mapping Examples</h2>
                     
                     
                     <h3 id="w2ab2c17c24c39b3b2">EC2 Instance with Block Device Mapping</h3>
                     
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h4 id="quickref-ec2-example-1.json">JSON</h4>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">    &quot;Ec2Instance&quot; : {
      &quot;Type&quot; : &quot;AWS::EC2::Instance&quot;, 
      &quot;Properties&quot; : {
        &quot;ImageId&quot; : { &quot;Fn::FindInMap&quot; : [ &quot;AWSRegionArch2AMI&quot;, { &quot;Ref&quot; : &quot;AWS::Region&quot; }, 
                                          { &quot;Fn::FindInMap&quot; : [ &quot;AWSInstanceType2Arch&quot;, { &quot;Ref&quot; : &quot;InstanceType&quot; }, &quot;Arch&quot; ] } ] },
        &quot;KeyName&quot; : { &quot;Ref&quot; : &quot;KeyName&quot; },
        &quot;InstanceType&quot; : { &quot;Ref&quot; : &quot;InstanceType&quot; },
        &quot;SecurityGroups&quot; : [{ &quot;Ref&quot; : &quot;Ec2SecurityGroup&quot; }],
        &quot;BlockDeviceMappings&quot; : [
          {
            &quot;DeviceName&quot; : &quot;/dev/sda1&quot;,
            &quot;Ebs&quot; : { &quot;VolumeSize&quot; : &quot;50&quot; } 
          },{
            &quot;DeviceName&quot; : &quot;/dev/sdm&quot;,
            &quot;Ebs&quot; : { &quot;VolumeSize&quot; : &quot;100&quot; }
          }
        ]
      }
    }</code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h4 id="quickref-ec2-example-1.yaml">YAML</h4>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">EC2Instance:
    Type: AWS::EC2::Instance
    Properties:
        ImageId: !FindInMap [ AWSRegionArch2AMI, !Ref &apos;AWS::Region&apos; , !FindInMap [ AWSInstanceType2Arch, !Ref InstanceType, Arch ] ]
        KeyName: !Ref KeyName
        InstanceType: !Ref InstanceType
        SecurityGroups:
        - !Ref Ec2SecurityGroup
        BlockDeviceMappings:
        -
          DeviceName: /dev/sda1
          Ebs:
            VolumeSize: 50
        -
          DeviceName: /dev/sdm
          Ebs:
            VolumeSize: 100</code></pre>
                        </div>
                     
                     
                     <h3 id="w2ab2c17c24c39b3b4">EC2 Instance with Ephemeral Drives</h3>
                     
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h4 id="quickref-ec2-example-2.json">JSON</h4>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">    &quot;Ec2Instance&quot; : {
      &quot;Type&quot; : &quot;AWS::EC2::Instance&quot;, 
      &quot;Properties&quot; : {
        &quot;ImageId&quot; : { &quot;Fn::FindInMap&quot; : [ &quot;AWSRegionArch2AMI&quot;, { &quot;Ref&quot; : &quot;AWS::Region&quot; }, &quot;PV64&quot; ]},
        &quot;KeyName&quot; : { &quot;Ref&quot; : &quot;KeyName&quot; },
        &quot;InstanceType&quot; : &quot;m1.small&quot;,
        &quot;SecurityGroups&quot; : [{ &quot;Ref&quot; : &quot;Ec2SecurityGroup&quot; }],
        &quot;BlockDeviceMappings&quot; : [
          {
            &quot;DeviceName&quot;  : &quot;/dev/sdc&quot;,
            &quot;VirtualName&quot; : &quot;ephemeral0&quot;
          }
        ]
      }
    }</code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h4 id="quickref-ec2-example-2.yaml">YAML</h4>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">EC2Instance:
	Type: AWS::EC2::Instance
	Properties:
	  ImageId: !FindInMap [ AWSRegionArch2AMI, !Ref &apos;AWS::Region&apos;, PV64 ]
	  KeyName: !Ref KeyName
	  InstanceType: m1.small
	  SecurityGroups:
	  - !Ref Ec2SecurityGroup
	  BlockDeviceMappings:
	 	  -
	      DeviceName: /dev/sdc
	      VirtualName: ephemeral0</code></pre>
                        </div>
                     
                     
                     <h2 id="scenario-ec2-eip">Assigning an Amazon EC2 Elastic IP Using AWS::EC2::EIP
                        Snippet
                     </h2>
                     
                     
                     <p>This example shows how to allocate an Amazon EC2 Elastic IP address and assign it
                        to an
                        Amazon EC2 instance using a <a href="aws-properties-ec2-eip.html">AWS::EC2::EIP
                           resource</a>.
                     </p>
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h3 id="quickref-ec2-example-3.json">JSON</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">&quot;MyEIP&quot; : {
 &quot;Type&quot; : &quot;AWS::EC2::EIP&quot;,
 &quot;Properties&quot; : {
     &quot;InstanceId&quot; : { &quot;Ref&quot; : &quot;<em class="replaceable"><code>logical name of an AWS::EC2::Instance resource</code></em>&quot; }
 }
}</code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h3 id="quickref-ec2-example-3.yaml">YAML</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">MyEIP:
  Type: AWS::EC2::EIP
  Properties:
    InstanceId: !Ref Logical name of an AWS::EC2::Instance resource</code></pre>
                        </div>
                     
                     <h2 id="scenario-ec2-eip-association">Assigning an Existing Elastic IP to an Amazon
                        EC2 instance using AWS::EC2::EIPAssociation Snippet
                     </h2>
                     
                     
                     <p>This example shows how to assign an existing Amazon EC2 Elastic IP address to an Amazon
                        EC2
                        instance using an <a href="aws-properties-ec2-eip-association.html">AWS::EC2::EIPAssociation resource</a>.
                     </p>
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h3 id="quickref-ec2-example-4.json">JSON</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">&quot;IPAssoc&quot; : {
         &quot;Type&quot; : &quot;AWS::EC2::EIPAssociation&quot;,
         &quot;Properties&quot; : {
             &quot;InstanceId&quot; : { &quot;Ref&quot; : &quot;<em class="replaceable"><code>logical name of an AWS::EC2::Instance resource</code></em>&quot; },
             &quot;EIP&quot; : &quot;<em class="replaceable"><code>existing Elastic IP address</code></em>&quot;
         }
     }

</code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h3 id="quickref-ec2-example-4.yaml">YAML</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">IPAssoc:
  Type: AWS::EC2::EIPAssociation
  Properties:
    InstanceId: !Ref <em class="replaceable"><code>Logical name of an AWS::EC2::Instance resource</code></em>
    EIP: <em class="replaceable"><code>existing Elastic IP Address</code></em></code></pre>
                        </div>
                     
                     <h2 id="scenario-ec2-eip-association-vpc">Assigning an Existing VPC Elastic IP to
                        an Amazon EC2 instance using AWS::EC2::EIPAssociation Snippet
                     </h2>
                     
                     
                     <p>This example shows how to assign an existing VPC Elastic IP address to an Amazon EC2
                        instance using an <a href="aws-properties-ec2-eip-association.html">AWS::EC2::EIPAssociation resource</a>.
                     </p>
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h3 id="quickref-ec2-example-5.json">JSON</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">&quot;VpcIPAssoc&quot; : {
         &quot;Type&quot; : &quot;AWS::EC2::EIPAssociation&quot;,
         &quot;Properties&quot; : {
             &quot;InstanceId&quot; : { &quot;Ref&quot; : &quot;<em class="replaceable"><code>logical name of an AWS::EC2::Instance resource</code></em>&quot; },
             &quot;AllocationId&quot; : &quot;<em class="replaceable"><code>existing VPC Elastic IP allocation ID</code></em>&quot;
         }
     }

</code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h3 id="quickref-ec2-example-5.yaml">YAML</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">VpcIPAssoc:
  Type: AWS::EC2::EIPAssociation
  Properties:
    InstanceId: !Ref <em class="replaceable"><code>Logical name of an AWS::EC2::Instance resource</code></em>
    AllocationId: <em class="replaceable"><code>Existing VPC Elastic IP allocation ID</code></em></code></pre>
                        </div>
                     
                     
                     <h2 id="cfn-template-snippets-eni">Elastic Network Interface (ENI) Template
                        Snippets
                     </h2>
                     
                     
                     <h3 id="w2ab2c17c24c39c13b3">VPC_EC2_Instance_With_ENI</h3>
                     
                     
                     <p>Sample template showing how to create an instance with two elastic network interface
                        (ENI). The sample assumes you have already created a VPC. 
                     </p>
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h4 id="cfn-template-snippets-eni-example-1.json">JSON</h4>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">  &quot;Resources&quot; : {
    &quot;ControlPortAddress&quot; : {
      &quot;Type&quot; : &quot;AWS::EC2::EIP&quot;,
      &quot;Properties&quot; : {
        &quot;Domain&quot; : &quot;vpc&quot;
      }
    },
    &quot;AssociateControlPort&quot; : {
      &quot;Type&quot; : &quot;AWS::EC2::EIPAssociation&quot;,
      &quot;Properties&quot; : {
        &quot;AllocationId&quot; : { &quot;Fn::GetAtt&quot; : [ &quot;ControlPortAddress&quot;, &quot;AllocationId&quot; ]},
        &quot;NetworkInterfaceId&quot; : { &quot;Ref&quot; : &quot;controlXface&quot; }
      }
    },
    &quot;WebPortAddress&quot; : {
      &quot;Type&quot; : &quot;AWS::EC2::EIP&quot;,
      &quot;Properties&quot; : {
        &quot;Domain&quot; : &quot;vpc&quot;
      }
    },
    &quot;AssociateWebPort&quot; : {
      &quot;Type&quot; : &quot;AWS::EC2::EIPAssociation&quot;,
      &quot;Properties&quot; : {
        &quot;AllocationId&quot; : { &quot;Fn::GetAtt&quot; : [ &quot;WebPortAddress&quot;, &quot;AllocationId&quot; ]},
        &quot;NetworkInterfaceId&quot; : { &quot;Ref&quot; : &quot;webXface&quot; }
      }
    },
    &quot;SSHSecurityGroup&quot; : {
      &quot;Type&quot; : &quot;AWS::EC2::SecurityGroup&quot;,
      &quot;Properties&quot; : {
        &quot;VpcId&quot; : { &quot;Ref&quot; : &quot;VpcId&quot; },
        &quot;GroupDescription&quot; : &quot;Enable SSH access via port 22&quot;,
        &quot;SecurityGroupIngress&quot; : [ { &quot;IpProtocol&quot; : &quot;tcp&quot;, &quot;FromPort&quot; : &quot;22&quot;, &quot;ToPort&quot; : &quot;22&quot;, &quot;CidrIp&quot; : &quot;0.0.0.0/0&quot; } ]
      }
    },
    &quot;WebSecurityGroup&quot; : {
      &quot;Type&quot; : &quot;AWS::EC2::SecurityGroup&quot;,
      &quot;Properties&quot; : {
        &quot;VpcId&quot; : { &quot;Ref&quot; : &quot;VpcId&quot; },
        &quot;GroupDescription&quot; : &quot;Enable HTTP access via user defined port&quot;,
        &quot;SecurityGroupIngress&quot; : [ { &quot;IpProtocol&quot; : &quot;tcp&quot;, &quot;FromPort&quot; : 80, &quot;ToPort&quot; : 80, &quot;CidrIp&quot; : &quot;0.0.0.0/0&quot; } ]
      }
    },
    &quot;controlXface&quot; : {
      &quot;Type&quot; : &quot;AWS::EC2::NetworkInterface&quot;,
      &quot;Properties&quot; : {
        &quot;SubnetId&quot; : { &quot;Ref&quot; : &quot;SubnetId&quot; },
        &quot;Description&quot; :&quot;Interface for control traffic such as SSH&quot;,
        &quot;GroupSet&quot; : [ {&quot;Ref&quot; : &quot;SSHSecurityGroup&quot;} ],
        &quot;SourceDestCheck&quot; : &quot;true&quot;,
        &quot;Tags&quot; : [ {&quot;Key&quot; : &quot;Network&quot;, &quot;Value&quot; : &quot;Control&quot;}]
      }
    },
   &quot;webXface&quot; : {
      &quot;Type&quot; : &quot;AWS::EC2::NetworkInterface&quot;,
      &quot;Properties&quot; : {
        &quot;SubnetId&quot; : { &quot;Ref&quot; : &quot;SubnetId&quot; },
        &quot;Description&quot; :&quot;Interface for web traffic&quot;,
        &quot;GroupSet&quot; : [ {&quot;Ref&quot; : &quot;WebSecurityGroup&quot;} ],
        &quot;SourceDestCheck&quot; : &quot;true&quot;,
        &quot;Tags&quot; : [ {&quot;Key&quot; : &quot;Network&quot;, &quot;Value&quot; : &quot;Web&quot;}]
      }
    },
    &quot;Ec2Instance&quot; : {
      &quot;Type&quot; : &quot;AWS::EC2::Instance&quot;,
      &quot;Properties&quot; : {
        &quot;ImageId&quot; : { &quot;Fn::FindInMap&quot; : [ &quot;RegionMap&quot;, { &quot;Ref&quot; : &quot;AWS::Region&quot; }, &quot;AMI&quot; ]},
        &quot;KeyName&quot; : { &quot;Ref&quot; : &quot;KeyName&quot; },
        &quot;NetworkInterfaces&quot; : [ { &quot;NetworkInterfaceId&quot; : {&quot;Ref&quot; : &quot;controlXface&quot;}, &quot;DeviceIndex&quot; : &quot;0&quot; },
								{ &quot;NetworkInterfaceId&quot; : {&quot;Ref&quot; : &quot;webXface&quot;}, &quot;DeviceIndex&quot; : &quot;1&quot; }],
        &quot;Tags&quot; : [ {&quot;Key&quot; : &quot;Role&quot;, &quot;Value&quot; : &quot;Test Instance&quot;}],
        &quot;UserData&quot; : {&quot;Fn::Base64&quot; : { &quot;Fn::Join&quot; : [&quot;&quot;,[
			&quot;#!/bin/bash -ex&quot;,&quot;\n&quot;,
            &quot;\n&quot;,&quot;yum install ec2-net-utils -y&quot;,&quot;\n&quot;,
			&quot;ec2ifup eth1&quot;,&quot;\n&quot;,
			&quot;service httpd start&quot;]]}
		}
	  }
    }
  }</code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h4 id="cfn-template-snippets-eni-example-1.yaml">YAML</h4>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Resources:
  ControlPortAddress:
    Type: AWS::EC2::EIP
    Properties:
      Domain: vpc
  AssociateControlPort:
    Type: AWS::EC2::EIPAssociation
    Properties:
      AllocationId: !GetAtt ControlPortAddress.AllocationId
      NetworkInterfaceId: !Ref controlXface
  WebPortAddress:
    Type: AWS::EC2::EIP
    Properties:
      Domain: vpc
  AssociateWebPort:
    Type: AWS::EC2::EIPAssociation
    Properties:
      AllocationId: !GetAtt WebPortAddress.AllocationId
      NetworkInterfaceId: !Ref webXface
  SSHSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      VpcId: !Ref VpcId
      GroupDescription: Enable SSH access via port 22
      SecurityGroupIngress:
      - CidrIp: 0.0.0.0/0
        FromPort: 22
        IpProtocol: tcp
        ToPort: 22
  WebSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      VpcId: !Ref VpcId
      GroupDescription: Enable HTTP access via user defined port
      SecurityGroupIngress:
      - CidrIp: 0.0.0.0/0
        FromPort: 80
        IpProtocol: tcp
        ToPort: 80
  controlXface:
    Type: AWS::EC2::NetworkInterface
    Properties:
      SubnetId: !Ref SubnetId
      Description: Interface for controlling traffic such as SSH
      GroupSet: 
      - !Ref SSHSecurityGroup
      SourceDestCheck: true
      Tags:
        -
          Key: Network
          Value: Control
  webXface:
    Type: AWS::EC2::NetworkInterface
    Properties:
      SubnetId: !Ref SubnetId
      Description: Interface for controlling traffic such as SSH
      GroupSet: 
      - !Ref WebSecurityGroup
      SourceDestCheck: true
      Tags:
        -
          Key: Network
          Value: Web
  Ec2Instance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: !FindInMap [ RegionMap, !Ref &apos;AWS::Region&apos;, AMI ]
      KeyName: !Ref KeyName
      NetworkInterfaces:
        -
          NetworkInterfaceId: !Ref controlXface
          DeviceIndex: 0
        -
          NetworkInterfaceId: !Ref webXface
          DeviceIndex: 1
      Tags:
        -
          Key: Role
          Value: Test Instance
      UserData:
        Fn::Base64: !Sub |
          #!/bin/bash -xe
          yum install ec2-net-utils -y
          ec2ifup eth1
          service httpd start</code></pre>
                        </div>
                     
                     
                     <h2 id="scenario-ec2-instance">Amazon EC2 Instance Resource</h2>
                     
                     
                     <p>This snippet shows a simple AWS::EC2::Instance resource.</p>
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h3 id="quickref-ec2-example-6.json">JSON</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">&quot;MyInstance&quot; : {
 &quot;Type&quot; : &quot;AWS::EC2::Instance&quot;,
 &quot;Properties&quot; : {
     &quot;AvailabilityZone&quot; : &quot;<span><code class="code" copy="true">us-east-1a</code></span>&quot;,
     &quot;ImageId&quot; : &quot;ami-20b65349&quot;
 }
}</code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h3 id="quickref-ec2-example-6.yaml">YAML</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">MyInstance:
  Type: AWS::EC2::Instance
  Properties:
    AvailabilityZone: us-east-1a
    ImageId: ami-20b65349</code></pre>
                        </div>
                     
                     <h2 id="scenario-ec2-instance-with-vol-and-tags">Amazon EC2 Instance with Volume, Tag,
                        and UserData Properties
                     </h2>
                     
                     
                     <p>This snippet shows an AWS::EC2::Instance resource with one Amazon EC2 volume, one
                        tag, and
                        a user data property. An AWS::EC2::SecurityGroup resource, an AWS::SNS::Topic resource,
                        and an AWS::EC2::Volume resource all must be defined in the same template. Also, the
                        reference to <code class="code">KeyName</code> is a parameters that must be defined in the
                        Parameters section of the template.
                     </p>
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h3 id="quickref-ec2-example-7.json">JSON</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">&quot;MyInstance&quot; : {
 &quot;Type&quot; : &quot;AWS::EC2::Instance&quot;,
 &quot;Properties&quot; : {
     &quot;KeyName&quot; : { &quot;Ref&quot; : &quot;KeyName&quot; },
     &quot;SecurityGroups&quot; : [ {
         &quot;Ref&quot; : &quot;<em class="replaceable"><code>logical name of AWS::EC2::SecurityGroup resource</code></em>&quot;
     } ],
     &quot;UserData&quot; : {
         &quot;Fn::Base64&quot; : {
             &quot;Fn::Join&quot; : [ &quot;:&quot;, [
                 &quot;PORT=80&quot;,
                 &quot;TOPIC=&quot;, {
                     &quot;Ref&quot; : &quot;<em class="replaceable"><code>logical name of an AWS::SNS::Topic resource</code></em>&quot;
                 } ]
             ]
         }
      },
     &quot;InstanceType&quot; : &quot;m1.small&quot;,
     &quot;AvailabilityZone&quot; : &quot;<span><code class="code" copy="true">us-east-1a</code></span>&quot;,
     &quot;ImageId&quot; : &quot;ami-1e817677&quot;,
     &quot;Volumes&quot; : [
        { &quot;VolumeId&quot; : {
             &quot;Ref&quot; : &quot;<em class="replaceable"><code>logical name of AWS::EC2::Volume resource</code></em>&quot;
        },
        &quot;Device&quot; : &quot;/dev/sdk&quot; }
     ],

     &quot;Tags&quot; : [ {
         &quot;Key&quot; : &quot;Name&quot;,
         &quot;Value&quot; : &quot;MyTag&quot;
     } ]
 }
}</code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h3 id="quickref-ec2-example-7.yaml">YAML</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">MyInstance:
  Type: AWS::EC2::Instance
  Properties:
    KeyName: !Ref KeyName
    SecurityGroups:
    - !Ref <em class="replaceable"><code>logical name of AWS::EC2::SecurityGroup resource</code></em>
    UserData:
      Fn::Base64: !Sub |
        PORT=80
        TOPIC=${ <em class="replaceable"><code>logical name of an AWS::SNS::Topic resource</code></em> }
    InstanceType: m1.small
    AvailabilityZone: us-east-1a
    ImageId: ami-1e817677
    Volumes:
      -
        VolumeId: !Ref <em class="replaceable"><code>logical name of AWS::EC2::Volume resource</code></em>
        Device: /dev/sdk
    Tags:
      -
        Key: Name
        Value: MyTag</code></pre>
                        </div>
                     
                     <h2 id="scenario-ec2-with-sdb-domain">Amazon EC2 Instance Resource with an Amazon SimpleDB
                        Domain
                     </h2>
                     
                     
                     <p>This snippet shows an AWS::EC2::Instance resource with an Amazon SimpleDB domain specified
                        in
                        the UserData.
                     </p>
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h3 id="quickref-ec2-example-8.json">JSON</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">&quot;MyInstance&quot; : {
 &quot;Type&quot; : &quot;AWS::EC2::Instance&quot;,
 &quot;Properties&quot; : {
     &quot;UserData&quot; : {
         &quot;Fn::Base64&quot; : {
             &quot;Fn::Join&quot; : [ &quot;&quot;,
                 [ &quot;Domain=&quot;, {
                     &quot;Ref&quot; : &quot;<em class="replaceable"><code>logical name of an AWS::SDB::Domain resource</code></em>&quot;
                 } ]
             ]
         }
      },
     &quot;AvailabilityZone&quot; : &quot;<span><code class="code" copy="true">us-east-1a</code></span>&quot;,
     &quot;ImageId&quot; : &quot;ami-20b65349&quot;
 }
}</code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h3 id="quickref-ec2-example-8.yaml">YAML</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">MyInstance:
  Type: AWS::EC2::Instance
  Properties:
    UserData:
      Fn::Base64: !Sub |
        Domain=${ <em class="replaceable"><code>logical name of an AWS::SDB::Domain resource</code></em> }
    AvailabilityZone: us-east-1a
    ImageId: ami-20b65349</code></pre>
                        </div>
                     
                     <h2 id="scenario-ec2-security-group-two-ports">Amazon EC2 Security Group Resource with
                        Two CIDR Range Ingress Rules
                     </h2>
                     
                     
                     <p>This snippet shows an AWS::EC2::SecurityGroup resource that describes two ingress
                        rules giving access to a specified CIDR range for the TCP protocol on the specified
                        ports.
                     </p>
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h3 id="quickref-ec2-example-9.json">JSON</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">&quot;ServerSecurityGroup&quot; : {
 &quot;Type&quot; : &quot;AWS::EC2::SecurityGroup&quot;,
 &quot;Properties&quot; : {
     &quot;GroupDescription&quot; : &quot;allow connections from specified CIDR ranges&quot;,
     &quot;SecurityGroupIngress&quot; : [
         {
             &quot;IpProtocol&quot; : &quot;tcp&quot;,
             &quot;FromPort&quot; : &quot;80&quot;,
             &quot;ToPort&quot; : &quot;80&quot;,
             &quot;CidrIp&quot; : &quot;0.0.0.0/0&quot;
         },{
             &quot;IpProtocol&quot; : &quot;tcp&quot;,
             &quot;FromPort&quot; : &quot;22&quot;,
             &quot;ToPort&quot; : &quot;22&quot;,
             &quot;CidrIp&quot; : &quot;192.168.1.1/32&quot;
         }
     ]
 }
}</code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h3 id="quickref-ec2-example-9.yaml">YAML</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">ServerSecurityGroup:
  Type: AWS::EC2::SecurityGroup
  Properties:
    GroupDescription: allow connections from specified CIDR ranges
    SecurityGroupIngress:
    - IpProtocol: tcp
      FromPort: 80
      ToPort: 80
      CidrIp: 0.0.0.0/0
    - IpProtocol: tcp
      FromPort: 22
      ToPort: 22
      CidrIp: 192.168.1.1/32</code></pre>
                        </div>
                     
                     <h2 id="scenario-ec2-security-group-rule">Amazon EC2 Security Group Resource with Two
                        Security Group Ingress Rules
                     </h2>
                     
                     
                     <p>This snippet shows an AWS::EC2::SecurityGroup resource that describes two security
                        group ingress rules. The first ingress rule grants access to the existing security
                        group
                        myadminsecuritygroup, which is owned by the 1234-5678-9012 AWS account, for the TCP
                        protocol on port 22. The second ingress rule grants access to the security group
                        mysecuritygroupcreatedincfn for TCP on port 80. This ingress rule uses the Ref intrinsic
                        function to refer to a security group (whose logical name is
                        mysecuritygroupcreatedincfn) created in the same template. You must declare a value
                        for
                        both the <code class="code">SourceSecurityGroupName</code> and
                        <code class="code">SourceSecurityGroupOwnerId</code> properties.
                     </p>
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h3 id="quickref-ec2-example-10.json">JSON</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">&quot;ServerSecurityGroupBySG&quot; : {
 &quot;Type&quot; : &quot;AWS::EC2::SecurityGroup&quot;,
 &quot;Properties&quot; : {
     &quot;GroupDescription&quot; : &quot;allow connections from specified source security group&quot;,
     &quot;SecurityGroupIngress&quot; : [
         {
            &quot;IpProtocol&quot; : &quot;tcp&quot;,
            &quot;FromPort&quot; : &quot;22&quot;,
            &quot;ToPort&quot; : &quot;22&quot;,
            &quot;SourceSecurityGroupName&quot; : &quot;<em class="replaceable"><code>myadminsecuritygroup</code></em>&quot;,
            &quot;SourceSecurityGroupOwnerId&quot; : &quot;<em class="replaceable"><code>123456789012</code></em>&quot;
         },
         {
            &quot;IpProtocol&quot; : &quot;tcp&quot;,
            &quot;FromPort&quot; : &quot;80&quot;,
            &quot;ToPort&quot; : &quot;80&quot;,
            &quot;SourceSecurityGroupName&quot; : {&quot;Ref&quot; : &quot;<em class="replaceable"><code>mysecuritygroupcreatedincfn</code></em>&quot;}
         }
     ]
 }
}</code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h3 id="quickref-ec2-example-10.yaml">YAML</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">ServerSecurityGroupBySG:
  Type: AWS::EC2::SecurityGroup
  Properties:
    GroupDescription: allow connections from specified source security group
    SecurityGroupIngress:
    - IpProtocol: tcp
      FromPort: 80
      ToPort: 80
      SourceSecurityGroupName: myadminsecuritygroup
      SourceSecurityGroupOwnerId: 123456789012
    - IpProtocol: tcp
      FromPort: 80
      ToPort: 80
      SourceSecurityGroupName: !Ref mysecuritygroupcreatedincfn</code></pre>
                        </div>
                     
                     <h2 id="scenario-ec2-security-group-elbingress">Amazon EC2 Security Group Resource with
                        LoadBalancer Ingress Rule
                     </h2>
                     
                     
                     <p>This template shows an AWS::EC2::SecurityGroup resource that contains a security group
                        ingress rule that grants access to the LoadBalancer myELB for TCP on port 80. Note
                        that
                        the rule uses the <code class="code">SourceSecurityGroup.OwnerAlias</code> and
                        <code class="code">SourceSecurityGroup.GroupName</code> properties of the myELB
                        resource to specify the source security group of the LoadBalancer.
                     </p>
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h3 id="quickref-ec2-example-11.json">JSON</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">{
    &quot;AWSTemplateFormatVersion&quot;: &quot;2010-09-09&quot;,
    &quot;Resources&quot;: {
        &quot;myELB&quot;: {
            &quot;Type&quot;: &quot;AWS::ElasticLoadBalancing::LoadBalancer&quot;,
            &quot;Properties&quot;: {
                &quot;AvailabilityZones&quot;: [
                    &quot;eu-west-1a&quot;
                ],
                &quot;Listeners&quot;: [
                    {
                        &quot;LoadBalancerPort&quot;: &quot;80&quot;,
                        &quot;InstancePort&quot;: &quot;80&quot;,
                        &quot;Protocol&quot;: &quot;HTTP&quot;
                    }
                ]
            }
        },
        &quot;myELBIngressGroup&quot;: {
            &quot;Type&quot;: &quot;AWS::EC2::SecurityGroup&quot;,
            &quot;Properties&quot;: {
                &quot;GroupDescription&quot;: &quot;ELB ingress group&quot;,
                &quot;SecurityGroupIngress&quot;: [
                    {
                        &quot;IpProtocol&quot;: &quot;tcp&quot;,
                        &quot;FromPort&quot;: &quot;80&quot;,
                        &quot;ToPort&quot;: &quot;80&quot;,
                        &quot;SourceSecurityGroupOwnerId&quot;: {
                            &quot;Fn::GetAtt&quot;: [
                                &quot;myELB&quot;,
                                &quot;SourceSecurityGroup&quot;,
                                &quot;OwnerAlias&quot;
                            ]
                        },
                        &quot;SourceSecurityGroupName&quot;: {
                            &quot;Fn::GetAtt&quot;: [
                                &quot;myELB&quot;,
                                &quot;SourceSecurityGroup&quot;,
                                &quot;GroupName&quot;
                            ]
                        }
                    }
                ]
            }
        }
    }
}</code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h3 id="quickref-ec2-example-11.yaml">YAML</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">AWSTemplateFormatVersion: 2010-09-09
Resources:
  myELB:
    Type: &apos;AWS::ElasticLoadBalancing::LoadBalancer&apos;
    Properties:
      AvailabilityZones:
        - eu-west-1a
      Listeners:
        - LoadBalancerPort: &apos;80&apos;
          InstancePort: &apos;80&apos;
          Protocol: HTTP
  myELBIngressGroup:
    Type: &apos;AWS::EC2::SecurityGroup&apos;
    Properties:
      GroupDescription: ELB ingress group
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: &apos;80&apos;
          ToPort: &apos;80&apos;
          SourceSecurityGroupOwnerId: !GetAtt myELB.SourceSecurityGroup.OwnerAlias
          SourceSecurityGroupName: !GetAtt myELB.SourceSecurityGroup.GroupName</code></pre>
                        </div>
                     
                     <h2 id="scenario-ec2-security-group-ingress">Using AWS::EC2::SecurityGroupIngress
                        to Create Mutually Referencing Amazon EC2 Security Group Resources
                     </h2>
                     
                     
                     <p>This snippet shows two AWS::EC2::SecurityGroupIngress resources that add mutual
                        ingress rules to the EC2 security groups SGroup1 and SGroup2. The SGroup1Ingress
                        resource enables ingress from SGroup2 through TCP/IP port 80 to SGroup1. The
                        SGroup2Ingress resource enables ingress from SGroup1 through TCP/IP port 80 to SGroup2.
                        
                     </p>
                     
                     <div class="aws-note">
                        <p class="aws-note">Note</p>
                        <p>If you are using an Amazon VPC, use the <code class="code">AWS::EC2::SecurityGroup</code> resource and specify the <code class="code">VpcId</code> property.
                        </p>
                     </div>
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h3 id="quickref-ec2-example-12.json">JSON</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">        &quot;SGroup1&quot; : {
         &quot;Type&quot; : &quot;AWS::EC2::SecurityGroup&quot;,
         &quot;Properties&quot; : {
             &quot;GroupDescription&quot; : &quot;EC2 Instance access&quot;
         }
     },
     &quot;SGroup2&quot; : {
         &quot;Type&quot; : &quot;AWS::EC2::SecurityGroup&quot;,
         &quot;Properties&quot; : {
             &quot;GroupDescription&quot; : &quot;EC2 Instance access&quot;
         }
     },
     &quot;SGroup1Ingress&quot; : {
         &quot;Type&quot; : &quot;AWS::EC2::SecurityGroupIngress&quot;,
         &quot;Properties&quot; : {
             &quot;GroupName&quot; : { &quot;Ref&quot; : &quot;SGroup1&quot; },
             &quot;IpProtocol&quot; : &quot;tcp&quot;,
             &quot;ToPort&quot; : &quot;80&quot;,
             &quot;FromPort&quot; : &quot;80&quot;,
             &quot;SourceSecurityGroupName&quot; : { &quot;Ref&quot; : &quot;SGroup2&quot; }
         }
     },
     &quot;SGroup2Ingress&quot; : {
         &quot;Type&quot; : &quot;AWS::EC2::SecurityGroupIngress&quot;,
         &quot;Properties&quot; : {
             &quot;GroupName&quot; : { &quot;Ref&quot; : &quot;SGroup2&quot; },
             &quot;IpProtocol&quot; : &quot;tcp&quot;,
             &quot;ToPort&quot; : &quot;80&quot;,
             &quot;FromPort&quot; : &quot;80&quot;,
             &quot;SourceSecurityGroupName&quot; : { &quot;Ref&quot; : &quot;SGroup1&quot; }
         }
     }
</code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h3 id="quickref-ec2-example-12.yaml">YAML</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">SGroup1:
  Type: AWS::EC2::SecurityGroup
  Properties:
    GroupDescription: EC2 Instance access
SGroup2:
  Type: AWS::EC2::SecurityGroup
  Properties:
    GroupDescription: EC2 Instance access
SGroup1Ingress:
  Type: AWS::EC2::SecurityGroupIngress
  Properties:
    GroupName: !Ref SGroup1
    IpProtocol: tcp
    ToPort: 80
    FromPort: 80
    SourceSecurityGroupName: !Ref SGroup2
SGroup2Ingress:
  Type: AWS::EC2::SecurityGroupIngress
  Properties:
    GroupName: !Ref SGroup2
    IpProtocol: tcp
    ToPort: 80
    FromPort: 80
    SourceSecurityGroupName: !Ref SGroup1
</code></pre>
                        </div>
                     
                     <h2 id="scenario-ec2-volume">Amazon EC2 Volume Resource</h2>
                     
                     
                     <p>This snippet shows a simple Amazon EC2 volume resource with a DeletionPolicy attribute
                        set
                        to Snapshot. With the Snapshot DeletionPolicy set, AWS CloudFormation will take a
                        snapshot of this
                        volume before deleting it during stack deletion. Make sure you specify a value for
                        <code class="code">SnapShotId</code>, or a value for <code class="code">Size</code>, but not both. Remove the
                        one you don&apos;t need.
                     </p>
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h3 id="quickref-ec2-example-13.json">JSON</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">&quot;MyEBSVolume&quot; : {
 &quot;Type&quot; : &quot;AWS::EC2::Volume&quot;,
 &quot;Properties&quot; : {
     &quot;Size&quot; : &quot;<em class="replaceable"><code>specify a size if no SnapShotId</code></em>&quot;,
     &quot;SnapshotId&quot; : &quot;<em class="replaceable"><code>specify a SnapShotId if no Size</code></em>&quot;,
     &quot;AvailabilityZone&quot; : { &quot;Ref&quot; : &quot;AvailabilityZone&quot; }
 },
 &quot;DeletionPolicy&quot; : &quot;Snapshot&quot;
}</code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h3 id="quickref-ec2-example-13.yaml">YAML</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">MyEBSVolume:
  Type: AWS::EC2::Volume
  Properties:
    Size: <em class="replaceable"><code>specify a size if no SnapshotId</code></em>
    SnapshotId: <em class="replaceable"><code>specify a SnapShotId if no Size</code></em>
    AvailabilityZone: !Ref AvailabilityZone
  DeletionPolicy: Snapshot</code></pre>
                        </div>
                     
                     <h2 id="scenario-ec2-volumeattachment">Amazon EC2 VolumeAttachment Resource</h2>
                     
                     
                     <p>This snippet shows the following resources: an Amazon EC2 instance using an Amazon
                        Linux
                        AMI from the US-East (Northern Virginia) Region, an EC2 security group that allows
                        SSH
                        access to IP addresses, a new Amazon EBS volume sized at 100 GB and in the same
                        Availability Zone as the EC2 instance, and a volume attachment that attaches the new
                        volume to the EC2 instance. 
                     </p>
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h3 id="quickref-ec2-example-14.json">JSON</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">&quot;Resources&quot; : {
 &quot;Ec2Instance&quot; : {
   &quot;Type&quot; : &quot;AWS::EC2::Instance&quot;,
   &quot;Properties&quot; : {
     &quot;SecurityGroups&quot; : [ { &quot;Ref&quot; : &quot;InstanceSecurityGroup&quot; } ],
     &quot;ImageId&quot; : &quot;ami-76f0061f&quot;
   }
 },

 &quot;InstanceSecurityGroup&quot; : {
   &quot;Type&quot; : &quot;AWS::EC2::SecurityGroup&quot;,
   &quot;Properties&quot; : {
     &quot;GroupDescription&quot; : &quot;Enable SSH access via port 22&quot;,
     &quot;SecurityGroupIngress&quot; : [ {
       &quot;IpProtocol&quot; : &quot;tcp&quot;,
       &quot;FromPort&quot; : &quot;22&quot;,
       &quot;ToPort&quot; : &quot;22&quot;,
       &quot;CidrIp&quot; : &quot;0.0.0.0/0&quot;
     } ]
   }
 },

 &quot;NewVolume&quot; : {
   &quot;Type&quot; : &quot;AWS::EC2::Volume&quot;,
   &quot;Properties&quot; : {
     &quot;Size&quot; : &quot;100&quot;,
     &quot;AvailabilityZone&quot; : { &quot;Fn::GetAtt&quot; : [ &quot;Ec2Instance&quot;, &quot;AvailabilityZone&quot; ]},
   }
 },

 &quot;MountPoint&quot; : {
   &quot;Type&quot; : &quot;AWS::EC2::VolumeAttachment&quot;,
   &quot;Properties&quot; : {
     &quot;InstanceId&quot; : { &quot;Ref&quot; : &quot;Ec2Instance&quot; },
     &quot;VolumeId&quot;  : { &quot;Ref&quot; : &quot;NewVolume&quot; },
     &quot;Device&quot; : &quot;/dev/sdh&quot;
   }
 }
}</code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h3 id="quickref-ec2-example-14.yaml">YAML</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Resources:
  Ec2Instance:
    Type: AWS::EC2::Instance
    Properties:
      SecurityGroups:
      - !Ref InstanceSecurityGroup
      ImageId: ami-76f0061f
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Enable SSH access via port 22
      SecurityGroupIngress:
      - IpProtocol: tcp
        FromPort: 22
        ToPort: 22
        CidrIp: 0.0.0.0/0
  NewVolume:
    Type: AWS::EC2::Volume
    Properties:
      Size: 100
      AvailabilityZone: !GetAtt Ec2Instance.AvailabilityZone
  MountPoint:
    Type: AWS::EC2::VolumeAttachment
    Properties:
      InstanceId: !Ref Ec2Instance
      VolumeId: !Ref NewVolume
      Device: /dev/sdh</code></pre>
                        </div>
                     
                     <h2 id="using-cfn-getatt-default-values">Amazon EC2 Instance in a Default VPC Security
                        Group
                     </h2>
                     
                     
                     <p>Whenever you create a VPC, AWS automatically creates default resources for that VPC,
                        such as a security group. However, when you define a VPC in AWS CloudFormation templates,
                        you don&apos;t
                        yet have the physical IDs of those default resources. To obtain the IDs, use the <a href="intrinsic-function-reference-getatt.html"><code class="code">Fn::GetAtt</code></a> intrinsic function. That way,
                        you can use the default resources instead of creating new ones in your template. For
                        example, the following template snippet associates the default security group of the
                        <code class="code">myVPC</code> VPC with the <code class="code">myInstance</code> Amazon EC2
                        instance.
                     </p>
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h3 id="quickref-ec2-example-15.json">JSON</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">&quot;myVPC&quot;: {
  &quot;Type&quot;: &quot;AWS::EC2::VPC&quot;,
  &quot;Properties&quot;: {
    &quot;CidrBlock&quot;: {&quot;Ref&quot;: &quot;myVPCCIDRRange&quot;},
    &quot;EnableDnsSupport&quot;: false,
    &quot;EnableDnsHostnames&quot;: false,
    &quot;InstanceTenancy&quot;: &quot;default&quot;
  }
},
&quot;myInstance&quot; : {
  &quot;Type&quot; : &quot;AWS::EC2::Instance&quot;,
  &quot;Properties&quot; : {
    &quot;ImageId&quot;: {
      &quot;Fn::FindInMap&quot;: [&quot;AWSRegionToAMI&quot;,{&quot;Ref&quot;: &quot;AWS::Region&quot;},&quot;64&quot;]
    },
    &quot;SecurityGroupIds&quot; : [{&quot;Fn::GetAtt&quot;: [&quot;myVPC&quot;, &quot;DefaultSecurityGroup&quot;]}],
    &quot;SubnetId&quot; : {&quot;Ref&quot; : &quot;mySubnet&quot;}
  }
}</code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h3 id="quickref-ec2-example-15.yaml">YAML</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">myVPC:
  Type: AWS::EC2::VPC
  Properties:
    CidrBlock: !Ref myVPCCIDRRange
    EnableDnsSupport: false
    EnableDnsHostnames: false
    InstanceTenancy: default
myInstance:
  Type: AWS::EC2::Instance
  Properties:
    ImageId: !FindInMap [ AWSRegionToAMI , !Ref &apos;AWS::Region&apos;, 64 ]
    SecurityGroupIds:
    - !GetAtt myVPC.DefaultSecurityGroup
    SubnetId: !Ref mySubnet</code></pre>
                        </div>
                     
                     <h2 id="quickref-ec2-route-egressonlyinternetgateway">Amazon EC2 Route with Egress-Only Internet Gateway</h2>
                     
                     <p>The following template sets up an egress-only Internet gateway that&apos;s used with an
                        EC2 route.
                     </p>       
                     
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h3 id="quickref-ec2-example-16.json">JSON</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">{
    &quot;Resources&quot;: {
        &quot;DefaultIpv6Route&quot;: {
            &quot;Properties&quot;: {
                &quot;DestinationIpv6CidrBlock&quot;: &quot;::/0&quot;,
                &quot;EgressOnlyInternetGatewayId&quot;: {
                    &quot;Ref&quot;: &quot;EgressOnlyInternetGateway&quot;
                },
                &quot;RouteTableId&quot;: {
                    &quot;Ref&quot;: &quot;RouteTable&quot;
                }
            },
            &quot;Type&quot;: &quot;AWS::EC2::Route&quot;
        },
        &quot;EgressOnlyInternetGateway&quot;: {
            &quot;Properties&quot;: {
                &quot;VpcId&quot;: {
                    &quot;Ref&quot;: &quot;VPC&quot;
                }
            },
            &quot;Type&quot;: &quot;AWS::EC2::EgressOnlyInternetGateway&quot;
        },
        &quot;RouteTable&quot;: {
            &quot;Properties&quot;: {
                &quot;VpcId&quot;: {
                    &quot;Ref&quot;: &quot;VPC&quot;
                }
            },
            &quot;Type&quot;: &quot;AWS::EC2::RouteTable&quot;
        },
        &quot;VPC&quot;: {
            &quot;Properties&quot;: {
                &quot;CidrBlock&quot;: &quot;10.0.0.0/16&quot;
            },
            &quot;Type&quot;: &quot;AWS::EC2::VPC&quot;
        }
    }
}</code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h3 id="quickref-ec2-example-16.yaml">YAML</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Resources:
  DefaultIpv6Route:
    Type: AWS::EC2::Route
    Properties:
      DestinationIpv6CidrBlock: &quot;::/0&quot;
      EgressOnlyInternetGatewayId: !Ref EgressOnlyInternetGateway
      RouteTableId: !Ref RouteTable
  EgressOnlyInternetGateway:
    Type: AWS::EC2::EgressOnlyInternetGateway
    Properties:
      VpcId: !Ref VPC
  RouteTable:
    Type: AWS::EC2::RouteTable
    Properties:
      VpcId: !Ref VPC
  VPC:
    Type: AWS::EC2::VPC
    Properties:
      CidrBlock: 10.0.0.0/16</code></pre>
                        </div>
                     
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be enabled. Please refer to your browser's
                                    Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="quickref-dynamodb.html">&#xAB; Previous </a><a class="awstoc" accesskey="n" href="quickref-ecs.html">Next &#xBB;</a></div>
                     <div id="copyright-main-footer">&#xA9; 2018, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="EC2 Block Device Mapping Examples"><a class="pagetoc" href="#scenario-ec2-bdm">EC2 Block Device Mapping Examples</a></li>
                        <li class="pagetoc" name="Assigning an Amazon EC2 Elastic IP Using AWS::EC2::EIP
            Snippet"><a class="pagetoc" href="#scenario-ec2-eip">Assigning an Amazon EC2 Elastic IP Using AWS::EC2::EIP
                              Snippet</a></li>
                        <li class="pagetoc" name="Assigning an Existing Elastic IP to an Amazon
            EC2 instance using AWS::EC2::EIPAssociation Snippet"><a class="pagetoc" href="#scenario-ec2-eip-association">Assigning an Existing Elastic IP to an Amazon
                              EC2 instance using AWS::EC2::EIPAssociation Snippet</a></li>
                        <li class="pagetoc" name="Assigning an Existing VPC Elastic IP to
            an Amazon EC2 instance using AWS::EC2::EIPAssociation Snippet"><a class="pagetoc" href="#scenario-ec2-eip-association-vpc">Assigning an Existing VPC Elastic IP to
                              an Amazon EC2 instance using AWS::EC2::EIPAssociation Snippet</a></li>
                        <li class="pagetoc" name="Elastic Network Interface (ENI) Template
    Snippets"><a class="pagetoc" href="#cfn-template-snippets-eni">Elastic Network Interface (ENI) Template
                              Snippets</a></li>
                        <li class="pagetoc" name="Amazon EC2 Instance Resource"><a class="pagetoc" href="#scenario-ec2-instance">Amazon EC2 Instance Resource</a></li>
                        <li class="pagetoc" name="Amazon EC2 Instance with Volume, Tag,
            and UserData Properties"><a class="pagetoc" href="#scenario-ec2-instance-with-vol-and-tags">Amazon EC2 Instance with Volume, Tag,
                              and UserData Properties</a></li>
                        <li class="pagetoc" name="Amazon EC2 Instance Resource with an Amazon SimpleDB
            Domain"><a class="pagetoc" href="#scenario-ec2-with-sdb-domain">Amazon EC2 Instance Resource with an Amazon SimpleDB
                              Domain</a></li>
                        <li class="pagetoc" name="Amazon EC2 Security Group Resource with
            Two CIDR Range Ingress Rules"><a class="pagetoc" href="#scenario-ec2-security-group-two-ports">Amazon EC2 Security Group Resource with
                              Two CIDR Range Ingress Rules</a></li>
                        <li class="pagetoc" name="Amazon EC2 Security Group Resource with Two
            Security Group Ingress Rules"><a class="pagetoc" href="#scenario-ec2-security-group-rule">Amazon EC2 Security Group Resource with Two
                              Security Group Ingress Rules</a></li>
                        <li class="pagetoc" name="Amazon EC2 Security Group Resource with
            LoadBalancer Ingress Rule"><a class="pagetoc" href="#scenario-ec2-security-group-elbingress">Amazon EC2 Security Group Resource with
                              LoadBalancer Ingress Rule</a></li>
                        <li class="pagetoc" name="Using AWS::EC2::SecurityGroupIngress
            to Create Mutually Referencing Amazon EC2 Security Group Resources"><a class="pagetoc" href="#scenario-ec2-security-group-ingress">Using AWS::EC2::SecurityGroupIngress
                              to Create Mutually Referencing Amazon EC2 Security Group Resources</a></li>
                        <li class="pagetoc" name="Amazon EC2 Volume Resource"><a class="pagetoc" href="#scenario-ec2-volume">Amazon EC2 Volume Resource</a></li>
                        <li class="pagetoc" name="Amazon EC2 VolumeAttachment Resource"><a class="pagetoc" href="#scenario-ec2-volumeattachment">Amazon EC2 VolumeAttachment Resource</a></li>
                        <li class="pagetoc" name="Amazon EC2 Instance in a Default VPC Security
            Group"><a class="pagetoc" href="#using-cfn-getatt-default-values">Amazon EC2 Instance in a Default VPC Security
                              Group</a></li>
                        <li class="pagetoc" name="Amazon EC2 Route with Egress-Only Internet Gateway"><a class="pagetoc" href="#quickref-ec2-route-egressonlyinternetgateway">Amazon EC2 Route with Egress-Only Internet Gateway</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='AWS CloudFormation';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='User Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   
</body></html>