<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>AWS::CloudFormation::CustomResource - AWS CloudFormation</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="home" href="#top">
      <link rel="up" href="aws-template-resource-type-ref.html" title="AWS Resource Types Reference">
      <link rel="prev" href="aws-resource-authentication.html" title="AWS::CloudFormation::Authentication">
      <link rel="next" href="aws-resource-init.html" title="AWS::CloudFormation::Init">
      <meta name="description" content="Specifies custom resources so that non-AWS resources can be included in an AWS CloudFormation stack by using the AWS::CloudFormation::CustomResource resource.">
      <meta name="keywords" content="CloudFormation,AWSCloudFormation,resource provisioning,resource configuration,infrastructure management,CloudFormer,CloudFormation Designer,CloudFormation stack,CloudFormation stackset,CloudFormation template,change set">
      <meta name="deployment_region" content="IAD">
      <meta name="product" content="AWS CloudFormation">
      <meta name="guide" content="User Guide">
      <meta name="guide-locale" content="en_us">
      <link rel="icon" type="image/ico" href="/images/favicon.ico">
      <link rel="shortcut icon" type="image/ico" href="/images/favicon.ico">
      <link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cfn-customresource.html">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/font-awesome.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/google-font.css">
      <link id="code-style" rel="stylesheet" type="text/css" href="../../../css/light.css">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.theme.css">
      <link rel="stylesheet" type="text/css" href="../../../css/colorbox.css">
      <link rel="stylesheet" type="text/css" href="../../../css/awsdocs.css"><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="/js/jquery-ui.min.js"></script><script type="text/javascript" src="/js/handlebars.js"></script><script type="text/javascript" src="/js/jquery.colorbox.js"></script><script type="text/javascript" src="/js/awsdocs.min.js?v=20170615"></script></head>
   <body id="top">
      
      <div id="content-container">
         
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tbody><tr>
                           <td>
                              <div class="breadcrumb"><a href="http://aws.amazon.com/documentation">AWS Documentation</a> &#xBB; <a href="http://aws.amazon.com/documentation/cloudformation">AWS CloudFormation</a> &#xBB; <a href="index.html">User Guide</a> &#xBB; <a href="template-reference.html">Template Reference</a> &#xBB; <a href="aws-template-resource-type-ref.html">AWS Resource Types Reference</a> &#xBB; <span class="breadcrumb">AWS::CloudFormation::CustomResource</span></div>
                           </td>
                        </tr>
                     </tbody></table>
                     <div></div>
                     <div id="language-filter" class="page-header" style="display:none">
                        <form> Filter View: 
                           <select name="filter-select" id="filter-select">
                              <option selected="1">All</option>
                              <option value="JSON" selected>JSON</option>
                              <option value="YAML" selected>YAML</option></select></form>
                     </div>
                     <h1 class="topictitle" id="aws-resource-cfn-customresource">AWS::CloudFormation::CustomResource</h1>
                     <p>In an AWS CloudFormation template, you use the <code class="code">AWS::CloudFormation::CustomResource</code> or <a href="aws-resource-cfn-customresource.html#aws-cfn-resource-type-name"><code class="code">Custom::<em class="replaceable"><code>String</code></em></code></a> resource type to specify custom resources.
                     </p>
                     <p>Custom resources provide a way for you to write custom provisioning logic in AWS CloudFormation
                        template
                        and have AWS CloudFormation run it during a stack operation, such as when you create,
                        update or delete a
                        stack. For more information, see <a href="template-custom-resources.html">Custom Resources</a>.
                     </p>
                     <div class="aws-note">
                        <p class="aws-note">Note</p>
                        <p>If you use the <a href="./AmazonVPC/latest/UserGuide/vpc-endpoints.html" target="_blank">VPC endpoint</a>
                           feature, custom resources in the VPC must have access to AWS CloudFormation-specific
                           Amazon Simple Storage Service (Amazon S3)
                           buckets. Custom resources must send responses to a pre-signed Amazon S3 URL. If they
                           can&apos;t send
                           responses to Amazon S3, AWS CloudFormation won&apos;t receive a response and the stack
                           operation fails. For more
                           information, see <a href="cfn-vpce-bucketnames.html">AWS CloudFormation and VPC Endpoints</a>.
                        </p>
                     </div>
                     <div class="highlights" id="inline-topiclist">
                        <p><strong>Topics</strong></p>
                        <ul>
                           <li><a href="#aws-resource-cloudformation-customresource-syntax">Syntax</a></li>
                           <li><a href="#w2ab2c21c10d178c13">Properties</a></li>
                           <li><a href="#w2ab2c21c10d178c15">Return Values</a></li>
                           <li><a href="#w2ab2c21c10d178c17">Examples</a></li>
                           <li><a href="#w2ab2c21c10d178c19">Replacing a Custom Resource During an Update</a></li>
                        </ul>
                     </div>
                     <h2 id="aws-resource-cloudformation-customresource-syntax">Syntax</h2>
                     
                     
                     <p>To declare this entity in your AWS CloudFormation template, use the following syntax:</p>
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h3 id="aws-resource-cloudformation-customresource-syntax.json">JSON</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">
{
   &quot;Type&quot; : &quot;Custom::<em class="replaceable"><code>String</code></em>&quot;,
   &quot;Version&quot; : &quot;1.0&quot;,
   &quot;Properties&quot; : {
      &quot;<a href="aws-resource-cfn-customresource.html#cfn-customresource-servicetoken"><code class="literal">ServiceToken</code></a>&quot; : <em class="replaceable"><code>String</code></em>,
      <em class="replaceable"><code>... provider-defined properties ...</code></em>
   }
} </code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h3 id="aws-resource-cloudformation-customresource-syntax.yaml">YAML</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">Type: &quot;Custom::<em class="replaceable"><code>String</code></em>&quot;
Version: &quot;1.0&quot;
Properties:
  <a href="aws-resource-cfn-customresource.html#cfn-customresource-servicetoken"><code class="literal">ServiceToken</code></a>: <em class="replaceable"><code>String</code></em>
    <em class="replaceable"><code>... provider-defined properties ...</code></em>
</code></pre>
                        </div>
                     
                     <h3 id="aws-cfn-resource-type-name">Custom::<em class="replaceable"><code>String</code></em></h3>
                     
                     
                     <p>For custom resources, you can specify
                        <code class="code">AWS::CloudFormation::CustomResource</code> as the resource type, or you can
                        specify your own resource type name. For example, instead of using
                        <code class="code">AWS::CloudFormation::CustomResource</code>, you can use
                        <code class="code">Custom::MyCustomResourceTypeName</code>.
                     </p>
                     
                     <p>Custom resource type names can include alphanumeric characters and the following
                        characters: <code class="code">_@-</code>. You can specify a custom resource type name up to a
                        maximum length of 60 characters. You cannot change the type during an update.
                     </p>
                     
                     <p>Using your own resource type names helps you quickly differentiate the types of
                        custom resources in your stack. For example, if you had two custom resources that
                        conduct two different ping tests, you could name their type as
                        <code class="code">Custom::PingTester</code> to make them easily identifiable as ping testers
                        (instead of using <code class="code">AWS::CloudFormation::CustomResource</code>).
                     </p>
                     
                     
                     <h2 id="w2ab2c21c10d178c13">Properties</h2>
                     
                     
                     <div class="aws-note">
                        <p class="aws-note">Note</p>
                        <p>Only one property is defined by AWS for a custom resource: <code class="code">ServiceToken</code>. All other properties are defined by the service provider.
                        </p>
                     </div>
                     
                     <div class="variablelist">
                        
                        
                        <dl>
                           
                           <dt><a id="cfn-customresource-servicetoken"></a><span class="term"><code class="literal">ServiceToken</code></span></dt>
                           
                           <dd>
                              
                              <p>The service token that was given to the template developer by the service provider
                                 to access the service, such as an Amazon SNS topic ARN or Lambda function ARN. The
                                 service token must be from the same region in which you are creating the
                                 stack.
                              </p>
                              
                              <p><em>Required</em>: Yes
                              </p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Update requires</em>: Updates are not supported.
                              </p>
                              
                           </dd>
                           
                        </dl>
                     </div>
                     
                     <h2 id="w2ab2c21c10d178c15">Return Values</h2>
                     
                     
                     <p>For a custom resource, return values are defined by the custom resource provider,
                        and are retrieved by
                        calling <a href="intrinsic-function-reference-getatt.html"><code class="code">Fn::GetAtt</code></a>
                        on the provider-defined attributes.
                     </p>
                     
                     <h2 id="w2ab2c21c10d178c17">Examples</h2>
                     
                     
                     <h3 id="w2ab2c21c10d178c17b2">Creating a custom resource definition in a template</h3>
                     
                     
                     <p>The following example demonstrates how to create a custom resource definition in a
                        template.
                     </p>
                     
                     <p>All properties other than <code class="code">ServiceToken</code>, and all
                        <code class="code">Fn::GetAtt</code> resource attributes, are defined by
                        the custom resource provider.
                     </p>
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h4 id="aws-resource-cloudformation-customresource-example2.json">JSON</h4>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">{
   &quot;AWSTemplateFormatVersion&quot; : &quot;2010-09-09&quot;,
   &quot;Resources&quot; : {
      &quot;MyFrontEndTest&quot; : {
         &quot;Type&quot;: &quot;Custom::PingTester&quot;,
         &quot;Version&quot; : &quot;1.0&quot;,
         &quot;Properties&quot; : {
            &quot;ServiceToken&quot;: &quot;arn:aws:sns:us-east-1:84969EXAMPLE:CRTest&quot;,
            &quot;key1&quot; : &quot;string&quot;,
            &quot;key2&quot; : [ &quot;list&quot; ],
            &quot;key3&quot; : { &quot;key4&quot; : &quot;map&quot; }
         }
      }
   },
   &quot;Outputs&quot; : {
      &quot;CustomResourceAttribute1&quot; : {
         &quot;Value&quot; : { &quot;Fn::GetAtt&quot; : [&quot;MyFrontEndTest&quot;, &quot;responseKey1&quot;] }
      },
      &quot;CustomResourceAttribute2&quot; : {
         &quot;Value&quot; : { &quot;Fn::GetAtt&quot; : [&quot;MyFrontEndTest&quot;, &quot;responseKey2&quot;] }
      }
   }
}</code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h4 id="aws-resource-cloudformation-customresource-example2.yaml">YAML</h4>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">AWSTemplateFormatVersion: &quot;2010-09-09&quot;
Resources: 
  MyFrontEndTest: 
    Type: &quot;Custom::PingTester&quot;
    Version: &quot;1.0&quot;
    Properties: 
      ServiceToken: &quot;arn:aws:sns:us-east-1:84969EXAMPLE:CRTest&quot;
      key1: string
      key2: 
        - list
      key3: 
        key4: map
Outputs: 
  CustomResourceAttribute1: 
    Value: 
      Fn::GetAtt: 
        - MyFrontEndTest
        - responseKey1
  CustomResourceAttribute2: 
    Value: 
      Fn::GetAtt: 
        - MyFrontEndTest
        - responseKey2</code></pre>
                        </div>
                     
                     
                     <h3 id="w2ab2c21c10d178c17b4">Using an AWS Lambda function in a custom resource</h3>
                     
                     
                     <p>With Lambda functions and custom resources, you can run custom code in response to
                        stack events (create, update, and delete). The following custom resource invokes a
                        Lambda
                        function and sends it the <code class="code">StackName</code> property as input. The function uses
                        this property to get outputs from the appropriate stack.
                     </p>
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h4 id="aws-resource-cloudformation-customresource-example3.json">JSON</h4>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">&quot;MyCustomResource&quot; : {
  &quot;Type&quot; : &quot;Custom::TestLambdaCrossStackRef&quot;,
  &quot;Properties&quot; : {
    &quot;ServiceToken&quot;: { &quot;Fn::Join&quot;: [ &quot;&quot;, [ &quot;arn:aws:lambda:&quot;, { &quot;Ref&quot;: &quot;AWS::Region&quot; }, &quot;:&quot;, { &quot;Ref&quot;: &quot;AWS::AccountId&quot; }, &quot;:function:&quot;, {&quot;Ref&quot; : &quot;LambdaFunctionName&quot;} ] ] },
    &quot;StackName&quot;: {
      &quot;Ref&quot;: &quot;NetworkStackName&quot;
    }
  }
}</code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h4 id="aws-resource-cloudformation-customresource-example3.yaml">YAML</h4>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">MyCustomResource: 
  Type: &quot;Custom::TestLambdaCrossStackRef&quot;
  Properties: 
    ServiceToken:
      !Sub |
        arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:${LambdaFunctionName}
    StackName: 
      Ref: &quot;NetworkStackName&quot;</code></pre>
                        </div>
                     
                     
                     <h2 id="w2ab2c21c10d178c19">Replacing a Custom Resource During an Update</h2>
                     
                     
                     <p>You can update custom resources that require a replacement of the underlying physical
                        resource. When you update a custom resource in an AWS CloudFormation template, AWS
                        CloudFormation sends an update
                        request to that custom resource. If the custom resource requires a replacement, the
                        new
                        custom resource must send a response with the new physical ID. When AWS CloudFormation
                        receives the
                        response, it compares the <code class="code">PhysicalResourceId</code> between the old and new custom
                        resources. If they are different, AWS CloudFormation recognizes the update as a replacement
                        and sends a
                        delete request to the old resource. For a step-by-step walkthrough of this process,
                        see
                        <a href="template-custom-resources-sns.html#crpg-walkthrough-stack-updates">Stack Updates</a>. 
                     </p>
                     
                     <p>Note the following: </p>
                     
                     <div class="itemizedlist">
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p>You can monitor the progress of the update in the <b>Events</b> tab.
                                 For more information, see <a href="cfn-console-view-stack-data-resources.html">Viewing Stack Data and Resources</a>.
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>For more information about resource behavior during updates, see <a href="using-cfn-updating-stacks.html">AWS CloudFormation Stacks Updates</a>.
                              </p>
                              
                           </li>
                        </ul>
                     </div>
                     
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be enabled. Please refer to your browser's
                                    Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="aws-resource-authentication.html">&#xAB; Previous </a><a class="awstoc" accesskey="n" href="aws-resource-init.html">Next &#xBB;</a></div>
                     <div id="copyright-main-footer">&#xA9; 2018, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="Syntax"><a class="pagetoc" href="#aws-resource-cloudformation-customresource-syntax">Syntax</a></li>
                        <li class="pagetoc" name="Properties"><a class="pagetoc" href="#w2ab2c21c10d178c13">Properties</a></li>
                        <li class="pagetoc" name="Return Values"><a class="pagetoc" href="#w2ab2c21c10d178c15">Return Values</a></li>
                        <li class="pagetoc" name="Examples"><a class="pagetoc" href="#w2ab2c21c10d178c17">Examples</a></li>
                        <li class="pagetoc" name="Replacing a Custom Resource During an Update"><a class="pagetoc" href="#w2ab2c21c10d178c19">Replacing a Custom Resource During an Update</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='AWS CloudFormation';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='User Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   
</body></html>