<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Walkthrough: Use AWS CloudFormation Designer to Modify a Stack&apos;s Template - AWS CloudFormation</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="home" href="#top">
      <link rel="up" href="CHAP_Using.html" title="Walkthroughs">
      <link rel="prev" href="working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" title="Walkthrough: Use AWS CloudFormation Designer to Create a Basic Web Server">
      <link rel="next" href="peer-with-vpc-in-another-account.html" title="Walkthrough: Peer with an Amazon VPC in Another AWS Account">
      <meta name="description" content="Use AWS CloudFormation Designer to update a basic web server.">
      <meta name="keywords" content="CloudFormation,AWSCloudFormation,resource provisioning,resource configuration,infrastructure management,CloudFormer,CloudFormation Designer,CloudFormation stack,CloudFormation stackset,CloudFormation template,change set">
      <meta name="deployment_region" content="IAD">
      <meta name="product" content="AWS CloudFormation">
      <meta name="guide" content="User Guide">
      <meta name="guide-locale" content="en_us">
      <link rel="icon" type="image/ico" href="/images/favicon.ico">
      <link rel="shortcut icon" type="image/ico" href="/images/favicon.ico">
      <link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/font-awesome.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/google-font.css">
      <link id="code-style" rel="stylesheet" type="text/css" href="../../../css/light.css">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.theme.css">
      <link rel="stylesheet" type="text/css" href="../../../css/colorbox.css">
      <link rel="stylesheet" type="text/css" href="../../../css/awsdocs.css"><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="/js/jquery-ui.min.js"></script><script type="text/javascript" src="/js/handlebars.js"></script><script type="text/javascript" src="/js/jquery.colorbox.js"></script><script type="text/javascript" src="/js/awsdocs.min.js?v=20170615"></script></head>
   <body id="top">
      
      <div id="content-container">
         
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tbody><tr>
                           <td>
                              <div class="breadcrumb"><a href="http://aws.amazon.com/documentation">AWS Documentation</a> &#xBB; <a href="http://aws.amazon.com/documentation/cloudformation">AWS CloudFormation</a> &#xBB; <a href="index.html">User Guide</a> &#xBB; <a href="template-guide.html">Working with AWS CloudFormation Templates</a> &#xBB; <a href="CHAP_Using.html">Walkthroughs</a> &#xBB; <span class="breadcrumb">Walkthrough: Use AWS CloudFormation Designer to Modify a Stack&apos;s Template</span></div>
                           </td>
                        </tr>
                     </tbody></table>
                     <div></div>
                     <h1 class="topictitle" id="working-with-templates-cfn-designer-walkthrough-updatebasicwebserver">Walkthrough: Use AWS CloudFormation Designer to Modify a Stack&apos;s Template</h1>
                     <p>You can use AWS CloudFormation Designer to easily modify a stack&apos;s template, and then
                        submit it to AWS CloudFormation to update the stack. Typically, when you modify a
                        stack,
                        you need to get a copy of its template, modify the template in a text
                        editor, and then use AWS CloudFormation to update the stack. With AWS CloudFormation
                        Designer, you can
                        quickly get a copy of any running stack&apos;s template, modify it, and then
                        update the stack without ever leaving the console. 
                     </p>
                     <p>In this walkthrough, we&apos;ll start with a <a href="working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html">basic web server</a> stack, and then modify it so that the web server
                        is scalable and durable. By the end of the walkthrough, you&apos;ll have a
                        template similar to the following sample: <a href="https://console.aws.amazon.com/cloudformation/designer/home?templateUrl=https://s3.amazonaws.com/cloudformation-examples/sample-as-vpc.template&amp;region=us-east-1" target="_blank">https://console.aws.amazon.com/cloudformation/designer/home?templateUrl=https://s3.amazonaws.com/cloudformation-examples/sample-as-vpc.template&amp;region=us-east-1</a>.
                     </p>
                     <p>In this walkthrough, we will complete the following steps:</p>
                     <div class="orderedlist">
                        
                        
                        
                        
                        
                        <ol>
                           <li>
                              
                              <p><a href="working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html#working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-get-template">Get a stack&apos;s template.</a></p>
                              
                              <p>We&apos;ll get a copy of a running stack&apos;s template; the same basic web
                                 server stack in the following walkthrough: <a href="working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html">Walkthrough: Use AWS CloudFormation Designer to Create a Basic Web Server</a>.
                              </p>
                              
                           </li>
                           <li>
                              
                              <p><a href="working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html#working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-modify-template">Modify the template.</a></p>
                              
                              <p>We&apos;ll use AWS CloudFormation Designer to modify the stack&apos;s template so that your
                                 website is scalable and durable by replacing the EC2 instance with an
                                 Auto Scaling group and an Elastic Load Balancing load balancer. 
                              </p>
                              
                           </li>
                           <li>
                              
                              <p><a href="working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html#working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-update-stack">Update the stack.</a></p>
                              
                              <p>After saving the modifications, we&apos;ll update the basic web server
                                 stack with the modified template.
                              </p>
                              
                              <div class="aws-note">
                                 <p class="aws-note">Note</p>
                                 <p>AWS CloudFormation is a free service; however, you are charged for the
                                    AWS resources you include in your stacks at the current rate for
                                    each. For more information about AWS pricing, see the detail page
                                    for each product on <a href="http://aws.amazon.com" target="_blank">http://aws.amazon.com</a>.
                                 </p>
                              </div>
                              
                           </li>
                           <li>
                              
                              <p><a href="working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html#working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-delete-stack">Delete the stack.</a></p>
                              
                              <p>We&apos;ll delete the stack to clean up all of the resources.</p>
                              
                           </li>
                        </ol>
                     </div>
                     <p>Prerequisites</p>
                     <p>This walkthrough assumes that you have a working knowledge of Amazon Virtual Private
                        Cloud
                        (Amazon VPC), Auto Scaling, Elastic Load Balancing, and AWS CloudFormation. For context,
                        each procedure provides some
                        basic information about each resource.
                     </p>
                     <p>Additionally, the walkthrough assumes that you completed the following
                        walkthrough: <a href="working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html">Walkthrough: Use AWS CloudFormation Designer to Create a Basic Web Server</a>. From that walkthrough, you should have a running stack named
                        <code class="code">BasicWebServerStack</code>.
                     </p>
                     <h2 id="working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-get-template">Step 1: Get a Stack Template</h2>
                     
                     
                     <p>In this step, we&apos;ll use AWS CloudFormation Designer to get and open a copy of a running
                        stack&apos;s template.
                     </p>
                     
                     <p class="title"><b>To get a copy of a running stack&apos;s template</b></p>
                     <ol>
                        <li>
                           
                           <p>Open the AWS CloudFormation console at <a href="https://console.aws.amazon.com/cloudformation/" target="_blank">https://console.aws.amazon.com/cloudformation/</a>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>From the list of stacks, select the
                              <code class="code">BasicWebServerStack</code>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Choose <b>Actions</b>, and then <b>View/Edit
                                 template in Designer</b>.
                           </p>
                           
                        </li>
                     </ol>
                     
                     <p>AWS CloudFormation gets a copy of the <code class="code">BasicWebServerStack</code> stack&apos;s
                        template and displays it in AWS CloudFormation Designer, where you can view the template
                        resources and their relationships. In the following step, we&apos;ll use
                        AWS CloudFormation Designer to modify the template.
                     </p>
                     
                     <h2 id="working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-modify-template"> Step 2: Modify a Template</h2>
                     
                     
                     <p>We&apos;ll modify the basic web server template by using AWS CloudFormation Designer&apos;s
                        drag-and-drop interface and integrated JSON and YAML editor to replace the single
                        Amazon EC2 instance with an Auto Scaling group and load balancer to make the web site
                        scalable. If traffic to the web site suddenly increases, use Auto Scaling to
                        quickly increase the number of web servers. The load balancer will equally
                        distributes the traffic among the instances.
                     </p>
                     
                     <p class="title"><b>To modify a stack template</b></p>
                     <ol>
                        <li>
                           
                           <p>Remove the <code class="code">WebServerInstance</code> resource.
                           </p>
                           
                           <ol>
                              <li>
                                 
                                 <p>Right-click the <code class="code">WebServerInstance</code>
                                    resource.
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>From the resource menu, choose <b>Delete</b> (<span class="inlinemediaobject">
                                       
                                       <img src="../../..//img/designer-resourcemenu-delete.png">
                                       
                                       </span>).
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>Choose <b>OK</b> to confirm.
                                 </p>
                                 
                              </li>
                           </ol>
                           
                        </li>
                        <li>
                           
                           <p>From the <b>Resource types</b> pane, add the
                              following resources into the <code class="code">PublicSubnet</code> resource:
                              <b>AutoScalingGroup</b>,
                              <b>LaunchConfiguration</b>, and
                              <b>LoadBalancer</b>. Before adding resources, you
                              might need to expand the subnet to include all the resources.
                           </p>
                           
                           <p>The resources are organized by resource categories. The Auto Scaling group
                              and launch configuration are in the <b>AutoScaling</b>
                              category, and the load balancer is in the
                              <b>ElasticLoadBalancing</b> category.
                           </p>
                           
                           <div class="aws-note">
                              <p class="aws-note">Note</p>
                              <p>These resources do not follow the container model, so AWS CloudFormation Designer
                                 doesn&apos;t automatically associate them with the subnet. We&apos;ll create
                                 connections later on in this step.
                              </p>
                           </div>
                           
                        </li>
                        <li>
                           
                           <p>From the <b>Resource types</b> pane in the
                              <b>EC2</b> category, add the
                              <b>SecurityGroup</b> resource anywhere in the VPC
                              except in the subnet.
                           </p>
                           
                           <p>This security group will control the inbound and outbound traffic
                              of the load balancer.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Rename the resources to make them easier to identify:</p>
                           
                           <div class="itemizedlist">
                              
                              
                              
                              
                              
                              <ul class="itemizedlist" type="disc">
                                 <li class="listitem">
                                    
                                    <p>Rename <b>AutoScalingGroup</b> to
                                       <code class="code">WebServerFleet</code></p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>Rename <b>LaunchConfiguration</b> to
                                       <code class="code">WebServerLaunchConfig</code></p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>Rename <b>LoadBalancer</b> to
                                       <code class="code">PublicElasticLoadBalancer</code></p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>Rename <b>SecurityGroup</b> to
                                       <code class="code">PublicLoadBalancerSecurityGroup</code></p>
                                    
                                 </li>
                              </ul>
                           </div>
                           
                        </li>
                        <li>
                           
                           <p>Create associations for the resources that you added.</p>
                           
                           <ol>
                              <li>
                                 
                                 <p>Associate the load balancer and Auto Scaling group resources with the
                                    public subnet:
                                 </p>
                                 
                                 <div class="itemizedlist">
                                    
                                    
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p>From the <code class="code">PublicElasticLoadBalancer</code> resource,
                                             drag the <code class="code">AWS::EC2::Subnet (Property: Subnets)</code>
                                             connection to the <code class="code">PublicSubnet</code> resource.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p>From the <code class="code">WebServerFleet</code> resource, drag the
                                             <code class="code">AWS::EC2::Subnet (Property: VPCZoneIdentifier)</code>
                                             connection to the <code class="code">PublicSubnet</code> resource.
                                          </p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 
                              </li>
                              <li>
                                 
                                 <p>Associate the load balancer with its security group:</p>
                                 
                                 <div class="itemizedlist">
                                    
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p>From the <code class="code">PublicElasticLoadBalancer</code> resource,
                                             drag the <code class="code">AWS::EC2::SecurityGroup (Property:
                                                SecurityGroups)</code> connection to the
                                             <code class="code">PublicLoadBalancerSecurityGroup</code>
                                             resource.
                                          </p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 
                              </li>
                              <li>
                                 
                                 <p>Associate the Auto Scaling group with the load balancer and launch
                                    configuration:
                                 </p>
                                 
                                 <div class="itemizedlist">
                                    
                                    
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p>From the <code class="code">WebServerFleet</code> resource, drag the
                                             <code class="code">AWS::ElasticLoadBalancing::LoadBalancer (Property:
                                                LoadBalancerNames)</code> connection to the
                                             <code class="code">PublicElasticLoadBalancer</code> resource.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p>From the <code class="code">WebServerFleet</code> resource, drag the
                                             <code class="code">AWS::ElasticLoadBalancing::LaunchConfiguration
                                                (Property: LaunchConfigurationName)</code> connection to the
                                             <code class="code">WebServerLaunchConfig</code> resource.
                                          </p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 
                              </li>
                              <li>
                                 
                                 <p>Associate the launch configuration with the security
                                    group:
                                 </p>
                                 
                                 <div class="itemizedlist">
                                    
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p>From the <code class="code">WebServerLaunchConfig</code> resource, drag
                                             the <code class="code">AWS::EC2::SecurityGroup (Property:
                                                SecurityGroups)</code> connection to the
                                             <code class="code">WebServerSecurityGroup</code> resource.
                                          </p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 
                              </li>
                              <li>
                                 
                                 <p>Define a dependency for the Auto Scaling group to the public
                                    route:
                                 </p>
                                 
                                 <div class="itemizedlist">
                                    
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p>From the <code class="code">WebServerFleet</code> resource, drag the
                                             <code class="code">DependsOn</code> connection to the
                                             <code class="code">PublicRoute</code> resource.
                                          </p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 
                                 <p>This dependency means that AWS CloudFormation won&apos;t create the
                                    <code class="code">WebServerFleet</code> resource until the public route is
                                    complete. Otherwise, if the public route isn&apos;t available when the
                                    web server instances are starting up, they won&apos;t be able to send
                                    signals (using the cfn-signal helper script) to notify AWS CloudFormation when
                                    their configurations and application deployments are
                                    complete.
                                 </p>
                                 
                              </li>
                           </ol>
                           
                        </li>
                        <li>
                           
                           <p>Specify the properties for the resources that you added.</p>
                           
                           <ol>
                              <li>
                                 
                                 <p>On the AWS CloudFormation Designer canvas, choose the
                                    <code class="code">PublicElasticLoadBalancer</code> resource.
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>In the integrated editor pane, choose the
                                    <b>Properties</b> tab, and then copy the following
                                    snippet and paste it between the <b>Properties</b>
                                    braces (<code class="code">{}</code>).
                                 </p>
                                 
                                 <p>AWS CloudFormation Designer automatically added the security group and subnet
                                    association, so you need to add only the <code class="code">Listeners</code>
                                    and <code class="code">HealthCheck</code> properties. The
                                    <code class="code">Listeners</code> property specifies where and what type of
                                    traffic to listen for, and the <code class="code">HealthCheck</code> property
                                    describes the settings for determining the health status of the
                                    load balancer.
                                 </p>
                                 
                                 <p>JSON</p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight"><b>          &quot;Listeners&quot;: [
          {
            &quot;LoadBalancerPort&quot;: &quot;80&quot;,
            &quot;InstancePort&quot;: &quot;80&quot;,
            &quot;Protocol&quot;: &quot;HTTP&quot;
          }
        ],
        &quot;HealthCheck&quot;: {
          &quot;Target&quot;: &quot;HTTP:80/&quot;,
          &quot;HealthyThreshold&quot;: &quot;3&quot;,
          &quot;UnhealthyThreshold&quot;: &quot;5&quot;,
          &quot;Interval&quot;: &quot;90&quot;,
          &quot;Timeout&quot;: &quot;60&quot;
        },</b>
        &quot;SecurityGroups&quot;: [
          {
            &quot;Ref&quot;: &quot;PublicLoadBalancerSecurityGroup&quot;
          }
        ],
        &quot;Subnets&quot;: [
          {
            &quot;Ref&quot;: &quot;PublicSubnet&quot;
          }
        ]</code></pre>
                                 
                                 <p>YAML</p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight"><b>      Listeners:
        - LoadBalancerPort: &apos;80&apos;
          InstancePort: &apos;80&apos;
          Protocol: HTTP
      HealthCheck:
        Target: &apos;HTTP:80/&apos;
        HealthyThreshold: &apos;3&apos;
        UnhealthyThreshold: &apos;5&apos;
        Interval: &apos;90&apos;
        Timeout: &apos;60&apos;</b>
      SecurityGroups:
        - !Ref PublicLoadBalancerSecurityGroup
      Subnets:
        - !Ref PublicSubnet</code></pre>
                                 </li>
                              <li>
                                 
                                 <p>Repeat this process for the following resources:</p>
                                 
                                 <div class="variablelist">
                                    
                                    
                                    
                                    
                                    
                                    <dl>
                                       
                                       <dt><span class="term"><code class="code">WebServerFleet</code></span></dt>
                                       
                                       <dd>
                                          
                                          <p>Add the <code class="code">MaxSize</code>, <code class="code">MinSize</code>, and
                                             <code class="code">DesiredCapacity</code> properties. These properties
                                             specify the maximum and minimum number of instances that you
                                             can launch in the Auto Scaling group and the initial number of
                                             instances to start with. The desired capacity value refers
                                             to a new parameter, which we&apos;ll add later in this
                                             procedure.
                                          </p>
                                          
                                          <p>JSON</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight"><b>        &quot;MinSize&quot;: &quot;1&quot;,
        &quot;MaxSize&quot;: &quot;10&quot;,
        &quot;DesiredCapacity&quot;: {
          &quot;Ref&quot;: &quot;WebServerCount&quot;
        },</b>
        &quot;VPCZoneIdentifier&quot;: [
          {
            &quot;Ref&quot;: &quot;PublicSubnet&quot;
          }
        ],
        &quot;LaunchConfigurationName&quot;: {
          &quot;Ref&quot;: &quot;WebServerLaunchConfig&quot;
        },
        &quot;LoadBalancerNames&quot;: [
          {
            &quot;Ref&quot;: &quot;PublicElasticLoadBalancer&quot;
          }
        ]</code></pre>
                                          <p>YAML</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight"><b>      MinSize: &apos;1&apos;
      MaxSize: &apos;10&apos;
      DesiredCapacity: !Ref WebServerCount</b>
      VPCZoneIdentifier:
        - !Ref PublicSubnet
      LaunchConfigurationName: !Ref WebServerLaunchConfig
      LoadBalancerNames:
        - !Ref PublicElasticLoadBalancer</code></pre>
                                          </dd>
                                       
                                       
                                       <dt><span class="term"><code class="code">PublicLoadBalancerSecurityGroup</code></span></dt>
                                       
                                       <dd>
                                          
                                          <p>Add the following inbound and outbound rules that
                                             determine the traffic that can reach and leave the load
                                             balancer. The rules allows all HTTP traffic to reach and
                                             leave the load balancer.
                                          </p>
                                          
                                          <p>JSON</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight"><b>        &quot;GroupDescription&quot;: &quot;Public Elastic Load Balancing security group with HTTP access on port 80 from the Internet&quot;,
        &quot;SecurityGroupIngress&quot;: [
          {
            &quot;IpProtocol&quot;: &quot;tcp&quot;,
            &quot;FromPort&quot;: &quot;80&quot;,
            &quot;ToPort&quot;: &quot;80&quot;,
            &quot;CidrIp&quot;: &quot;0.0.0.0/0&quot;
          }
        ],
        &quot;SecurityGroupEgress&quot;: [
          {
            &quot;IpProtocol&quot;: &quot;tcp&quot;,
            &quot;FromPort&quot;: &quot;80&quot;,
            &quot;ToPort&quot;: &quot;80&quot;,
            &quot;CidrIp&quot;: &quot;0.0.0.0/0&quot;
          }
        ],</b>
        &quot;VpcId&quot;: {
          &quot;Ref&quot;: &quot;VPC&quot;
        }</code></pre>
                                          
                                          <p>YAML</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight"><b>      GroupDescription: &gt;-
        Public Elastic Load Balancing security group with HTTP access on port 80
        from the Internet
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: &apos;80&apos;
          ToPort: &apos;80&apos;
          CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
        - IpProtocol: tcp
          FromPort: &apos;80&apos;
          ToPort: &apos;80&apos;
          CidrIp: 0.0.0.0/0</b>
      VpcId: !Ref VPC</code></pre>
                                          </dd>
                                       
                                       
                                       <dt><span class="term"><code class="code">WebServerSecurityGroup</code></span></dt>
                                       
                                       <dd>
                                          
                                          <p>Modify the HTTP inbound rule to allow only traffic from
                                             the load balancer.
                                          </p>
                                          
                                          <p>JSON</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">        &quot;GroupDescription&quot;: &quot;Allow access from load balancer and SSH traffic&quot;,
        &quot;SecurityGroupIngress&quot;: [
          {
            &quot;IpProtocol&quot;: &quot;tcp&quot;,
            &quot;FromPort&quot;: &quot;80&quot;,
            &quot;ToPort&quot;: &quot;80&quot;,
<b>            &quot;SourceSecurityGroupId&quot;: {
              &quot;Ref&quot;: &quot;PublicLoadBalancerSecurityGroup&quot;
            }</b>
          },
          {
            &quot;IpProtocol&quot;: &quot;tcp&quot;,
            &quot;FromPort&quot;: &quot;22&quot;,
            &quot;ToPort&quot;: &quot;22&quot;,
            &quot;CidrIp&quot;: {
              &quot;Ref&quot;: &quot;SSHLocation&quot;
            }
          }
        ],
        &quot;VpcId&quot;: {
          &quot;Ref&quot;: &quot;VPC&quot;
        }</code></pre>
                                          <p>YAML</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">      VpcId: !Ref VPC
      GroupDescription: Allow access from load balancer and SSH traffic
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: &apos;80&apos;
          ToPort: &apos;80&apos;
          <b>SourceSecurityGroupId: !Ref PublicLoadBalancerSecurityGroup</b>
        - IpProtocol: tcp
          FromPort: &apos;22&apos;
          ToPort: &apos;22&apos;
          CidrIp: !Ref SSHLocation</code></pre>
                                          </dd>
                                       
                                       
                                       <dt><span class="term"><code class="code">WebServerLaunchConfig</code></span></dt>
                                       
                                       <dd>
                                          
                                          <p>The launch configuration has a number of different
                                             properties that you need to specify, so we&apos;ll highlight just
                                             a few of them. The <code class="code">InstanceType</code> and
                                             <code class="code">ImageId</code> properties use the parameter and
                                             mapping values that were already specified in the template.
                                             You specify the instance type as a parameter value when you
                                             create a stack. The <code class="code">ImageId</code> value is a mapping
                                             that is based on your stack&apos;s region and the instance type
                                             that you specified.
                                          </p>
                                          
                                          <p>In the <code class="code">UserData</code> property, we specify
                                             configurations scripts that run after the instance is up and
                                             running. All of the configuration information is defined in
                                             the instance&apos;s metadata, which we&apos;ll add in the next
                                             step.
                                          </p>
                                          
                                          <p>JSON</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight"><b>        &quot;InstanceType&quot;: {
          &quot;Ref&quot;: &quot;InstanceType&quot;
        },
        &quot;ImageId&quot;: {
          &quot;Fn::FindInMap&quot;: [
            &quot;AWSRegionArch2AMI&quot;,
            {
              &quot;Ref&quot;: &quot;AWS::Region&quot;
            },
            {
              &quot;Fn::FindInMap&quot;: [
                &quot;AWSInstanceType2Arch&quot;,
                {
                  &quot;Ref&quot;: &quot;InstanceType&quot;
                },
                &quot;Arch&quot;
              ]
            }
          ]
        },
        &quot;KeyName&quot;: {
          &quot;Ref&quot;: &quot;KeyName&quot;
        },
        &quot;AssociatePublicIpAddress&quot;: &quot;true&quot;,
        &quot;UserData&quot;: {
          &quot;Fn::Base64&quot;: {
            &quot;Fn::Join&quot;: [
              &quot;&quot;,
              [
                &quot;#!/bin/bash -xe\n&quot;,
                &quot;yum install -y aws-cfn-bootstrap\n&quot;,
                &quot;# Install the files and packages from the metadata\n&quot;,
                &quot;/opt/aws/bin/cfn-init -v &quot;,
                &quot;         --stack &quot;,
                {
                  &quot;Ref&quot;: &quot;AWS::StackName&quot;
                },
                &quot;         --resource WebServerLaunchConfig &quot;,
                &quot;         --configsets All &quot;,
                &quot;         --region &quot;,
                {
                  &quot;Ref&quot;: &quot;AWS::Region&quot;
                },
                &quot;\n&quot;,
                &quot;# Signal the status from cfn-init\n&quot;,
                &quot;/opt/aws/bin/cfn-signal -e $? &quot;,
                &quot;         --stack &quot;,
                {
                  &quot;Ref&quot;: &quot;AWS::StackName&quot;
                },
                &quot;         --resource WebServerFleet &quot;,
                &quot;         --region &quot;,
                {
                  &quot;Ref&quot;: &quot;AWS::Region&quot;
                },
                &quot;\n&quot;
              ]
            ]
          }
        },</b>
        &quot;SecurityGroups&quot;: [
          {
            &quot;Ref&quot;: &quot;WebServerSecurityGroup&quot;
          }
        ]</code></pre>
                                          <p>YAML</p>
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight"><b>      InstanceType: !Ref InstanceType
      ImageId: !FindInMap 
        - AWSRegionArch2AMI
        - !Ref &apos;AWS::Region&apos;
        - !FindInMap 
          - AWSInstanceType2Arch
          - !Ref InstanceType
          - Arch
      KeyName: !Ref KeyName
      AssociatePublicIpAddress: &apos;true&apos;
      UserData: !Base64 
        &apos;Fn::Join&apos;:
          - &apos;&apos;
          - - |
              #!/bin/bash -xe
            - |
              yum install -y aws-cfn-bootstrap
            - |
              # Install the files and packages from the metadata
            - &apos;/opt/aws/bin/cfn-init -v &apos;
            - &apos;         --stack &apos;
            - !Ref &apos;AWS::StackName&apos;
            - &apos;         --resource WebServerLaunchConfig &apos;
            - &apos;         --configsets All &apos;
            - &apos;         --region &apos;
            - !Ref &apos;AWS::Region&apos;
            - |+

            - |
              # Signal the status from cfn-init
            - &apos;/opt/aws/bin/cfn-signal -e $? &apos;
            - &apos;         --stack &apos;
            - !Ref &apos;AWS::StackName&apos;
            - &apos;         --resource WebServerFleet &apos;
            - &apos;         --region &apos;
            - !Ref &apos;AWS::Region&apos;
            - |+</b>

      SecurityGroups:
        - !Ref WebServerSecurityGroup</code></pre>
                                          </dd>
                                       
                                    </dl>
                                 </div>
                                 
                              </li>
                           </ol>
                           
                        </li>
                        <li>
                           
                           <p>Add the launch configuration metadata to the
                              <code class="code">WebServerLaunchConfig</code> resource, which instructs the
                              cfn-init helper script to start the web server and create a basic web
                              page.
                           </p>
                           
                           <ol>
                              <li>
                                 
                                 <p>Choose the <code class="code">WebServerLaunchConfig</code> resource, and
                                    then choose the <b>Metadata</b> tab in the
                                    integrated editor.
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p><em>If you are authoring your template in
                                       JSON</em>: Within the <code class="code">Metadata</code> braces
                                    (<code class="code">{}</code>), after the
                                    <code class="code">AWS::CloudFormation::Designer</code> closing brace, add a
                                    comma (<code class="code">,</code>).
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>Add the following snippet, which instructs the cfn-init helper
                                    script to start the web server and create a basic web page, after
                                    the <code class="code">AWS::CloudFormation::Designer</code> property.
                                 </p>
                                 
                                 <p>JSON</p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">        &quot;AWS::CloudFormation::Init&quot; : {
          &quot;configSets&quot; : {
            &quot;All&quot; : [ &quot;ConfigureSampleApp&quot; ]
          },
          &quot;ConfigureSampleApp&quot; : {
            &quot;packages&quot; : {
              &quot;yum&quot; : {
                &quot;httpd&quot; : []
              }
            },
            &quot;files&quot; : {
              &quot;/var/www/html/index.html&quot; : {
                &quot;content&quot; : { &quot;Fn::Join&quot; : [&quot;\n&quot;, [
                  &quot;&lt;h1&gt;Congratulations, you have successfully launched the AWS CloudFormation sample.&lt;/h1&gt;&quot;
                ]]},
                &quot;mode&quot;    : &quot;000644&quot;,
                &quot;owner&quot;   : &quot;root&quot;,
                &quot;group&quot;   : &quot;root&quot;
              }
            },
            &quot;services&quot; : {
              &quot;sysvinit&quot; : {
                &quot;httpd&quot;    : { &quot;enabled&quot; : &quot;true&quot;, &quot;ensureRunning&quot; : &quot;true&quot; }
              }
            }
          }
        }</code></pre>
                                 <p>YAML</p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">      &apos;AWS::CloudFormation::Init&apos;:
        configSets:
          All:
            - ConfigureSampleApp
        ConfigureSampleApp:
          packages:
            yum:
              httpd: []
          files:
            /var/www/html/index.html:
              content: !Join 
                - |+

                - - &gt;-
                    &lt;h1&gt;Congratulations, you have successfully launched the AWS
                    CloudFormation sample.&lt;/h1&gt;
              mode: &apos;000644&apos;
              owner: root
              group: root
          services:
            sysvinit:
              httpd:
                enabled: &apos;true&apos;
                ensureRunning: &apos;true&apos;</code></pre>
                                 </li>
                           </ol>
                           
                        </li>
                        <li>
                           
                           <p>Add the <code class="code">WebServerCount</code> parameter. This parameter
                              specifies how many instances to create when AWS CloudFormation creates the Auto Scaling
                              group.
                           </p>
                           
                           <ol>
                              <li>
                                 
                                 <p>Click on an open area on the AWS CloudFormation Designer canvas.</p>
                                 
                              </li>
                              <li>
                                 
                                 <p>In the integrated editor pane, choose the
                                    <b>Parameters</b> tab.
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>Add the following parameter in the
                                    integrated editor. If you&apos;re authoring the template in
                                    JSON, add a comma as needed.
                                 </p>
                                 
                                 <p>JSON</p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">    &quot;WebServerCount&quot;: {
      &quot;Description&quot;: &quot;Number of Amazon EC2 instances to launch for the WebServer server&quot;,
      &quot;Type&quot;: &quot;Number&quot;,
      &quot;Default&quot;: &quot;1&quot;
    }</code></pre>
                                 <p>YAML</p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">  WebServerCount:
    Description: Number of Amazon EC2 instances to launch for the WebServer server
    Type: Number
    Default: &apos;1&apos;</code></pre>
                                 </li>
                           </ol>
                           
                        </li>
                        <li>
                           
                           <p>Modify the template output to show the DNS name of the load
                              balancer.
                           </p>
                           
                           <ol>
                              <li>
                                 
                                 <p>In the integrated editor pane, choose the
                                    <b>Outputs</b> tab.
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>Modify the JSON to use the load balancer DNS name, as shown in
                                    the following snippet.
                                 </p>
                                 
                                 <p>JSON</p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">{
  &quot;Outputs&quot;: {
    &quot;URL&quot;: {
      &quot;Value&quot;: {
<b>        &quot;Fn::GetAtt&quot;: [
          &quot;PublicElasticLoadBalancer&quot;,
          &quot;DNSName&quot;
        ]</b>
      },
      &quot;Description&quot;: &quot;Newly created application URL&quot;
    }
  }
}</code></pre>
                                 <p>If you&apos;re authoring your template in YAML, use the following
                                    snippet.
                                 </p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Outputs:
  URL:
    Value: !GetAtt 
      - PublicElasticLoadBalancer
      - DNSName
    Description: Newly created application URL</code></pre>
                                 </li>
                           </ol>
                           
                        </li>
                        <li>
                           
                           <p>On the AWS CloudFormation Designer toolbar, choose <b>Validate
                                 template</b> (<span class="inlinemediaobject">
                                 
                                 <img src="../../..//img/designer-validate-icon.png">
                                 
                                 </span>) to check for syntax errors in your
                              template.
                           </p>
                           
                           <p>View and fix errors in the <b>Messages</b> pane, and
                              then validate the template again. If you don&apos;t see errors, your
                              template is syntactically valid.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>From the AWS CloudFormation Designer toolbar, save the template locally by choosing
                              <b>File</b> (<span class="inlinemediaobject">
                                 
                                 <img src="../../..//img/designer-file-menu.png">
                                 
                                 </span>) and then <b>Save</b>.
                           </p>
                           
                        </li>
                     </ol>
                     
                     <p>You now have a modified AWS CloudFormation template that you can use to update the
                        basic web server stack. In the next step, we&apos;ll use this template to
                        update the basic web server stack.
                     </p>
                     
                     <h2 id="working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-update-stack">Step 3: Update the Stack</h2>
                     
                     
                     <p>To implement your template changes, we need to update the basic web
                        server stack. You can launch the AWS CloudFormation Update Stack Wizard directly from
                        AWS CloudFormation Designer.
                     </p>
                     
                     <p class="title"><b>To update the stack</b></p>
                     <ol>
                        <li>
                           
                           <p>On the AWS CloudFormation Designer toolbar, choose <b>Create
                                 Stack</b> (<span class="inlinemediaobject">
                                 
                                 <img src="../../..//img/designer-create-stack-icon.png">
                                 
                                 </span>).
                           </p>
                           
                           <p>AWS CloudFormation Designer saves the opened template in an S3 bucket and then
                              launches the AWS CloudFormation Update Stack Wizard. Because we modified the
                              <code class="code">BasicWebServerStack</code> stack&apos;s template, AWS CloudFormation launches
                              the Update Stack Wizard for that stack.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>AWS CloudFormation automatically populates the template URL; choose
                              <b>Next</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>In the <b>Stack</b> section, in the
                              <b>Name</b> field, verify that the stack name is
                              <code class="code">BasicWebServerStack</code>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>In the <b>Parameters</b> section, use the existing
                              values; choose <b>Next</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>For this walkthrough, you don&apos;t need to add tags or specify
                              advanced settings, so choose <b>Next</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Ensure that the stack name is correct, and then choose
                              <b>Update</b>.
                           </p>
                           
                        </li>
                     </ol>
                     
                     <p>It can take several minutes for AWS CloudFormation to update your stack. To
                        monitor progress, view the stack events. For more information, see <a href="cfn-console-view-stack-data-resources.html">Viewing Stack Data and Resources</a>. After the stack
                        is updated, view the stack outputs and go to the website URL to verify
                        that the website is running. For more information, see <a href="cfn-console-view-stack-data-resources.html">Viewing Stack Data and Resources</a>. You
                        successfully updated a template and a stack using AWS CloudFormation Designer.
                     </p>
                     
                     <p>To ensure that you are not charged for unwanted services, you can
                        delete this stack.
                     </p>
                     
                     <h2 id="working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-delete-stack">Step 4: Clean Up Resources</h2>
                     
                     
                     <p>To make sure you are not charged for unwanted services, delete your
                        stack and it&apos;s resources.
                     </p>
                     
                     <p class="title"><b>To delete the stack</b></p>
                     <ol>
                        <li>
                           
                           <p>From the AWS CloudFormation console, choose the
                              <b>BasicWebServerStack</b> stack.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Choose <b>Delete Stack</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>In the confirmation message, choose <b>Yes,
                                 Delete</b>.
                           </p>
                           
                        </li>
                     </ol>
                     
                     <p>It can take several minutes for AWS CloudFormation to delete your stack. To
                        monitor progress, view the stack events. After the stack is deleted, all
                        the resources that you created are deleted. Now that you understand how to
                        use AWS CloudFormation Designer, you can use it to build and modify your own templates.
                        
                     </p>
                     
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be enabled. Please refer to your browser's
                                    Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html">&#xAB; Previous </a><a class="awstoc" accesskey="n" href="peer-with-vpc-in-another-account.html">Next &#xBB;</a></div>
                     <div id="copyright-main-footer">&#xA9; 2018, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="Step 1: Get a Stack Template"><a class="pagetoc" href="#working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-get-template">Step 1: Get a Stack Template</a></li>
                        <li class="pagetoc" name=" Step 2: Modify a Template"><a class="pagetoc" href="#working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-modify-template"> Step 2: Modify a Template</a></li>
                        <li class="pagetoc" name="Step 3: Update the Stack"><a class="pagetoc" href="#working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-update-stack">Step 3: Update the Stack</a></li>
                        <li class="pagetoc" name="Step 4: Clean Up Resources"><a class="pagetoc" href="#working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-delete-stack">Step 4: Clean Up Resources</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='AWS CloudFormation';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='User Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   
</body></html>