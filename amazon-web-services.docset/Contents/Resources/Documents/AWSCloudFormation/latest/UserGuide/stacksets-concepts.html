<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>StackSets Concepts - AWS CloudFormation</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="home" href="#top">
      <link rel="up" href="what-is-cfnstacksets.html" title="Working with AWS CloudFormation StackSets">
      <link rel="prev" href="what-is-cfnstacksets.html" title="Working with AWS CloudFormation StackSets">
      <link rel="next" href="stacksets-prereqs.html" title="Prerequisites: Granting Permissions for Stack Set Operations">
      <meta name="description" content="Describes fundamental StackSets concepts and how they are related.">
      <meta name="keywords" content="CloudFormation,AWSCloudFormation,resource provisioning,resource configuration,infrastructure management,CloudFormer,CloudFormation Designer,CloudFormation stack,CloudFormation stackset,CloudFormation template,change set">
      <meta name="deployment_region" content="IAD">
      <meta name="product" content="AWS CloudFormation">
      <meta name="guide" content="User Guide">
      <meta name="guide-locale" content="en_us">
      <link rel="icon" type="image/ico" href="/images/favicon.ico">
      <link rel="shortcut icon" type="image/ico" href="/images/favicon.ico">
      <link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stacksets-concepts.html">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/font-awesome.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/google-font.css">
      <link id="code-style" rel="stylesheet" type="text/css" href="../../../css/light.css">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.theme.css">
      <link rel="stylesheet" type="text/css" href="../../../css/colorbox.css">
      <link rel="stylesheet" type="text/css" href="../../../css/awsdocs.css"><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="/js/jquery-ui.min.js"></script><script type="text/javascript" src="/js/handlebars.js"></script><script type="text/javascript" src="/js/jquery.colorbox.js"></script><script type="text/javascript" src="/js/awsdocs.min.js?v=20170615"></script></head>
   <body id="top">
      
      <div id="content-container">
         
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tbody><tr>
                           <td>
                              <div class="breadcrumb"><a href="http://aws.amazon.com/documentation">AWS Documentation</a> &#xBB; <a href="http://aws.amazon.com/documentation/cloudformation">AWS CloudFormation</a> &#xBB; <a href="index.html">User Guide</a> &#xBB; <a href="what-is-cfnstacksets.html">Working with AWS CloudFormation StackSets</a> &#xBB; <span class="breadcrumb">StackSets Concepts</span></div>
                           </td>
                        </tr>
                     </tbody></table>
                     <div></div>
                     <h1 class="topictitle" id="stacksets-concepts">StackSets Concepts</h1>
                     <p>When you use StackSets, you work with <em>stack sets</em>, <em>stack
                           instances</em>, and <em>stacks</em>.
                     </p>
                     <div class="highlights" id="inline-topiclist">
                        <p><strong>Topics</strong></p>
                        <ul>
                           <li><a href="#stacksets-concepts-accts">Administrator and target accounts</a></li>
                           <li><a href="#stacksets-concepts-stackset">Stack sets</a></li>
                           <li><a href="#stacksets-concepts-stackinstances">Stack instances</a></li>
                           <li><a href="#stacksets-concepts-ops">Stack set operations</a></li>
                           <li><a href="#stackset-ops-options">Stack set operation options</a></li>
                           <li><a href="#stackset-concepts-tags">Tags</a></li>
                           <li><a href="#stackset-status-codes">Stack set and stack instance status
                                 codes</a></li>
                        </ul>
                     </div>
                     <h2 id="stacksets-concepts-accts">Administrator and target accounts</h2>
                     
                     
                     <p>An <em>administrator account</em> is the AWS account in which
                        you create stack sets. A stack set is managed by signing in to the AWS administrator
                        account in which it was created. A <em>target account</em> is the
                        account into which you create, update, or delete one or more stacks in your stack
                        set. Before you can use a stack set to create stacks in a target account, you must
                        set up a trust relationship between the administrator and target accounts.
                     </p>
                     
                     <h2 id="stacksets-concepts-stackset">Stack sets</h2>
                     
                     
                     <p>A <em>stack set</em> lets you create stacks in AWS accounts across
                        regions by using a single AWS CloudFormation template. All the resources included
                        in each stack
                        are defined by the stack set&apos;s AWS CloudFormation template. As you create the stack
                        set, you
                        specify the template to use, as well as any parameters and capabilities that
                        template requires.
                     </p>
                     
                     <p>After you&apos;ve defined a stack set, you can create, update, or delete stacks in the
                        target accounts and regions you specify. When you create, update, or delete stacks,
                        you can also specify operation preferences, such as the order of regions in which
                        you want the operation to be performed, the failure tolerance beyond which stack
                        operations stop, and the number of accounts in which operations are performed on
                        stacks concurrently.
                     </p>
                     
                     <p>A stack set is a regional resource. If you create a stack set in one region, you
                        cannot see it or change it in other regions.
                     </p>
                     
                     <h2 id="stacksets-concepts-stackinstances">Stack instances</h2>
                     
                     
                     <p>A <em>stack instance</em> is a reference to a stack in a target account within a region. 
                        A stack instance can exist without a stack; for example, 
                        if the stack could not be created for some reason, the stack instance shows the reason
                        for stack creation failure. A stack instance is 
                        associated with only one stack set.
                     </p>
                     
                     <p>The following figure shows the logical relationships between stack sets, stack
                        operations, and stacks. When you update a stack set, <em>all</em>
                        associated stack instances are updated throughout all accounts and regions.
                     </p>
                     
                     <div class="mediaobject">
                        
                        <img src="../../..//img/stack_sets_operations_stacks_sv.png" alt="
                    A single stack set can serve as the basis to create, update, or delete
                        stacks instances and stacks across multiple accounts and regions.
                " style="max-width:100%">
                        
                        
                        
                     </div>
                     
                     <h2 id="stacksets-concepts-ops">Stack set operations</h2>
                     
                     
                     <p>You can perform the following operations on stack sets.</p>
                     
                     <div class="variablelist">
                        
                        
                        
                        
                        
                        <dl>
                           
                           <dt><span class="term">Create stack set</span></dt>
                           
                           <dd>
                              
                              <p>Creating a new stack set includes specifying an AWS CloudFormation template that
                                 you want to use to create stacks, specifying the target accounts in
                                 which you want to create stacks, and identifying the AWS regions in
                                 which you want to deploy stacks in your target accounts. A stack set
                                 ensures consistent deployment of the same stack resources, with the same
                                 settings, to all specified target accounts within the regions you
                                 choose.
                              </p>
                              
                           </dd>
                           
                           
                           <dt><span class="term">Update stack set</span></dt>
                           
                           <dd>
                              
                              <p>When you update a stack set, you push changes out to stacks in your
                                 stack set. You can update a stack set in one of the following ways. Note
                                 that your template updates always affect all stacks; you cannot selectively
                                 update the template for some stacks in the stacks set, but not others.
                              </p>
                              
                              <div class="itemizedlist">
                                 
                                 
                                 
                                 
                                 <ul class="itemizedlist" type="disc">
                                    <li class="listitem">
                                       
                                       <p>Change existing settings in the template or add new resources,
                                          such as updating parameter settings for a specific service, or
                                          adding new Amazon EC2 instances.
                                       </p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p>Replace the template with a different template.</p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p>Add stacks in existing or additional target accounts, across existing or additional
                                          regions.
                                       </p>
                                       
                                    </li>
                                 </ul>
                              </div>
                              
                           </dd>
                           
                           
                           <dt><span class="term">Delete stacks</span></dt>
                           
                           <dd>
                              
                              <p>When you delete stacks, you are removing a stack and all its
                                 associated resources from the target accounts you specify, within the
                                 regions you specify. You can delete stacks in the following ways.
                              </p>
                              
                              <div class="itemizedlist">
                                 
                                 
                                 
                                 
                                 
                                 <ul class="itemizedlist" type="disc">
                                    <li class="listitem">
                                       
                                       <p>Delete stacks from some target accounts, while leaving other
                                          stacks in other target accounts running.
                                       </p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p>Delete stacks from some regions, while leaving stacks in other
                                          regions running.
                                       </p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p>Delete stacks from your stack set, but save them so they
                                          continue to run independently of your stack set by choosing the
                                          <b>Retain Stacks</b> option. Retained stacks
                                          are managed in AWS CloudFormation, outside of your stack set.
                                       </p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p>Delete all stacks in your stack set, in preparation for
                                          deleting your entire stack set.
                                       </p>
                                       
                                    </li>
                                 </ul>
                              </div>
                              
                           </dd>
                           
                           
                           <dt><span class="term">Delete stack set</span></dt>
                           
                           <dd>
                              
                              <p>You can delete your stack set only when there are no stack instances in it.</p>
                              
                           </dd>
                           
                        </dl>
                     </div>
                     
                     <h2 id="stackset-ops-options">Stack set operation options</h2>
                     
                     
                     <p>The options described in this section help to control the time and number of 
                        failures allowed to successfully perform stack set operations, and prevent you 
                        from losing stack resources.
                     </p>
                     
                     <div class="variablelist">
                        
                        
                        
                        
                        <dl>
                           
                           <dt><span class="term">Maximum concurrent accounts</span></dt>
                           
                           <dd>
                              
                              <p>This setting, available in create, update, and delete workflows, lets
                                 you specify the maximum number or percentage of target accounts in which
                                 an operation is performed at one time. A lower number or percentage
                                 means that an operation is performed in fewer target accounts at one
                                 time. Operations are performed in one region at a time, in the order
                                 specified in the <b>Deployment order </b>box. For example,
                                 if you are deploying stacks to 10 target accounts within two regions,
                                 setting <b>Maximum concurrent accounts</b> to
                                 <b>50</b> and <b>By percentage</b> will
                                 deploy stacks to five accounts in the first region, then the second five
                                 accounts within the first region, before moving on to the next region
                                 and beginning deployment to the first five target accounts.
                              </p>
                              
                              <p>When you choose <b>By percentage</b>, if the specified
                                 percentage does not represent a whole number of your specified accounts,
                                 AWS CloudFormation rounds down. For example, if you are deploying stacks to 10 target
                                 accounts, and you set <b>Maximum concurrent accounts</b>
                                 to <b>25</b> and <b>By percentage</b>, AWS CloudFormation
                                 rounds down from deploying 2.5 stacks concurrently (which would not be
                                 possible) to deploying two stacks concurrently.
                              </p>
                              
                              <p>Note that this setting lets you specify the <em>maximum</em> for operations. For large deployments, under certain circumstances the actual number
                                 of accounts acted upon concurrently may be lower due to service throttling.
                              </p>
                              
                           </dd>
                           
                           
                           <dt><span class="term">Failure tolerance</span></dt>
                           
                           <dd>
                              
                              <p>This setting, available in create, update, and delete workflows, lets
                                 you specify the maximum number or percentage of stack operation failures
                                 that can occur, per region, beyond which AWS CloudFormation stops an operation
                                 automatically. A lower number or percentage means that the operation is
                                 performed on fewer stacks, but you are able to start troubleshooting
                                 failed operations faster. For example, if you are updating 10 stacks in
                                 10 target accounts within three regions, setting <b>Failure
                                    tolerance</b> to <b>20</b> and <b>By
                                    percentage</b> means that a maximum of two stack updates in a region can
                                 fail for the operation to continue. If a third stack in the same region fails, AWS
                                 CloudFormation stops the operation. If a stack could not be updated
                                 in the first region, the update operation continues in that region, and then moves
                                 on to the next region.
                                 If two stacks cannot be updated in the second region, the failure
                                 tolerance of 20% is reached; if a third stack in the region fails, AWS CloudFormation
                                 stops the update operation, and does
                                 not go on to subsequent regions.
                              </p>
                              
                              <p>When you choose <b>By percentage</b>, if the specified
                                 percentage does not represent a whole number of your stacks within each
                                 region, AWS CloudFormation rounds down. For example, if you are deploying stacks to
                                 10 target accounts in three regions, and you set <b>Failure
                                    tolerance</b> to <b>25</b> and <b>By
                                    percentage</b>, AWS CloudFormation rounds down from a failure tolerance of
                                 2.5 stacks (which would not be possible) to a failure tolerance of two
                                 stacks per region.
                              </p>
                              
                           </dd>
                           
                           
                           <dt><span class="term">Retain stacks</span></dt>
                           
                           <dd>
                              
                              <p>This setting, available in delete stack workflows, lets you keep
                                 stacks and their resources running even after they have been removed
                                 from a stack set. When you retain stacks, AWS CloudFormation leaves
                                 stacks in individual accounts and regions intact. Stacks are
                                 disassociated from the stack set, but the stack and its resources are
                                 saved. After a delete stacks operation is complete, you manage retained
                                 stacks in AWS CloudFormation, in the target account (not the administrator account)
                                 in which they were created. Retaining stacks permanently disassociates a
                                 stack from a stack set; the stack cannot be added to the stack set
                                 again, and it cannot be added to a new stack set.
                              </p>
                              
                           </dd>
                           
                        </dl>
                     </div>
                     
                     <h2 id="stackset-concepts-tags">Tags</h2>
                     
                     
                     <p>You can add tags during stack set creation and update operations by
                        specifying key and value pairs. Tags are useful for sorting and
                        filtering stack set resources for billing and cost allocation. For more
                        information about how tags are used in AWS, see <a href="./awsaccountbilling/latest/aboutv2/cost-alloc-tags.html" target="_blank">Using Cost Allocation Tags</a> in the <em>AWS Billing and Cost Management User
                           Guide</em>. After you specify the key-value pair, choose
                        <b>+</b> to save the tag.You can delete tags that you
                        are no longer using by choosing the red <b>X</b> to the
                        right of a tag.
                     </p>
                     
                     <p>Tags that you apply to stack sets are applied to all stacks, and the resources that
                        are created by your stacks. Tags can be added at the stack-only
                        level in AWS CloudFormation, but those tags might not show up in
                        StackSets.
                     </p>
                     
                     <p>Although StackSets does not currently add any system-defined tags,
                        you should not start the key names of any tags with the string
                        <code class="code">aws:</code>.
                     </p>
                     
                     <h2 id="stackset-status-codes">Stack set and stack instance status
                        codes
                     </h2>
                     
                     
                     <p>AWS CloudFormation StackSets generates status codes
                        for stack set operations and stack instances.
                     </p>
                     
                     <p>The following table describes status codes for stack set operations.</p>
                     
                     <div class="table">
                        <div class="table-contents">
                           <table id="w327ab1c19c11c19b6">
                              
                              <tbody><tr>
                                 
                                 <th>Stack Set Operation Status</th>
                                 
                                 <th>Description</th>
                                 
                              </tr>
                              
                              
                              <tr>
                                 
                                 <td>
                                    
                                    <p><code class="code">RUNNING</code></p>
                                    
                                 </td>
                                 
                                 <td>
                                    
                                    <p>The operation is currently in progress.</p>
                                    
                                 </td>
                                 
                              </tr>
                              
                              <tr>
                                 
                                 <td>
                                    
                                    <p><code class="code">SUCCEEDED</code></p>
                                    
                                 </td>
                                 
                                 <td>
                                    
                                    <p>The operation finished without exceeding the failure tolerance for the operation.</p>
                                    
                                 </td>
                                 
                              </tr>
                              
                              <tr>
                                 
                                 <td>
                                    
                                    <p><code class="code">FAILED</code></p>
                                    
                                 </td>
                                 
                                 <td>
                                    
                                    <p>The number of stacks on which the operation could not be
                                       completed exceeded the user-defined failure tolerance. The
                                       failure tolerance value you&apos;ve set for an operation is applied
                                       for each region during stack creation and update operations. If
                                       the number of failed stacks within a region exceeds the failure
                                       tolerance, the status of the operation in the region is set to
                                       <code class="code">FAILED</code>. The status of the operation as a whole
                                       is also set to <code class="code">FAILED</code>, and AWS CloudFormation cancels the
                                       operation in any remaining regions.
                                    </p>
                                    
                                 </td>
                                 
                              </tr>
                              
                              <tr>
                                 
                                 <td>
                                    
                                    <p><code class="code">STOPPING</code></p>
                                    
                                 </td>
                                 
                                 <td>
                                    
                                    <p>The operation is in the process of stopping, at the user&apos;s
                                       request.
                                    </p>
                                    
                                 </td>
                                 
                              </tr>
                              
                              <tr>
                                 
                                 <td><code class="code">STOPPED</code></td>
                                 
                                 <td>
                                    
                                    <p>The operation has been stopped, at the user&apos;s request.</p>
                                    
                                 </td>
                                 
                              </tr>
                              
                           </tbody></table>
                        </div>
                     </div>
                     
                     <p>The following table describes status codes for stack instances within stack
                        sets.
                     </p>
                     
                     <div class="table">
                        <div class="table-contents">
                           <table id="w327ab1c19c11c19c10">
                              
                              <tbody><tr>
                                 
                                 <th>Stack Instance Status</th>
                                 
                                 <th>Description</th>
                                 
                              </tr>
                              
                              
                              
                              <tr>
                                 
                                 <td>
                                    
                                    <p><code class="code">CURRENT</code></p>
                                    
                                 </td>
                                 
                                 <td>
                                    
                                    <p>The stack is currently up to date with the stack set.</p>
                                    
                                 </td>
                                 
                              </tr>
                              
                              <tr>
                                 
                                 <td>
                                    
                                    <p><code class="code">OUTDATED</code></p>
                                    
                                 </td>
                                 
                                 <td>
                                    
                                    <p>The stack is not currently up to date with the stack set for
                                       one of the following reasons.
                                    </p>
                                    
                                    <div class="itemizedlist">
                                       
                                       
                                       
                                       <ul class="itemizedlist" type="disc">
                                          <li class="listitem">
                                             
                                             <p>A <code class="code">CreateStackSet</code> or
                                                <code class="code">UpdateStackSet</code> operation on the
                                                associated stack failed.
                                             </p>
                                             
                                          </li>
                                          <li class="listitem">
                                             
                                             <p>The stack was part of a <code class="code">CreateStackSet</code> or
                                                <code class="code">UpdateStackSet</code> operation that failed,
                                                or was stopped before the stack was created or
                                                updated.
                                             </p>
                                             
                                          </li>
                                       </ul>
                                    </div>
                                    
                                 </td>
                                 
                              </tr>
                              
                              <tr>
                                 
                                 <td>
                                    
                                    <p><code class="code">INOPERABLE</code></p>
                                    
                                 </td>
                                 
                                 <td>
                                    
                                    <p>A <code class="code">DeleteStackInstances</code> operation has
                                       failed and left the stack in an unstable state. Stacks in this state are excluded
                                       from further <code class="code">UpdateStackSet</code> operations. You might need to perform a 
                                       <code class="code">DeleteStackInstances</code> operation, with <code class="code">RetainStacks</code> set to
                                       <code class="code">true</code>, to delete the stack instance, and then delete the stack manually.
                                    </p>
                                    
                                 </td>
                                 
                              </tr>
                              
                           </tbody></table>
                        </div>
                     </div>
                     
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be enabled. Please refer to your browser's
                                    Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="what-is-cfnstacksets.html">&#xAB; Previous </a><a class="awstoc" accesskey="n" href="stacksets-prereqs.html">Next &#xBB;</a></div>
                     <div id="copyright-main-footer">&#xA9; 2018, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="Administrator and target accounts"><a class="pagetoc" href="#stacksets-concepts-accts">Administrator and target accounts</a></li>
                        <li class="pagetoc" name="Stack sets"><a class="pagetoc" href="#stacksets-concepts-stackset">Stack sets</a></li>
                        <li class="pagetoc" name="Stack instances"><a class="pagetoc" href="#stacksets-concepts-stackinstances">Stack instances</a></li>
                        <li class="pagetoc" name="Stack set operations"><a class="pagetoc" href="#stacksets-concepts-ops">Stack set operations</a></li>
                        <li class="pagetoc" name="Stack set operation options"><a class="pagetoc" href="#stackset-ops-options">Stack set operation options</a></li>
                        <li class="pagetoc" name="Tags"><a class="pagetoc" href="#stackset-concepts-tags">Tags</a></li>
                        <li class="pagetoc" name="Stack set and stack instance status
                codes"><a class="pagetoc" href="#stackset-status-codes">Stack set and stack instance status
                              codes</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='AWS CloudFormation';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='User Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   
</body></html>