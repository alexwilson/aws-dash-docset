<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>AWS::EC2::SecurityGroupIngress - AWS CloudFormation</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="home" href="#top">
      <link rel="up" href="aws-template-resource-type-ref.html" title="AWS Resource Types Reference">
      <link rel="prev" href="aws-resource-ec2-security-group-egress.html" title="AWS::EC2::SecurityGroupEgress">
      <link rel="next" href="aws-resource-ec2-spotfleet.html" title="AWS::EC2::SpotFleet">
      <meta name="description" content="Adds an ingress rule to an Amazon EC2 or Amazon VPC security group by using the AWS CloudFormation AWS::EC2:SecurityGroupIngress property type.">
      <meta name="keywords" content="CloudFormation,AWSCloudFormation,resource provisioning,resource configuration,infrastructure management,CloudFormer,CloudFormation Designer,CloudFormation stack,CloudFormation stackset,CloudFormation template,change set">
      <meta name="deployment_region" content="IAD">
      <meta name="product" content="AWS CloudFormation">
      <meta name="guide" content="User Guide">
      <meta name="guide-locale" content="en_us">
      <link rel="icon" type="image/ico" href="/images/favicon.ico">
      <link rel="shortcut icon" type="image/ico" href="/images/favicon.ico">
      <link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group-ingress.html">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/font-awesome.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/google-font.css">
      <link id="code-style" rel="stylesheet" type="text/css" href="../../../css/light.css">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.theme.css">
      <link rel="stylesheet" type="text/css" href="../../../css/colorbox.css">
      <link rel="stylesheet" type="text/css" href="../../../css/awsdocs.css"><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="/js/jquery-ui.min.js"></script><script type="text/javascript" src="/js/handlebars.js"></script><script type="text/javascript" src="/js/jquery.colorbox.js"></script><script type="text/javascript" src="/js/awsdocs.min.js?v=20170615"></script></head>
   <body id="top">
      
      <div id="content-container">
         
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tbody><tr>
                           <td>
                              <div class="breadcrumb"><a href="http://aws.amazon.com/documentation">AWS Documentation</a> &#xBB; <a href="http://aws.amazon.com/documentation/cloudformation">AWS CloudFormation</a> &#xBB; <a href="index.html">User Guide</a> &#xBB; <a href="template-reference.html">Template Reference</a> &#xBB; <a href="aws-template-resource-type-ref.html">AWS Resource Types Reference</a> &#xBB; <span class="breadcrumb">AWS::EC2::SecurityGroupIngress</span></div>
                           </td>
                        </tr>
                     </tbody></table>
                     <div></div>
                     <div id="language-filter" class="page-header" style="display:none">
                        <form> Filter View: 
                           <select name="filter-select" id="filter-select">
                              <option selected="1">All</option>
                              <option value="JSON" selected>JSON</option>
                              <option value="YAML" selected>YAML</option></select></form>
                     </div>
                     <h1 class="topictitle" id="aws-properties-ec2-security-group-ingress">AWS::EC2::SecurityGroupIngress</h1>
                     <p>The <code class="code">AWS::EC2::SecurityGroupIngress</code> resource adds an ingress rule to an Amazon EC2
                        or Amazon VPC security group.
                     </p>
                     <div class="aws-note">
                        <p class="aws-note">Important</p>
                        <p>Use <code class="code">AWS::EC2::SecurityGroupIngress</code> and
                           <code class="code">AWS::EC2::SecurityGroupEgress</code> only when necessary, typically to allow
                           security groups to reference each other in ingress and egress rules. Otherwise, use
                           the
                           embedded ingress and egress rules of <a href="aws-properties-ec2-security-group.html">AWS::EC2::SecurityGroup</a>. For more information, see <a href="./AWSEC2/latest/UserGuide/using-network-security.html" target="_blank">Amazon EC2 Security
                              Groups</a>.
                        </p>
                     </div>
                     <div class="highlights" id="inline-topiclist">
                        <p><strong>Topics</strong></p>
                        <ul>
                           <li><a href="#aws-resource-ec2-securitygroupingress-syntax">Syntax</a></li>
                           <li><a href="#w2ab2c21c10d466c11">Properties</a></li>
                           <li><a href="#aws-properties-ec2-security-group-ingress-examples">Examples</a></li>
                        </ul>
                     </div>
                     <h2 id="aws-resource-ec2-securitygroupingress-syntax">Syntax</h2>
                     
                     
                     <p>To declare this entity in your AWS CloudFormation template, use the following syntax:</p>
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h3 id="aws-resource-ec2-securitygroupingress-syntax.json">JSON</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">{
  &quot;Type&quot; : &quot;AWS::EC2::SecurityGroupIngress&quot;,
  &quot;Properties&quot; : {
    &quot;<a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-cidrip"><code class="literal">CidrIp</code></a>&quot; : <em class="replaceable"><code>String</code></em>,
    &quot;<a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-cidripv6"><code class="code">CidrIpv6</code></a>&quot; : <em class="replaceable"><code>String</code></em>,
    &quot;<a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-description"><code class="literal">Description</code></a>&quot; : <em class="replaceable"><code>String</code></em>,
    &quot;<a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-fromport"><code class="literal">FromPort</code></a>&quot; : <em class="replaceable"><code>Integer</code></em>,
    &quot;<a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-groupid"><code class="literal">GroupId</code></a>&quot; : <em class="replaceable"><code>String</code></em>,
    &quot;<a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-groupname"><code class="literal">GroupName</code></a>&quot; : <em class="replaceable"><code>String</code></em>,
    &quot;<a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-ipprotocol"><code class="literal">IpProtocol</code></a>&quot; : <em class="replaceable"><code>String</code></em>,
    &quot;<a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-sourcesecuritygroupname"><code class="literal">SourceSecurityGroupName</code></a>&quot; : <em class="replaceable"><code>String</code></em>,
    &quot;<a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-sourcesecuritygroupid"><code class="literal">SourceSecurityGroupId</code></a>&quot; : <em class="replaceable"><code>String</code></em>,
    &quot;<a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-sourcesecuritygroupownerid"><code class="literal">SourceSecurityGroupOwnerId</code></a>&quot; : <em class="replaceable"><code>String</code></em>,
    &quot;<a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-toport"><code class="literal">ToPort</code></a>&quot; : <em class="replaceable"><code>Integer</code></em>
  }
}</code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h3 id="aws-resource-ec2-securitygroupingress-syntax.yaml">YAML</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">
Type: &quot;AWS::EC2::SecurityGroupIngress&quot;
Properties: 
  <a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-cidrip"><code class="literal">CidrIp</code></a>: <em class="replaceable"><code>String</code></em>
  <a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-cidripv6"><code class="code">CidrIpv6</code></a>: <em class="replaceable"><code>String</code></em>
  <a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-description"><code class="literal">Description</code></a>: <em class="replaceable"><code>String</code></em>
  <a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-fromport"><code class="literal">FromPort</code></a>: <em class="replaceable"><code>Integer</code></em>
  <a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-groupid"><code class="literal">GroupId</code></a>: <em class="replaceable"><code>String</code></em>
  <a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-groupname"><code class="literal">GroupName</code></a>: <em class="replaceable"><code>String</code></em>
  <a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-ipprotocol"><code class="literal">IpProtocol</code></a>: <em class="replaceable"><code>String</code></em>
  <a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-sourcesecuritygroupname"><code class="literal">SourceSecurityGroupName</code></a>: <em class="replaceable"><code>String</code></em>
  <a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-sourcesecuritygroupid"><code class="literal">SourceSecurityGroupId</code></a>: <em class="replaceable"><code>String</code></em>
  <a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-sourcesecuritygroupownerid"><code class="literal">SourceSecurityGroupOwnerId</code></a>: <em class="replaceable"><code>String</code></em>
  <a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-toport"><code class="literal">ToPort</code></a>: <em class="replaceable"><code>Integer</code></em>
</code></pre>
                        </div>
                     
                     <h2 id="w2ab2c21c10d466c11">Properties</h2>
                     
                     
                     <p>For more information about adding ingress rules to Amazon EC2 or VPC security groups,
                        see
                        <a href="./AWSEC2/latest/APIReference/ApiReference-query-AuthorizeSecurityGroupIngress.html" target="_blank">AuthorizeSecurityGroupIngress</a> in the <em>Amazon EC2 API Reference</em>.
                     </p>
                     <div class="aws-note">
                        <p class="aws-note">Note</p>
                        <p>If you change this resource&apos;s logical ID, you must also update a property value in
                           order to trigger an update for this resource.
                        </p>
                     </div>
                     
                     <div class="variablelist">
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <dl>
                           
                           <dt><a id="cfn-ec2-security-group-ingress-cidrip"></a><span class="term"><code class="literal">CidrIp</code></span></dt>
                           
                           <dd>
                              
                              <p>An IPv4 CIDR range.</p>
                              
                              <p>For an overview of CIDR ranges, go to the <a href="http://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing" target="_blank">Wikipedia
                                    Tutorial</a>.
                              </p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Required</em>: Conditional. You must specify a source security group
                                 (<code class="code">SourceSecurityGroupName</code> or <code class="code">SourceSecurityGroupId</code>) or a CIDR
                                 range (<code class="code">CidrIp</code> or <code class="code">CidrIpv6</code>).
                              </p>
                              
                              <p><em>Update requires</em>: <a href="using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-security-group-ingress-cidripv6"></a><span class="term"><code class="code">CidrIpv6</code></span></dt>
                           
                           <dd>
                              
                              <p>An IPv6 CIDR range.</p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Required</em>: Conditional. You must specify a source security group
                                 (<code class="code">SourceSecurityGroupName</code> or <code class="code">SourceSecurityGroupId</code>) or a CIDR
                                 range (<code class="code">CidrIp</code> or <code class="code">CidrIpv6</code>).
                              </p>
                              
                              <p><em>Update requires</em>: <a href="using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-security-group-ingress-description"></a><span class="term"><code class="literal">Description</code></span></dt>
                           
                           <dd>
                              
                              <p>Description of the ingress rule.</p>
                              
                              <p><em>Required</em>: No
                              </p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Update requires</em>: 
                                 <a href="using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-security-group-ingress-fromport"></a><span class="term"><code class="literal">FromPort</code></span></dt>
                           
                           <dd>
                              
                              <p>Start of port range for the TCP and UDP protocols, or an ICMP type number.
                                 If you specify <code class="code">icmp</code> for the <code class="code">IpProtocol</code> property, you can
                                 specify -1 as a wildcard (i.e., any ICMP type number).
                              </p>
                              
                              <p><em>Type</em>: Integer
                              </p>
                              
                              <p><em>Required</em>: Yes, for ICMP and any protocol that uses ports.
                              </p>
                              
                              <p><em>Update requires</em>: <a href="using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-security-group-ingress-groupid"></a><span class="term"><code class="literal">GroupId</code></span></dt>
                           
                           <dd>
                              
                              <p>ID of the Amazon EC2 or VPC security group to modify. The group must belong to your
                                 account.
                              </p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Required</em>: Conditional. You must specify the <code class="code">GroupName</code>
                                 property or the <code class="code">GroupId</code> property. For security groups that
                                 are in a VPC, you must use the <code class="code">GroupId</code> property. For example,
                                 <a href="./AWSEC2/latest/UserGuide/ec2-supported-platforms.html" target="_blank">EC2-VPC</a>
                                 accounts must use the <code class="code">GroupId</code> property.
                              </p>
                              
                              <p><em>Update requires</em>: <a href="using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-security-group-ingress-groupname"></a><span class="term"><code class="literal">GroupName</code></span></dt>
                           
                           <dd>
                              
                              <p>Name of the Amazon EC2 security group (non-VPC security group) to modify. This value
                                 can be a reference to an <a href="aws-properties-ec2-security-group.html">AWS::EC2::SecurityGroup</a> resource or the name of an existing Amazon EC2
                                 security group.
                              </p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Required</em>: Conditional. You must specify the <code class="code">GroupName</code>
                                 property or the <code class="code">GroupId</code> property. For security groups that
                                 are in a VPC, you must use the <code class="code">GroupId</code> property. For example,
                                 <a href="./AWSEC2/latest/UserGuide/ec2-supported-platforms.html" target="_blank">EC2-VPC</a>
                                 accounts must use the <code class="code">GroupId</code> property.
                              </p>
                              
                              <p><em>Update requires</em>: <a href="using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-security-group-ingress-ipprotocol"></a><span class="term"><code class="literal">IpProtocol</code></span></dt>
                           
                           <dd>
                              
                              <p>IP protocol name or number. For valid values, see the IpProtocol parameter
                                 in <a href="./AWSEC2/latest/APIReference/ApiReference-query-AuthorizeSecurityGroupIngress.html" target="_blank">AuthorizeSecurityGroupIngress</a></p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Required</em>: Yes
                              </p>
                              
                              <p><em>Update requires</em>: <a href="using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-security-group-ingress-sourcesecuritygroupid"></a><span class="term"><code class="literal">SourceSecurityGroupId</code></span></dt>
                           
                           <dd>
                              
                              <p>Specifies the ID of the source security group or uses the <code class="code">Ref</code>
                                 intrinsic function to refer to the logical ID of a security group defined in the
                                 same template.
                              </p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Required</em>: Conditional. You must specify a source security group
                                 (<code class="code">SourceSecurityGroupName</code> or <code class="code">SourceSecurityGroupId</code>) or a CIDR
                                 range (<code class="code">CidrIp</code> or <code class="code">CidrIpv6</code>).
                              </p>
                              
                              <p><em>Update requires</em>: <a href="using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-security-group-ingress-sourcesecuritygroupname"></a><span class="term"><code class="literal">SourceSecurityGroupName</code></span></dt>
                           
                           <dd>
                              
                              <p>Specifies the name of the Amazon EC2 security group (non-VPC security group) to
                                 allow access or use the <code class="code">Ref</code> intrinsic function to refer to the logical ID
                                 of a security group defined in the same template. For instances in a VPC, specify
                                 the
                                 <code class="code">SourceSecurityGroupId</code> property.
                              </p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Required</em>: Conditional. You must specify a source security group
                                 (<code class="code">SourceSecurityGroupName</code> or <code class="code">SourceSecurityGroupId</code>) or a CIDR
                                 range (<code class="code">CidrIp</code> or <code class="code">CidrIpv6</code>).
                              </p>
                              
                              <p><em>Update requires</em>: <a href="using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-security-group-ingress-sourcesecuritygroupownerid"></a><span class="term"><code class="literal">SourceSecurityGroupOwnerId</code></span></dt>
                           
                           <dd>
                              
                              <p>Specifies the AWS Account ID of the owner of the Amazon EC2 security group
                                 specified in the <code class="code">SourceSecurityGroupName</code> property.
                              </p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Required</em>: Conditional. If you specify
                                 <code class="code">SourceSecurityGroupName</code> and that security group is owned
                                 by a different account than the account creating the stack, you must specify the
                                 <code class="code">SourceSecurityGroupOwnerId</code>; otherwise, this property is
                                 optional.
                              </p>
                              
                              <p><em>Update requires</em>: <a href="using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-security-group-ingress-toport"></a><span class="term"><code class="literal">ToPort</code></span></dt>
                           
                           <dd>
                              
                              <p>End of port range for the TCP and UDP protocols, or an ICMP code. If you
                                 specify <code class="code">icmp</code> for the <code class="code">IpProtocol</code> property, you can
                                 specify -1 as a wildcard (i.e., any ICMP code).
                              </p>
                              
                              <p><em>Type</em>: Integer
                              </p>
                              
                              <p><em>Required</em>: Yes, for ICMP and any protocol that uses ports.
                              </p>
                              
                              <p><em>Update requires</em>: <a href="using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                              
                           </dd>
                           
                        </dl>
                     </div>
                     
                     <h2 id="aws-properties-ec2-security-group-ingress-examples">Examples</h2>
                     
                     
                     <h3 id="w2ab2c21c10d466c13b2">EC2 Security Group and Ingress Rule</h3>
                     
                     
                     <p>To create an Amazon EC2 (non-VPC) security group and an ingress rule, use the <code class="code">SourceSecurityGroupName</code> property in the ingress rule.
                     </p>
                     
                     <p>The following template snippet creates an EC2 security group with an ingress rule
                        that allows incoming traffic on port 80 from any other host in the security group.
                        The snippet uses the intrinsic function <a href="intrinsic-function-reference-ref.html"><code class="code">Ref</code></a> to specify the value for SourceSecurityGroupName.
                     </p>
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h4 id="aws-resource-ec2-securitygroupingress-example-1.json">JSON</h4>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">{
    &quot;AWSTemplateFormatVersion&quot;: &quot;2010-09-09&quot;,
    &quot;Resources&quot;: {
        &quot;SGBase&quot;: {
            &quot;Type&quot;: &quot;AWS::EC2::SecurityGroup&quot;,
            &quot;Properties&quot;: {
                &quot;GroupDescription&quot;: &quot;Base Security Group&quot;,
                &quot;SecurityGroupIngress&quot;: [
                    {
                        &quot;IpProtocol&quot;: &quot;tcp&quot;,
                        &quot;CidrIp&quot;: &quot;0.0.0.0/0&quot;,
                        &quot;FromPort&quot;: &quot;22&quot;,
                        &quot;ToPort&quot;: &quot;22&quot;
                    }
                ]
            }
        },
        &quot;SGBaseIngress&quot;: {
            &quot;Type&quot;: &quot;AWS::EC2::SecurityGroupIngress&quot;,
            &quot;Properties&quot;: {
                &quot;GroupName&quot;: {
                    &quot;Ref&quot;: &quot;SGBase&quot;
                },
                &quot;IpProtocol&quot;: &quot;tcp&quot;,
                &quot;FromPort&quot;: &quot;80&quot;,
                &quot;ToPort&quot;: &quot;80&quot;,
                &quot;SourceSecurityGroupName&quot;: {
                    &quot;Ref&quot;: &quot;SGBase&quot;
                }
            }
        }
    }
}</code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h4 id="aws-resource-ec2-securitygroupingress-example-1.yaml">YAML</h4>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">AWSTemplateFormatVersion: 2010-09-09
Resources:
  SGBase:
    Type: &apos;AWS::EC2::SecurityGroup&apos;
    Properties:
      GroupDescription: Base Security Group
      SecurityGroupIngress:
        - IpProtocol: tcp
          CidrIp: 0.0.0.0/0
          FromPort: &apos;22&apos;
          ToPort: &apos;22&apos;
  SGBaseIngress:
    Type: &apos;AWS::EC2::SecurityGroupIngress&apos;
    Properties:
      GroupName: !Ref SGBase
      IpProtocol: tcp
      FromPort: &apos;80&apos;
      ToPort: &apos;80&apos;
      SourceSecurityGroupName: !Ref SGBase</code></pre>
                        </div>
                     
                     
                     <h3 id="w2ab2c21c10d466c13b4">VPC Security Groups with Egress and Ingress Rules</h3>
                     
                     
                     <p>In some cases, you might have an originating (source) security group to which you
                        want to add an outbound rule that allows traffic to a destination (target) security
                        group. The target security group also needs an inbound rule that allows traffic from
                        the source security group. Note that you cannot use the <code class="code">Ref</code> function to specify the outbound and inbound rules for each security group. Doing
                        so creates a circular dependency; you cannot have two resources that depend on
                        each other. Instead, use the egress and ingress resources to declare these outbound
                        and inbound rules, as shown in the following template snippet.
                     </p>
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h4 id="aws-resource-ec2-securitygroupingress-example-2.json">JSON</h4>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">{
  &quot;AWSTemplateFormatVersion&quot;: &quot;2010-09-09&quot;,
  &quot;Resources&quot;: {
    &quot;SourceSG&quot;: {
      &quot;Type&quot;: &quot;AWS::EC2::SecurityGroup&quot;,
      &quot;Properties&quot;: {
        &quot;VpcId&quot; : &quot;vpc-e063f789&quot;,
        &quot;GroupDescription&quot;: &quot;Sample source security group&quot;
      }
    },
    &quot;TargetSG&quot;: {
      &quot;Type&quot;: &quot;AWS::EC2::SecurityGroup&quot;,
      &quot;Properties&quot;: {
        &quot;VpcId&quot; : &quot;vpc-e063f789&quot;,
        &quot;GroupDescription&quot;: &quot;Sample target security group&quot;
      }
    },
    &quot;OutboundRule&quot;: {
      &quot;Type&quot;: &quot;AWS::EC2::SecurityGroupEgress&quot;,
      &quot;Properties&quot;:{
        &quot;IpProtocol&quot;: &quot;tcp&quot;,
        &quot;FromPort&quot;: &quot;0&quot;,
        &quot;ToPort&quot;: &quot;65535&quot;,
        &quot;DestinationSecurityGroupId&quot;: {
          &quot;Fn::GetAtt&quot;: [
            &quot;TargetSG&quot;,
            &quot;GroupId&quot;
          ]
        },
        &quot;GroupId&quot;: {
          &quot;Fn::GetAtt&quot;: [
            &quot;SourceSG&quot;,
            &quot;GroupId&quot;
          ]
        }
      }
    },
    &quot;InboundRule&quot;: {
      &quot;Type&quot;: &quot;AWS::EC2::SecurityGroupIngress&quot;,
      &quot;Properties&quot;:{
        &quot;IpProtocol&quot;: &quot;tcp&quot;,
        &quot;FromPort&quot;: &quot;0&quot;,
        &quot;ToPort&quot;: &quot;65535&quot;,
        &quot;SourceSecurityGroupId&quot;: {
          &quot;Fn::GetAtt&quot;: [
            &quot;SourceSG&quot;,
            &quot;GroupId&quot;
          ]
        },
        &quot;GroupId&quot;: {
          &quot;Fn::GetAtt&quot;: [
            &quot;TargetSG&quot;,
            &quot;GroupId&quot;
          ]
        }
      }
    }
  }
}</code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h4 id="aws-resource-ec2-securitygroupingress-example-2.yaml">YAML</h4>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">AWSTemplateFormatVersion: &apos;2010-09-09&apos;
Resources:
  SourceSG:
    Type: AWS::EC2::SecurityGroup
    Properties:
      VpcId: vpc-e063f789
      GroupDescription: Sample source security group
  TargetSG:
    Type: AWS::EC2::SecurityGroup
    Properties:
      VpcId: vpc-e063f789
      GroupDescription: Sample target security group
  OutboundRule:
    Type: AWS::EC2::SecurityGroupEgress
    Properties:
      IpProtocol: tcp
      FromPort: &apos;0&apos;
      ToPort: &apos;65535&apos;
      DestinationSecurityGroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
  InboundRule:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      IpProtocol: tcp
      FromPort: &apos;0&apos;
      ToPort: &apos;65535&apos;
      SourceSecurityGroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId</code></pre>
                        </div>
                     
                     
                     <h3 id="w2ab2c21c10d466c13b6">Allow Ping Requests</h3>
                     
                     
                     <p>To allow ping requests, add the ICMP protocol type and specify <code class="code">8</code> (echo request) for the ICMP type and either <code class="code">0</code> or <code class="code">-1</code> (all) for the ICMP code.
                     </p>
                     
                     <div id="JSON" name="JSON" class="section langfilter">
                        <h4 id="aws-resource-ec2-securitygroupingress-example-3.json">JSON</h4>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">&quot;SGPing&quot; : {
  &quot;Type&quot; : &quot;AWS::EC2::SecurityGroup&quot;,
  &quot;DependsOn&quot;: &quot;VPC&quot;,
  &quot;Properties&quot; : {
    &quot;GroupDescription&quot; : &quot;SG to test ping&quot;,
    &quot;VpcId&quot; : {&quot;Ref&quot; : &quot;VPC&quot;},
    &quot;SecurityGroupIngress&quot; : [ 
      { &quot;IpProtocol&quot; : &quot;tcp&quot;, &quot;FromPort&quot; : &quot;22&quot;, &quot;ToPort&quot; : &quot;22&quot;, &quot;CidrIp&quot; : &quot;10.0.0.0/24&quot; },
      { &quot;IpProtocol&quot; : &quot;icmp&quot;, &quot;FromPort&quot; : &quot;8&quot;, &quot;ToPort&quot; : &quot;-1&quot;, &quot;CidrIp&quot; : &quot;10.0.0.0/24&quot; }
    ]
  }
}</code></pre>
                        </div>
                     
                     <div id="YAML" name="YAML" class="section langfilter">
                        <h4 id="aws-resource-ec2-securitygroupingress-example-3.yaml">YAML</h4>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">SGPing:
  Type: AWS::EC2::SecurityGroup
  DependsOn: VPC
  Properties:
    GroupDescription: SG to test ping
    VpcId:
      Ref: VPC
    SecurityGroupIngress:
    - IpProtocol: tcp
      FromPort: &apos;22&apos;
      ToPort: &apos;22&apos;
      CidrIp: 10.0.0.0/24
    - IpProtocol: icmp
      FromPort: &apos;8&apos;
      ToPort: &quot;-1&quot;
      CidrIp: 10.0.0.0/24</code></pre>
                        </div>
                     
                     
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be enabled. Please refer to your browser's
                                    Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="aws-resource-ec2-security-group-egress.html">&#xAB; Previous </a><a class="awstoc" accesskey="n" href="aws-resource-ec2-spotfleet.html">Next &#xBB;</a></div>
                     <div id="copyright-main-footer">&#xA9; 2018, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="Syntax"><a class="pagetoc" href="#aws-resource-ec2-securitygroupingress-syntax">Syntax</a></li>
                        <li class="pagetoc" name="Properties"><a class="pagetoc" href="#w2ab2c21c10d466c11">Properties</a></li>
                        <li class="pagetoc" name="Examples"><a class="pagetoc" href="#aws-properties-ec2-security-group-ingress-examples">Examples</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='AWS CloudFormation';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='User Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   
</body></html>