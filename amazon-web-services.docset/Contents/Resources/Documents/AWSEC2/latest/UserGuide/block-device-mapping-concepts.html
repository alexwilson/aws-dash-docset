<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Block Device Mapping - Amazon Elastic Compute Cloud</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="home" href="#top">
      <link rel="up" href="Storage.html" title="Storage">
      <link rel="prev" href="device_naming.html" title="Device Naming on Linux Instances">
      <link rel="next" href="using-public-data-sets.html" title="Using Public Data Sets">
      <meta name="description" content="Use a block device mapping to specify additional EBS volumes or instance store volumes for your instance when it&apos;s launched.">
      <meta name="keywords" content="EC2,Amazon EC2,EC2 instance,instance,VM,virtual machine">
      <meta name="deployment_region" content="IAD">
      <meta name="product" content="Amazon Elastic Compute Cloud">
      <meta name="guide" content="User Guide for Linux Instances">
      <meta name="guide-locale" content="en_us">
      <link rel="icon" type="image/ico" href="/images/favicon.ico">
      <link rel="shortcut icon" type="image/ico" href="/images/favicon.ico">
      <link rel="canonical" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/block-device-mapping-concepts.html">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/font-awesome.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/google-font.css">
      <link id="code-style" rel="stylesheet" type="text/css" href="../../../css/light.css">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.theme.css">
      <link rel="stylesheet" type="text/css" href="../../../css/colorbox.css">
      <link rel="stylesheet" type="text/css" href="../../../css/awsdocs.css"><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="/js/jquery-ui.min.js"></script><script type="text/javascript" src="/js/handlebars.js"></script><script type="text/javascript" src="/js/jquery.colorbox.js"></script><script type="text/javascript" src="/js/awsdocs.min.js?v=20170615"></script></head>
   <body id="top">
      
      <div id="content-container">
         
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tbody><tr>
                           <td>
                              <div class="breadcrumb"><a href="http://aws.amazon.com/documentation">AWS Documentation</a> &#xBB; <a href="http://aws.amazon.com/documentation/ec2">Amazon EC2</a> &#xBB; <a href="index.html">User Guide for Linux Instances</a> &#xBB; <a href="Storage.html">Storage</a> &#xBB; <span class="breadcrumb">Block Device Mapping</span></div>
                           </td>
                        </tr>
                     </tbody></table>
                     <div></div>
                     <h1 class="topictitle" id="block-device-mapping-concepts">Block Device Mapping</h1>
                     <p>Each instance that you launch has an associated root device volume, either an Amazon
                        EBS volume
                        or an instance store volume. You can use block device mapping to specify additional
                        EBS volumes
                        or instance store volumes to attach to an instance when it&apos;s launched. You can also
                        attach
                        additional EBS volumes to a running instance; see <a href="ebs-attaching-volume.html">Attaching an Amazon EBS Volume to an Instance</a>. However, the only way to attach instance store volumes
                        to an instance is to use block device mapping to attach them as the instance is launched.
                     </p>
                     <p>For more information about root device volumes, see <a href="RootDeviceStorage.html#Using_RootDeviceStorage">Changing the Root Device Volume to Persist</a>.
                     </p>
                     <div class="highlights" id="inline-topiclist">
                        <p><strong>Contents</strong></p>
                        <ul>
                           <li><a href="#block-device-mapping-def">Block Device Mapping Concepts</a></li>
                           <li><a href="#ami-block-device-mapping">AMI Block Device Mapping</a></li>
                           <li><a href="#instance-block-device-mapping">Instance Block Device Mapping</a></li>
                        </ul>
                     </div>
                     
                     <h2 id="block-device-mapping-def">Block Device Mapping Concepts</h2>
                     
                     
                     <p>A <em>block device</em> is a storage device that moves data in sequences of
                        bytes or bits (blocks). These devices support random access and generally use buffered
                        I/O.
                        Examples include hard disks, CD-ROM drives, and flash drives. A block device can be
                        physically
                        attached to a computer or accessed remotely as if it were physically attached to the
                        computer.
                        Amazon EC2 supports two types of block devices: 
                     </p>
                     
                     
                     <div class="itemizedlist">
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p>Instance store volumes (virtual devices whose underlying hardware is physically
                                 attached to the host computer for the instance)
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>EBS volumes (remote storage devices)</p>
                              
                           </li>
                        </ul>
                     </div>
                     
                     
                     <p>A <em>block device mapping</em> defines the block devices (instance store
                        volumes and EBS volumes) to attach to an instance. You can specify a block device
                        mapping as
                        part of creating an AMI so that the mapping is used by all instances launched from
                        the AMI.
                        Alternatively, you can specify a block device mapping when you launch an instance,
                        so this
                        mapping overrides the one specified in the AMI from which you launched the instance.
                        Note that
                        all of the NVMe instance store volumes supported by an instance type are automatically
                        added
                        on instance launch; you do not need to add them to the block device mapping for the
                        AMI or the
                        instance.
                     </p>
                     
                     
                     <div class="highlights" id="inline-topiclist">
                        <p><strong>Contents</strong></p>
                        <ul>
                           <li><a href="#parts-of-a-block-device-mapping">Block Device Mapping Entries</a></li>
                           <li><a href="#instance_store_caveats">Block Device Mapping Instance Store Caveats</a></li>
                           <li><a href="#block-device-mapping-ex">Example Block Device Mapping</a></li>
                           <li><a href="#bdm-to-os">How Devices Are Made Available in the Operating System</a></li>
                        </ul>
                     </div>
                     
                     
                     
                     <h3 id="parts-of-a-block-device-mapping">Block Device Mapping Entries</h3>
                     
                     
                     <p>When you create a block device mapping, you specify the following information for
                        each
                        block device that you need to attach to the instance:
                     </p>
                     
                     
                     <div class="itemizedlist">
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p>The device name used within Amazon EC2. The block device driver for the instance assigns
                                 the actual volume name when mounting the volume, and the name assigned can be different
                                 from the name that Amazon EC2 recommends. For more information, see <a href="device_naming.html">Device Naming on <span>Linux</span> Instances</a>.
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>[Instance store volumes] The virtual device: <code>ephemeral[0-23]</code>.
                                 Note that the number and size of available instance store volumes for your instance
                                 varies by instance type.
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>[NVMe instance store volumes] These volumes are mapped automatically; you do not
                                 need to specify the NVMe instance type volumes supported by an instance type in a
                                 block
                                 device mapping.
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>[EBS volumes] The ID of the snapshot to use to create the block device
                                 (snap-<em>xxxxxxxx</em>). This value is optional as long as you specify a
                                 volume size.
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>[EBS volumes] The size of the volume, in GiB. The specified size must be greater
                                 than or equal to the size of the specified snapshot.
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>[EBS volumes] Whether to delete the volume on instance termination
                                 (<code class="code">true</code> or <code class="code">false</code>). The default value is <code class="code">true</code> for
                                 the root device volume and <code class="code">false</code> for attached volumes. When you create an
                                 AMI, its block device mapping inherits this setting from the instance. When you launch
                                 an instance, it inherits this setting from the AMI.
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>[EBS volumes] The volume type, which can be <code class="code">gp2</code> for General Purpose SSD, <code class="code">io1</code> for Provisioned IOPS SSD,
                                 <code class="code">st1</code> for Throughput Optimized HDD, <code class="code">sc1</code> for Cold HDD, or <code class="code">standard</code> for Magnetic. The default
                                 value is <code class="code">gp2</code> in the Amazon EC2 console, and <code class="code">standard</code> in the AWS SDKs and the
                                 AWS CLI.
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>[EBS volumes] The number of input/output operations per second (IOPS) that the
                                 volume supports. (Not used with <code class="code">gp2</code>, <code class="code">st1</code>, <code class="code">sc1</code>, or <code class="code">standard</code> volumes.)
                              </p>
                              
                           </li>
                        </ul>
                     </div>
                     
                     
                     
                     
                     
                     <h3 id="instance_store_caveats">Block Device Mapping Instance Store Caveats</h3>
                     
                     
                     <p>There are several caveats to consider when launching instances with AMIs that have
                        instance store volumes in their block device mappings.
                     </p>
                     
                     <div class="itemizedlist">
                        
                        
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p>Some instance types include more instance store volumes than others, and some
                                 instance types contain no instance store volumes at all. If your instance type
                                 supports one instance store volume, and your AMI has mappings for two instance store
                                 volumes, then the instance launches with one instance store volume.
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>Instance store volumes can only be mapped at launch time. You cannot stop an
                                 instance without instance store volumes (such as the <code class="code">t2.micro</code>), change
                                 the instance to a type that supports instance store volumes, and then restart the
                                 instance with instance store volumes. However, you can create an AMI from the
                                 instance and launch it on an instance type that supports instance store volumes, and
                                 map those instance store volumes to the instance.
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>If you launch an instance with instance store volumes mapped, and then stop the
                                 instance and change it to an instance type with fewer instance store volumes and
                                 restart it, the instance store volume mappings from the initial launch still show
                                 up
                                 in the instance metadata. However, only the maximum number of supported instance store
                                 volumes for that instance type are available to the instance.
                              </p>
                              
                              <div class="aws-note">
                                 <p class="aws-note">Note</p>
                                 <p>When an instance is stopped, all data on the instance store volumes is
                                    lost.
                                 </p>
                              </div>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>Depending on instance store capacity at launch time, M3 instances may ignore AMI
                                 instance store block device mappings at launch unless they are specified at launch.
                                 You should specify instance store block device mappings at launch time, even if the
                                 AMI you are launching has the instance store volumes mapped in the AMI, to ensure
                                 that the instance store volumes are available when the instance launches. 
                              </p>
                              
                           </li>
                        </ul>
                     </div>
                     
                     
                     
                     
                     <h3 id="block-device-mapping-ex">Example Block Device Mapping</h3>
                     
                     
                     <p>This figure shows an example block device mapping for an EBS-backed instance. It maps
                        <code>/dev/sdb</code> to <code>ephemeral0</code> and maps two EBS volumes,
                        one to <code>/dev/sdh</code> and the other to <code>/dev/sdj</code>. It also
                        shows the EBS volume that is the root device volume, <code>/dev/sda1</code>.
                     </p>
                     
                     
                     <div class="mediaobject">
                        
                        <img src="../../..//img/block_device_mapping_figure.png" alt="
          Relationship between instance, instance store volumes, and EBS volumes.
        ">
                        
                        
                        
                     </div>
                     
                     
                     
                     <p>Note that this example block device mapping is used in the example commands and APIs
                        in
                        this topic. You can find example commands and APIs that create block device mappings
                        in
                        <a href="block-device-mapping-concepts.html#create-ami-bdm">Specifying a Block Device Mapping for an AMI</a> and <a href="block-device-mapping-concepts.html#Using_OverridingAMIBDM">Updating the Block Device Mapping when Launching an Instance</a>.
                     </p>
                     
                     
                     
                     
                     
                     <h3 id="bdm-to-os">How Devices Are Made Available in the Operating System</h3>
                     
                     
                     <p>Device names like <code>/dev/sdh</code> and <code>xvdh</code> are used
                        by Amazon EC2 to describe block devices. The block device mapping is used by Amazon
                        EC2 to specify the
                        block devices to attach to an EC2 instance. After a block device is attached to an
                        instance,
                        it must be mounted by the operating system before you can access the storage device.
                        When a
                        block device is detached from an instance, it is unmounted by the operating system
                        and you
                        can no longer access the storage device.
                     </p>
                     
                     <p>With a Linux instance, the device names specified in the block device mapping
                        are mapped to their corresponding block devices when the instance first boots. The
                        instance
                        type determines which instance store volumes are formatted and mounted by default.
                        You can
                        mount additional instance store volumes at launch, as long as you don&apos;t exceed the
                        number of
                        instance store volumes available for your instance type. For more information, see
                        
                        <a href="InstanceStorage.html">Amazon EC2 Instance Store</a>. The block device driver for
                        the instance determines which devices are used when the volumes are formatted and
                        mounted.
                        For more information, see <a href="ebs-attaching-volume.html">Attaching an Amazon EBS Volume to an Instance</a>.
                     </p>
                     
                     
                     
                     
                     
                     
                     
                     <h2 id="ami-block-device-mapping">AMI Block Device Mapping</h2>
                     
                     
                     <p>Each AMI has a block device mapping that specifies the block devices to attach to
                        an
                        instance when it is launched from the AMI. An AMI that Amazon provides includes a
                        root device
                        only. To add more block devices to an AMI, you must create your own AMI.
                     </p>
                     
                     
                     <div class="highlights" id="inline-topiclist">
                        <p><strong>Contents</strong></p>
                        <ul>
                           <li><a href="#create-ami-bdm">Specifying a Block Device Mapping for an AMI</a></li>
                           <li><a href="#view-ami-bdm">Viewing the EBS Volumes in an AMI Block Device Mapping</a></li>
                        </ul>
                     </div>
                     
                     
                     
                     <h3 id="create-ami-bdm">Specifying a Block Device Mapping for an AMI</h3>
                     
                     
                     <p>There are two ways to specify volumes in addition to the root volume when you create
                        an
                        AMI. If you&apos;ve already attached volumes to a running instance before you create an
                        AMI from
                        the instance, the block device mapping for the AMI includes those same volumes. For
                        EBS
                        volumes, the existing data is saved to a new snapshot, and it&apos;s this new snapshot
                        that&apos;s
                        specified in the block device mapping. For instance store volumes, the data is not
                        preserved.
                     </p>
                     
                     
                     <p>For an EBS-backed AMI, you can add EBS volumes and instance store volumes using a
                        block
                        device mapping. For an instance store-backed AMI, you can add instance store volumes
                        only by
                        modifying the block device mapping entries in the image manifest file when registering
                        the
                        image.
                     </p>
                     
                     <div class="aws-note">
                        <p class="aws-note">Note</p>
                        <p>For M3 instances, you must specify instance store volumes in the block device mapping
                           for the instance when you launch it. When you launch an M3 instance, instance store
                           volumes specified in the block device mapping for the AMI may be ignored if they are
                           not
                           specified as part of the instance block device mapping.
                        </p>
                     </div>
                     
                     
                     <p class="title"><b>To add volumes to an AMI using the console</b></p>
                     <ol>
                        <li>
                           
                           <p>Open the Amazon EC2 console.</p>
                           
                        </li>
                        <li>
                           
                           <p>In the navigation pane, choose <b>Instances</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Select an instance and choose <b>Actions</b>,
                              <b>Image</b>, <b>Create Image</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>In the <b>Create Image</b> dialog box, choose <b>Add New
                                 Volume</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Select a volume type from the <b>Type</b> list and a device name from
                              the <b>Device</b> list. For an EBS volume, you can optionally specify a
                              snapshot, volume size, and volume type.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Choose <b>Create Image</b>.
                           </p>
                           
                        </li>
                     </ol>
                     
                     
                     <p><b>To add volumes to an AMI using the command line</b></p>
                     
                     
                     <p>Use the <a href="./cli/latest/reference/ec2/create-image.html" target="_blank">create-image</a> AWS CLI
                        command to specify a block device mapping for an EBS-backed AMI. Use the <a href="./cli/latest/reference/ec2/register-image.html" target="_blank">register-image</a> AWS CLI command to specify
                        a block device mapping for an instance store-backed AMI.
                     </p>
                     
                     
                     <p>Specify the block device mapping using the following parameter:</p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight"><b>--block-device-mappings</b> [<em class="replaceable"><code>mapping</code></em>, ...]</code></pre>
                     
                     <p>To add an instance store volume, use the following mapping:</p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="json ">{
    &quot;DeviceName&quot;: &quot;<span>/dev/sdf</span>&quot;,
    &quot;VirtualName&quot;: &quot;ephemeral0&quot;
}</code></pre>
                     
                     <p>To add an empty 100 GiB Magnetic volume, use the following mapping:</p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="json ">{
    &quot;DeviceName&quot;: &quot;<span>/dev/sdg</span>&quot;,
    &quot;Ebs&quot;: {
      &quot;VolumeSize&quot;: 100
    }
}</code></pre>
                     
                     <p>To add an EBS volume based on a snapshot, use the following mapping:</p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="json ">{
    &quot;DeviceName&quot;: &quot;<span>/dev/sdh</span>&quot;,
    &quot;Ebs&quot;: {
      &quot;SnapshotId&quot;: &quot;snap-<em>xxxxxxxx</em>&quot;
    }
}</code></pre>
                     
                     <p>To omit a mapping for a device, use the following mapping:</p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="json ">{
    &quot;DeviceName&quot;: &quot;<span>/dev/sdj</span>&quot;,
    &quot;NoDevice&quot;: &quot;&quot;
}</code></pre>
                     <p>Alternatively, you can use the <code class="code">-BlockDeviceMapping</code> parameter with the
                        following commands (AWS Tools for Windows PowerShell):
                     </p>
                     
                     <div class="itemizedlist">
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p><a href="./powershell/latest/reference/items/New-EC2Image.html" target="_blank">New-EC2Image</a></p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p><a href="./powershell/latest/reference/items/Register-EC2Image.html" target="_blank">Register-EC2Image</a></p>
                              
                           </li>
                        </ul>
                     </div>
                     
                     
                     
                     
                     <h3 id="view-ami-bdm">Viewing the EBS Volumes in an AMI Block Device Mapping</h3>
                     
                     
                     <p>You can easily enumerate the EBS volumes in the block device mapping for an AMI.</p>
                     
                     
                     <p class="title"><b>To view the EBS volumes for an AMI using the console</b></p>
                     <ol>
                        <li>
                           
                           <p>Open the Amazon EC2 console.</p>
                           
                        </li>
                        <li>
                           
                           <p>In the navigation pane, choose <b>AMIs</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Choose <b>EBS images</b> from the <b>Filter</b> list to
                              get a list of EBS-backed AMIs. 
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Select the desired AMI, and look at the <b>Details</b> tab. At a
                              minimum, the following information is available for the root device:
                           </p>
                           
                           <div class="itemizedlist">
                              
                              
                              
                              
                              <ul class="itemizedlist" type="disc">
                                 <li class="listitem">
                                    
                                    <p><b>Root Device Type</b> (<code class="code">ebs</code>)
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p><b>Root Device Name</b> (for example,
                                       <code>/dev/sda1</code>)
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p><b>Block Devices</b> (for example,
                                       <code class="code">/dev/sda1=snap-1234567890abcdef0:8:true</code>)
                                    </p>
                                    
                                 </li>
                              </ul>
                           </div>
                           
                           <p>If the AMI was created with additional EBS volumes using a block device mapping, the
                              <b>Block Devices</b> field displays the mapping for those additional
                              volumes as well. (Recall that this screen doesn&apos;t display instance store
                              volumes.)
                           </p>
                           
                        </li>
                     </ol>
                     
                     
                     <p><b>To view the EBS volumes for an AMI using the command line</b></p>
                     
                     
                     <p>Use the <a href="./cli/latest/reference/ec2/describe-images.html" target="_blank">describe-images</a>
                        (AWS CLI) command or <a href="./powershell/latest/reference/items/Get-EC2Image.html" target="_blank">Get-EC2Image</a>
                        (AWS Tools for Windows PowerShell) command to enumerate the EBS volumes in the block
                        device mapping for an
                        AMI.
                     </p>
                     
                     
                     
                     
                     
                     <h2 id="instance-block-device-mapping">Instance Block Device Mapping</h2>
                     
                     
                     <p>By default, an instance that you launch includes any storage devices specified in
                        the
                        block device mapping of the AMI from which you launched the instance. You can specify
                        changes
                        to the block device mapping for an instance when you launch it, and these updates
                        overwrite or
                        merge with the block device mapping of the AMI.
                     </p>
                     
                     
                     <div class="itemizedlist">
                        
                        <p class="title"><b>Limits</b></p>
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p>For the root volume, you can only modify the following: volume size, volume type,
                                 and
                                 the <b>Delete on Termination</b> flag.
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>When you modify an EBS volume, you can&apos;t decrease its size. Therefore, you must
                                 specify a snapshot whose size is equal to or greater than the size of the snapshot
                                 specified in the block device mapping of the AMI.
                              </p>
                              
                           </li>
                        </ul>
                     </div>
                     
                     
                     <div class="highlights" id="inline-topiclist">
                        <p><strong>Contents</strong></p>
                        <ul>
                           <li><a href="#Using_OverridingAMIBDM">Updating the Block Device Mapping when Launching an Instance</a></li>
                           <li><a href="#update-instance-bdm">Updating the Block Device Mapping of a Running Instance</a></li>
                           <li><a href="#view-instance-bdm">Viewing the EBS Volumes in an Instance Block Device
                                 Mapping</a></li>
                           <li><a href="#bdm-instance-metadata">Viewing the Instance Block Device Mapping for Instance
                                 Store Volumes</a></li>
                        </ul>
                     </div>
                     
                     
                     
                     <h3 id="Using_OverridingAMIBDM">Updating the Block Device Mapping when Launching an Instance</h3>
                     
                     
                     <p>You can add EBS volumes and instance store volumes to an instance when you launch
                        it.
                        Note that updating the block device mapping for an instance doesn&apos;t make a permanent
                        change
                        to the block device mapping of the AMI from which it was launched.
                     </p>
                     
                     
                     <p class="title"><b>To add volumes to an instance using the console</b></p>
                     <ol>
                        <li>
                           
                           <p>Open the Amazon EC2 console.</p>
                           
                        </li>
                        <li>
                           
                           <p>From the dashboard, choose <b>Launch Instance</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>On the <b>Choose an Amazon Machine Image (AMI)</b> page, select the
                              AMI to use and choose <b>Select</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Follow the wizard to complete the <b>Choose an Instance Type</b> and
                              <b>Configure Instance Details</b> pages.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>On the <b>Add Storage</b> page, you can modify the root volume, EBS
                              volumes, and instance store volumes as follows:
                           </p>
                           
                           <div class="itemizedlist">
                              
                              
                              
                              
                              
                              
                              <ul class="itemizedlist" type="disc">
                                 <li class="listitem">
                                    
                                    <p>To change the size of the root volume, locate the <b>Root</b>
                                       volume under the <b>Type</b> column, and change its
                                       <b>Size</b> field.
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>To suppress an EBS volume specified by the block device mapping of the AMI used
                                       to launch the instance, locate the volume and click its <b>Delete</b>
                                       icon.
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>To add an EBS volume, choose <b>Add New Volume</b>, choose
                                       <b>EBS</b> from the <b>Type</b> list, and fill in the
                                       fields (<b>Device</b>, <b>Snapshot</b>, and so
                                       on).
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>To suppress an instance store volume specified by the block device mapping of
                                       the AMI used to launch the instance, locate the volume, and choose its
                                       <b>Delete</b> icon.
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>To add an instance store volume, choose <b>Add New Volume</b>,
                                       select <b>Instance Store</b> from the <b>Type</b> list,
                                       and select a device name from <b>Device</b>.
                                    </p>
                                    
                                 </li>
                              </ul>
                           </div>
                           
                        </li>
                        <li>
                           
                           <p>Complete the remaining wizard pages, and choose <b>Launch</b>.
                           </p>
                           
                        </li>
                     </ol>
                     
                     
                     <p><b>To add volumes to an instance using the command line</b></p>
                     
                     
                     <p>Use the <a href="./cli/latest/reference/ec2/run-instances.html" target="_blank">run-instances</a> AWS CLI
                        command to specify a block device mapping for an instance.
                     </p>
                     
                     
                     <p>Specify the block device mapping using the following parameter:</p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight"><b>--block-device-mappings</b> [<em class="replaceable"><code>mapping</code></em>, ...]</code></pre>
                     
                     <p>For example, suppose that an EBS-backed AMI specifies the following block device
                        mapping:
                     </p>
                     
                     
                     <div class="itemizedlist">
                        
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p><span>/dev/sdb</span>=ephemeral0
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p><span>/dev/sdh</span>=snap-1234567890abcdef0
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p><span>/dev/sdj</span>=:100
                              </p>
                              
                           </li>
                        </ul>
                     </div>
                     
                     
                     <p>To prevent <code>/dev/sdj</code> from attaching to an instance launched from this AMI, use the following
                        mapping:
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="json ">{
    &quot;DeviceName&quot;: &quot;<span>/dev/sdj</span>&quot;,
    &quot;NoDevice&quot;: &quot;&quot;
}</code></pre>
                     
                     <p>To increase the size of <code>/dev/sdh</code> to 300 GiB, specify the following mapping. Notice that you don&apos;t need to
                        specify the snapshot ID for <code>/dev/sdh</code>, because specifying the device name is enough to identify the
                        volume.
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="json ">{
    &quot;DeviceName&quot;: &quot;<span>/dev/sdh</span>&quot;,
    &quot;Ebs&quot;: {
      &quot;VolumeSize&quot;: 300
    }
}</code></pre>
                     
                     <p>To attach an additional instance store volume, <code>/dev/sdc</code>, specify the following mapping.
                        If the instance type doesn&apos;t support multiple instance store volumes, this mapping
                        has no
                        effect.
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="json ">{
    &quot;DeviceName&quot;: &quot;<span>/dev/sdc</span>&quot;,
    &quot;VirtualName&quot;: &quot;ephemeral1&quot;
}</code></pre>
                     <p>Alternatively, you can use the <code class="code">-BlockDeviceMapping</code> parameter with the
                        <a href="./powershell/latest/reference/items/New-EC2Instance.html" target="_blank">New-EC2Instance</a> command
                        (AWS Tools for Windows PowerShell).
                     </p>
                     
                     
                     
                     
                     <h3 id="update-instance-bdm">Updating the Block Device Mapping of a Running Instance</h3>
                     
                     
                     <p>You can use the following <a href="./cli/latest/reference/ec2/modify-instance-attribute.html" target="_blank">modify-instance-attribute</a> AWS CLI command to update the block device mapping of a
                        running instance. Note that you do not need to stop the instance before changing this
                        attribute.
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight"><strong class="userinput"><code>aws ec2 modify-instance-attribute --instance-id i-<em class="replaceable"><code>1a2b3c4d</code></em> --block-device-mappings file://mapping.json</code></strong></code></pre>
                     <p>For example, to preserve the root volume at instance termination, specify the following
                        in <code>mapping.json</code>:
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="json ">[
  {
    &quot;DeviceName&quot;: &quot;/dev/sda1&quot;,
    &quot;Ebs&quot;: {
      &quot;DeleteOnTermination&quot;: false
    }
  }
]</code></pre>
                     <p>Alternatively, you can use the <code class="code">-BlockDeviceMapping</code> parameter with the
                        <a href="./powershell/latest/reference/items/Edit-EC2InstanceAttribute.html" target="_blank">Edit-EC2InstanceAttribute</a> command (AWS Tools for Windows PowerShell).
                     </p>
                     
                     
                     
                     
                     <h3 id="view-instance-bdm">Viewing the EBS Volumes in an Instance Block Device
                        Mapping
                     </h3>
                     
                     
                     <p>You can easily enumerate the EBS volumes mapped to an instance.</p>
                     
                     
                     <div class="aws-note">
                        <p class="aws-note">Note</p>
                        <p>For instances launched before the release of the 2009-10-31 API, AWS can&apos;t display
                           the block device mapping. You must detach and reattach the volumes so that AWS can
                           display
                           the block device mapping.
                        </p>
                     </div>
                     
                     
                     <p class="title"><b>To view the EBS volumes for an instance using the console</b></p>
                     <ol>
                        <li>
                           
                           <p>Open the Amazon EC2 console.</p>
                           
                        </li>
                        <li>
                           
                           <p>In the navigation pane, choose <b>Instances</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>In the search bar, type <b>Root Device Type</b>, and then choose
                              <b>EBS</b>. This displays a list of EBS-backed instances.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Select the desired instance and look at the details displayed in the
                              <b>Description</b> tab. At a minimum, the following information is
                              available for the root device:
                           </p>
                           
                           <div class="itemizedlist">
                              
                              
                              
                              
                              <ul class="itemizedlist" type="disc">
                                 <li class="listitem">
                                    
                                    <p><b>Root device type</b> (<code class="code">ebs</code>)
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p><b>Root device</b> (for example,
                                       <code>/dev/sda1</code>)
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p><b>Block devices</b> (for example, <code>/dev/sda1</code>,
                                       <code>/dev/sdh</code>,
                                       and <code>/dev/sdj</code>)
                                    </p>
                                    
                                 </li>
                              </ul>
                           </div>
                           
                           <p>If the instance was launched with additional EBS volumes using a block device
                              mapping, the <b>Block devices</b> field displays those additional volumes
                              as well as the root device. (Recall that this dialog box doesn&apos;t display instance
                              store
                              volumes.)
                           </p>
                           
                           <div class="mediaobject">
                              
                              <img src="../../..//img/block-device-mapping-description-tab.png" alt="
              Block devices for an instance.
            ">
                              
                              
                              
                           </div>
                           
                        </li>
                        <li>
                           
                           <p>To display additional information about a block device, select its entry next to
                              <b>Block devices</b>. This displays the following information for the
                              block device:
                           </p>
                           
                           <div class="itemizedlist">
                              
                              
                              
                              
                              
                              
                              <ul class="itemizedlist" type="disc">
                                 <li class="listitem">
                                    
                                    <p><b>EBS ID</b> (vol-<em>xxxxxxxx</em>)
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p><b>Root device type</b> (<code class="code">ebs</code>)
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p><b>Attachment time</b>
                                       (<em>yyyy</em>-<em>mm</em>T<em>hh</em>:<em>mm</em>:<em>ss</em>.<em>s</em><em>sTZD</em>)
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p><b>Block device status</b> (<code class="code">attaching</code>,
                                       <code class="code">attached</code>, <code class="code">detaching</code>, <code class="code">detached</code>)
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p><b>Delete on termination</b> (<code class="code">Yes</code>,
                                       <code class="code">No</code>)
                                    </p>
                                    
                                 </li>
                              </ul>
                           </div>
                           
                        </li>
                     </ol>
                     
                     
                     <p><b>To view the EBS volumes for an instance using the command
                           line</b></p>
                     
                     
                     <p>Use the <a href="./cli/latest/reference/ec2/describe-instances.html" target="_blank">describe-instances</a>
                        (AWS CLI) command or <a href="./powershell/latest/reference/items/Get-EC2Instance.html" target="_blank">Get-EC2Instance</a> (AWS Tools for Windows PowerShell) command to enumerate the EBS volumes in the block
                        device mapping for an instance.
                     </p>
                     
                     
                     
                     
                     
                     <h3 id="bdm-instance-metadata">Viewing the Instance Block Device Mapping for Instance
                        Store Volumes
                     </h3>
                     
                     
                     
                     <p>When you view the block device mapping for your instance, you can see only the EBS
                        volumes, not the instance store volumes. You can use instance metadata to query the
                        complete
                        block device mapping. The base URI for all requests for instance metadata is
                        <code class="code">http://169.254.169.254/latest/</code>.
                     </p>
                     
                     
                     <p>First, connect to your running instance. From the instance, use this query to get
                        its
                        block device mapping. 
                     </p>
                     
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight"><code class="prompt" copy="false">[ec2-user ~]$ </code><strong class="userinput"><code>curl http://169.254.169.254/latest/meta-data/block-device-mapping/</code></strong></code></pre>
                     
                     
                     <p>The response includes the names of the block devices for the instance. For example,
                        the
                        output for an instance store&#x2013;backed <code class="code">m1.small</code> instance looks like
                        this.
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">ami
ephemeral0
root
swap</code></pre>
                     
                     <p>The <code class="code">ami</code> device is the root device as seen by the instance. The instance
                        store volumes are named <code>ephemeral[0-23]</code>. The <code class="code">swap</code> device
                        is for the page file. If you&apos;ve also mapped EBS volumes, they appear as <code class="code">ebs1</code>,
                        <code class="code">ebs2</code>, and so on.
                     </p>
                     
                     
                     <p>To get details about an individual block device in the block device mapping, append
                        its
                        name to the previous query, as shown here.
                     </p>
                     
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight"><code class="prompt" copy="false">[ec2-user ~]$ </code><strong class="userinput"><code>curl http://169.254.169.254/latest/meta-data/block-device-mapping/ephemeral0</code></strong></code></pre>
                     
                     
                     <p>For more information, see <a href="ec2-instance-metadata.html">Instance Metadata and User Data</a>.
                     </p>
                     
                     
                     
                     
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be enabled. Please refer to your browser's
                                    Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="device_naming.html">&#xAB; Previous </a><a class="awstoc" accesskey="n" href="using-public-data-sets.html">Next &#xBB;</a></div>
                     <div id="copyright-main-footer">&#xA9; 2018, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="Block Device Mapping Concepts"><a class="pagetoc" href="#block-device-mapping-def">Block Device Mapping Concepts</a></li>
                        <li class="pagetoc" name="AMI Block Device Mapping"><a class="pagetoc" href="#ami-block-device-mapping">AMI Block Device Mapping</a></li>
                        <li class="pagetoc" name="Instance Block Device Mapping"><a class="pagetoc" href="#instance-block-device-mapping">Instance Block Device Mapping</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='Amazon Elastic Compute Cloud';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='User Guide for Linux Instances';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   
</body></html>