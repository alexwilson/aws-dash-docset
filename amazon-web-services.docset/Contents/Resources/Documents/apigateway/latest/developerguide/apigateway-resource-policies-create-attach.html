<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Create and Attach an API Gateway
         Resource Policy to an API - Amazon API Gateway
      </title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="home" href="#top">
      <link rel="up" href="apigateway-resource-policies.html" title="Control Access to an API with Amazon API Gateway
            Resource Policies">
      <link rel="prev" href="apigateway-resource-policies-examples.html" title="API Gateway Resource Policy
                Examples">
      <link rel="next" href="apigateway-resource-policies-iam-policies-interaction.html" title="Interactions
                Between API Gateway Resource Policies and IAM Policies">
      <meta name="description" content="To allow a user to access your API by calling the API execution service, you must create an API Gateway resource policy, which controls access to the API Gateway resources, and attach the policy to the API.">
      <meta name="deployment_region" content="IAD">
      <meta name="product" content="Amazon API Gateway">
      <meta name="guide" content="Developer Guide">
      <meta name="guide-locale" content="en_us">
      <link rel="icon" type="image/ico" href="/images/favicon.ico">
      <link rel="shortcut icon" type="image/ico" href="/images/favicon.ico">
      <link rel="canonical" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-resource-policies-create-attach.html">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/font-awesome.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/google-font.css">
      <link id="code-style" rel="stylesheet" type="text/css" href="../../../css/light.css">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.theme.css">
      <link rel="stylesheet" type="text/css" href="../../../css/colorbox.css">
      <link rel="stylesheet" type="text/css" href="../../../css/awsdocs.css"><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="/js/jquery-ui.min.js"></script><script type="text/javascript" src="/js/handlebars.js"></script><script type="text/javascript" src="/js/jquery.colorbox.js"></script><script type="text/javascript" src="/js/awsdocs.min.js?v=20170615"></script></head>
   <body id="top">
      
      <div id="content-container">
         
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tbody><tr>
                           <td>
                              <div class="breadcrumb"><a href="http://aws.amazon.com/documentation">AWS Documentation</a> &#xBB; <a href="http://aws.amazon.com/documentation/apigateway">Amazon API Gateway</a> &#xBB; <a href="index.html">Developer Guide</a> &#xBB; <a href="apigateway-control-access-to-api.html"> Controlling Access to an API in
                                    			API Gateway</a> &#xBB; <a href="apigateway-resource-policies.html">Control Access to an API with Amazon API Gateway
                                    Resource Policies</a> &#xBB; <span class="breadcrumb">Create and Attach an API Gateway
                                    Resource Policy to an API</span></div>
                           </td>
                        </tr>
                     </tbody></table>
                     <div></div>
                     <h1 class="topictitle" id="apigateway-resource-policies-create-attach">Create and Attach an API Gateway
                        Resource Policy to an API
                     </h1>
                     <p>To allow a user to access your API by calling the API execution service, you must
                        create an API Gateway resource policy, which controls access to the API Gateway resources,
                        and
                        attach the policy to the API.
                     </p>
                     <p>The resource policy can be attached to the API when the API is created, or it can
                        be
                        updated later.
                     </p>
                     <div class="aws-note">
                        <p class="aws-note">Important</p>
                        <p>If you update the resource policy after the API is created, you&apos;ll need to deploy
                           the API to propagate the changes after you&apos;ve attached the updated policy. Updating
                           or saving the policy alone won&apos;t change the runtime behavior of the API. For more
                           information about deploying your API, see <a href="how-to-deploy-api.html">Deploying an API in Amazon API Gateway</a>.
                        </p>
                     </div>
                     <p>Access can be controlled by IAM condition elements, including conditions on AWS
                        account or IP range. If the <code class="code">Principal</code> in the
                        policy is set to <code class="code">&quot;*&quot;</code>, other authorization types can be used alongside the
                        resource policy. If the <code class="code">Principal</code> is set to <code class="code">&quot;AWS&quot;: ...</code>,
                        authorization will fail for all resources not secured with <code class="code">AWS_IAM</code>
                        authorization, including unsecured resources.
                     </p>
                     <p>The following sections describe how to create your own API Gateway resource policy
                        and
                        attach it to your API. Attaching a policy applies the permissions in the policy to
                        the
                        methods in the API.
                     </p>
                     
                     <h2 id="apigateway-resource-policies-create-attach-console">Attaching API Gateway
                        Resource Policies (Console)
                     </h2>
                     
                     <p>You can use the AWS Management console to attach a resource policy to an API Gateway
                        API. 
                     </p>
                     
                     <p class="title"><b>To attach a resource policy to an API Gateway API</b></p>
                     <ol>
                        <li>
                           <p>Sign in to the API Gateway console at <a href="https://console.aws.amazon.com/apigateway" target="_blank">https://console.aws.amazon.com/apigateway</a>.
                           </p>
                        </li>
                        <li>
                           
                           <p>Choose the API name.</p>
                           
                        </li>
                        <li>
                           
                           <p>In the left-hand navigation pane, choose <b>Resource
                                 Policy</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>If desired, choose one of the <b>Examples</b>. In the
                              example policies, placeholders are enclosed in double curly braces
                              (<code class="code">&quot;{{}}&quot;</code>). Replace each of the placeholders (including the
                              curly braces) with the necessary information.
                           </p>
                           
                           <p>If you don&apos;t use one of the <b>Examples</b>, enter your
                              resource policy.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Choose <b>Save</b>.
                           </p>
                           
                        </li>
                     </ol>
                     
                     
                     <h2 id="apigateway-resource-policies-create-attach-using-cli">Attaching
                        API Gateway Resource Policies (AWS CLI)
                     </h2>
                     
                     
                     <p>To use the AWS CLI to create a new API and attach a resource policy to it, call the
                        <a href="./cli/latest/reference/apigateway/create-rest-api.html" target="_blank"><code class="code">create-rest-api</code></a> command as follows:
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">aws apigateway create-rest-api \
    --name &quot;<em class="replaceable"><code>api-name</code></em>&quot; \
    --policy &quot;{\&quot;<em class="replaceable"><code>jsonEscapedPolicyDocument</code></em>\&quot;}&quot;</code></pre>
                     
                     <p>To use the AWS CLI to attach a resource policy to an existing API, call the <a href="./cli/latest/reference/apigateway/update-rest-api.html" target="_blank"><code class="code">update-rest-api</code></a> command as follows: 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">aws apigateway update-rest-api \
    --rest-api-id <em class="replaceable"><code>api-id</code></em> \
    --patch-operations op=replace,path=/policy,value=&apos;{\&quot;<em class="replaceable"><code>jsonEscapedPolicyDocument</code></em>\&quot;}&apos;</code></pre>
                     
                     
                     <h2 id="apigateway-resource-policies-create-attach-using-api">Attaching
                        API Gateway Resource Policies (API Gateway API)
                     </h2>
                     
                     
                     <p>To use the <a href="./apigateway/api-reference/" target="_blank">API Gateway REST API</a> to create a new API
                        and attach a resource policy to it, call the <a href="./cli/latest/reference/apigateway/create-rest-api.html" target="_blank"><code class="code">create-rest-api</code></a> command as follows:
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">POST /restapis

{
 &quot;name&quot;: &quot;<em class="replaceable"><code>api-name</code></em>&quot;,
 &quot;policy&quot;: &quot;{\&quot;<em class="replaceable"><code>jsonEscapedPolicyDocument</code></em>\&quot;}&quot;
}
// simplified format supported here because apiId is not known yet and partition/region/account can be derived at import time
// &quot;Resource&quot;: [
//   &quot;execute-api:/<em class="replaceable"><code>stage</code></em>/<em class="replaceable"><code>method</code></em>/<em class="replaceable"><code>path</code></em>&quot; 
// ]</code></pre>
                     
                     <p>To use the <a href="./apigateway/api-reference/" target="_blank">API Gateway REST API</a> to attach a resource
                        policy to an existing API, call the <a href="./apigateway/api-reference/link-relation/restapi-update/" target="_blank"><code class="code">restapi:update</code></a> command as follows: 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">PATCH /restapis/<em class="replaceable"><code>api-id</code></em>

{
 &quot;patchOperations&quot; : [ {
   &quot;op&quot;: &quot;replace&quot;,
   &quot;path&quot;: &quot;/policy&quot;,
   &quot;value&quot;: &quot;{\&quot;<em class="replaceable"><code>jsonEscapedPolicyDocument</code></em>\&quot;}&quot;
  } ]
}</code></pre>
                     
                     
                     <h2 id="apigateway-resource-policies-create-attach-using-swagger">Swagger
                        Example of Attaching a API Gateway Resource Policy
                     </h2>
                     
                     
                     <p>The <a href="./apigateway/api-reference/link-relation/import-restapi/" target="_blank"><code class="code">restapi:import</code></a> command can be used to import a Swagger
                        definition of an API with attached resource policy, as shown in the following
                        example:
                     </p>
                     
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">{
 &quot;swagger&quot;: &quot;2.0&quot;,
 &quot;x-amazon-apigateway-policy&quot;: {
   &quot;Version&quot;: &quot;2012-10-17&quot;,
   &quot;Statement&quot;: [
      {
       &quot;Effect&quot;: &quot;Allow&quot;,
       &quot;Principal&quot;: {
         &quot;AWS&quot;: [
           &quot;arn:aws:iam::111122223333:user/Alice&quot;,
           &quot;arn:aws:iam::111122223333:root&quot;
          ]
        },
       &quot;Action&quot;: &quot;execute-api:Invoke&quot;,
       &quot;Resource&quot;: [
         &quot;execute-api:/<em class="replaceable"><code>stage</code></em>/<em class="replaceable"><code>method</code></em>/<em class="replaceable"><code>path</code></em>&quot; // simplified format supported here because apiId is not known yet and partition/region/account can derived at import time
       ]
      }
    ]
  },
 &quot;info&quot; : {
   &quot;title&quot; : &quot;Example&quot;
  },
 &quot;schemes&quot;: [
   &quot;https&quot;
  ],
 &quot;paths&quot;: {...}
}</code></pre>
                     
                     </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be enabled. Please refer to your browser's
                                    Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="apigateway-resource-policies-examples.html">&#xAB; Previous </a><a class="awstoc" accesskey="n" href="apigateway-resource-policies-iam-policies-interaction.html">Next &#xBB;</a></div>
                     <div id="copyright-main-footer">&#xA9; 2018, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="Attaching API Gateway
                    Resource Policies (Console)"><a class="pagetoc" href="#apigateway-resource-policies-create-attach-console">Attaching API Gateway
                              Resource Policies (Console)</a></li>
                        <li class="pagetoc" name="Attaching
                    API Gateway Resource Policies (AWS CLI)"><a class="pagetoc" href="#apigateway-resource-policies-create-attach-using-cli">Attaching
                              API Gateway Resource Policies (AWS CLI)</a></li>
                        <li class="pagetoc" name="Attaching
                    API Gateway Resource Policies (API Gateway API)"><a class="pagetoc" href="#apigateway-resource-policies-create-attach-using-api">Attaching
                              API Gateway Resource Policies (API Gateway API)</a></li>
                        <li class="pagetoc" name="Swagger
                    Example of Attaching a API Gateway Resource Policy"><a class="pagetoc" href="#apigateway-resource-policies-create-attach-using-swagger">Swagger
                              Example of Attaching a API Gateway Resource Policy</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='Amazon API Gateway';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='Developer Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   
</body></html>