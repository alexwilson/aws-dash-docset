<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Build an API Gateway API with
         Custom Lambda Integration - Amazon API Gateway
      </title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="home" href="#top">
      <link rel="up" href="getting-started-with-lambda-integration.html" title="Build an API Gateway API with Lambda Integration">
      <link rel="prev" href="apigateway-cross-account-lambda-integrations.html" title="Build an API Gateway API with
            Cross-Account Lambda Proxy Integration">
      <link rel="next" href="getting-started-http-integrations.html" title="">
      <meta name="description" content="Learn how to create and test an API method to expose a Lambda function with the Lambda custom integration using the API Gateway console.">
      <meta name="deployment_region" content="IAD">
      <meta name="product" content="Amazon API Gateway">
      <meta name="guide" content="Developer Guide">
      <meta name="guide-locale" content="en_us">
      <link rel="icon" type="image/ico" href="/images/favicon.ico">
      <link rel="shortcut icon" type="image/ico" href="/images/favicon.ico">
      <link rel="canonical" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/getting-started-lambda-non-proxy-integration.html">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/font-awesome.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/google-font.css">
      <link id="code-style" rel="stylesheet" type="text/css" href="../../../css/light.css">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.theme.css">
      <link rel="stylesheet" type="text/css" href="../../../css/colorbox.css">
      <link rel="stylesheet" type="text/css" href="../../../css/awsdocs.css"><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="/js/jquery-ui.min.js"></script><script type="text/javascript" src="/js/handlebars.js"></script><script type="text/javascript" src="/js/jquery.colorbox.js"></script><script type="text/javascript" src="/js/awsdocs.min.js?v=20170615"></script></head>
   <body id="top">
      
      <div id="content-container">
         
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tbody><tr>
                           <td>
                              <div class="breadcrumb"><a href="http://aws.amazon.com/documentation">AWS Documentation</a> &#xBB; <a href="http://aws.amazon.com/documentation/apigateway">Amazon API Gateway</a> &#xBB; <a href="index.html">Developer Guide</a> &#xBB; <a href="getting-started.html">Getting Started with Amazon API Gateway</a> &#xBB; <a href="getting-started-with-lambda-integration.html">Build an API Gateway API with Lambda Integration</a> &#xBB; <span class="breadcrumb">Build an API Gateway API with
                                    Custom Lambda Integration</span></div>
                           </td>
                        </tr>
                     </tbody></table>
                     <div></div>
                     <h1 class="topictitle" id="getting-started-lambda-non-proxy-integration">Build an API Gateway API with
                        Custom Lambda Integration
                     </h1>
                     <div class="aws-note">
                        <p class="aws-note">Note</p>
                        <p> The <em>Lambda custom integration</em>, formerly known as the
                           <em>Lambda integration</em>, is a legacy technology. We recommend that
                           you use the <em>Lambda proxy integration</em> for any new API. For more
                           information, see <a href="api-gateway-create-api-as-simple-proxy-for-lambda.html">
                              Build an API Gateway API with Lambda Proxy Integration 
                              </a></p>
                     </div>
                     <p>In this walkthrough, we use the API Gateway console to build an API that enables a
                        client to
                        call Lambda functions through the Lambda custom integration. For more information
                        about
                        AWS Lambda and Lambda functions, see the <a href="./lambda/latest/dg/" target="_blank">AWS Lambda Developer Guide</a>. 
                     </p>
                     <p>To facilitate learning, we chose a simple Lambda function with minimal API setup to
                        walk
                        you through the steps of building an API Gateway API with the Lambda custom integration.
                        When
                        necessary, we describe some of the logic. For a more detailed example of the Lambda
                        custom
                        integration, see <a href="integrating-api-with-aws-services-lambda.html">Create an API Gateway API for AWS Lambda Functions</a>. 
                     </p>
                     <p>Before creating the API, set up the Lambda backend by creating a Lambda function in
                        AWS Lambda, described next.
                     </p>
                     <div class="highlights" id="inline-topiclist">
                        <p><strong>Topics</strong></p>
                        <ul>
                           <li><a href="#getting-started-new-lambda">Create a Lambda Function for the Lambda
                                 Custom Integration</a></li>
                           <li><a href="#getting-started-new-api">Create an API with the Lambda Custom
                                 Integration</a></li>
                           <li><a href="#getting-started-new-get">Test Invoking the API Method</a></li>
                           <li><a href="#getting-started-deploy-api">Deploy the API</a></li>
                           <li><a href="#getting-started-test">Test the API in a Deployment Stage</a></li>
                           <li><a href="#getting-started-clean-up">Clean Up</a></li>
                        </ul>
                     </div>
                     
                     <h2 id="getting-started-new-lambda">Create a Lambda Function for the Lambda
                        Custom Integration
                     </h2>
                     
                     <div class="aws-note">
                        <p class="aws-note">Note</p>
                        <p>Creating Lambda functions may result in charges to your AWS account.</p>
                     </div>
                     
                     <p> In this step, you create a &quot;Hello, World!&quot;-like Lambda function for the Lambda custom
                        integration. Throughout this walkthrough, the function is called
                        <code class="code">GetStartedLambdaIntegration</code>. It is similar to <a href="api-gateway-create-api-as-simple-proxy-for-lambda.html#api-gateway-proxy-integration-lambda-function-nodejs"><code class="code">GetStartedLambdaProxyIntegration</code></a>, which is the function we
                        created for the Lambda proxy integration. 
                     </p>
                     
                     <p> The Node.js implementation of this <code class="code">GetStartedLambdaIntegration</code> Lambda
                        function is as follows: 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">&apos;use strict&apos;;
var days = [&apos;Sunday&apos;, &apos;Monday&apos;, &apos;Tuesday&apos;, &apos;Wednesday&apos;, &apos;Thursday&apos;, &apos;Friday&apos;, &apos;Saturday&apos;];            
var times = [&apos;morning&apos;, &apos;afternoon&apos;, &apos;evening&apos;, &apos;night&apos;, &apos;day&apos;];

console.log(&apos;Loading function&apos;);

exports.handler = function(event, context, callback) {
  // Parse the input for the name, city, time and day property values
  let name = event.name === undefined ? &apos;you&apos; : event.name;
  let city = event.city === undefined ? &apos;World&apos; : event.city;
  let time = times.indexOf(event.time)&lt;0 ? &apos;day&apos; : event.time;
  let day = days.indexOf(event.day)&lt;0 ? null : event.day;

  // Generate a greeting
  let greeting = &apos;Good &apos; + time + &apos;, &apos; + name + &apos; of &apos; + city + &apos;. &apos;;
  if (day) greeting += &apos;Happy &apos; + day + &apos;!&apos;;
  
  // Log the greeting to CloudWatch
  console.log(&apos;Hello: &apos;, greeting);
  
  // Return a greeting to the caller
  callback(null, {
      &quot;greeting&quot;: greeting
  }); 
};</code></pre>
                     <p>For the Lambda custom integration, API Gateway passes the input to the Lambda function
                        from
                        the client as the integration request body. The <code class="code">event</code> object of the Lambda
                        function handler is the input. 
                     </p>
                     
                     <p>Our Lambda function is simple. It parses the input <code class="code">event</code> object for the
                        <code class="code">name</code>, <code class="code">city</code>, <code class="code">time</code>, and <code class="code">day</code>
                        properties. It then returns a greeting, as a JSON object of
                        <code class="code">{&quot;message&quot;:greeting}</code>, to the caller. The message is in the <code class="code">&quot;Good
                           [morning|afternoon|day], [<em class="replaceable"><code>name</code></em>|you] in
                           [<em class="replaceable"><code>city</code></em>|World]. Happy
                           <em class="replaceable"><code>day</code></em>!&quot;</code> pattern. It is assumed that the input to the
                        Lambda function is of the following JSON object: 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">{
  &quot;city&quot;: &quot;...&quot;,
  &quot;time&quot;: &quot;...&quot;,
  &quot;day&quot;: &quot;...&quot;,
  &quot;name&quot; : &quot;...&quot;
}</code></pre>
                     <p>For more information, see the <a href="./lambda/latest/dg/welcome.html" target="_blank">AWS Lambda Developer Guide</a>. 
                     </p>
                     
                     <p>In addition, the function logs its execution to Amazon CloudWatch by calling
                        <code class="code">console.log(...)</code>. This is helpful for tracing calls when debugging the
                        function. To allow the <code class="code">GetStartedLambdaIntegration</code> function to log the
                        call, set an IAM role with appropriate policies for the Lambda function to create
                        the
                        CloudWatch streams and add log entries to the streams. The Lambda console guides you
                        through to
                        create the required IAM roles and policies.
                     </p>
                     
                     <p>If you set up the API without using the API Gateway console, such as when <a href="https://github.com/awslabs/api-gateway-secure-pet-store/blob/master/src/main/resources/swagger.yaml#L39" target="_blank">importing an API from Swagger</a>, you must explicitly create, if necessary,
                        and set up an invocation role and policy for API Gateway to invoke the Lambda functions.
                        For
                        more information on how to set up Lambda invocation and execution roles for an API
                        Gateway API,
                        see <a href="permissions.html">Control Access to an API with IAM Permissions</a>. 
                     </p>
                     
                     <p> Compared to <a href="api-gateway-create-api-as-simple-proxy-for-lambda.html#api-gateway-proxy-integration-lambda-function-nodejs"><code class="code">GetStartedLambdaProxyIntegation</code></a>, the Lambda function for the
                        Lambda proxy integration, the <code class="code">GetStartedLambdaIntegration</code> Lambda function for
                        the Lambda custom integration only takes input from the API Gateway API integration
                        request
                        body. The function can return an output of any JSON object, a string, a number, a
                        Boolean, or even a binary blob. The Lambda function for the Lambda proxy integration,
                        in
                        contrast, can take the input from any request data, but must return an output of a
                        particular JSON object. The <code class="code">GetStartedLambdaIntegration</code> function for the
                        Lambda custom integration can have the API request parameters as input, provided that
                        API Gateway maps the required API request parameters to the integration request body
                        before
                        forwarding the client request to the backend. For this to happen, the API developer
                        must
                        create a mapping template and configure it on the API method when creating the API.
                        
                     </p>
                     
                     <p>Now, create the <code class="code">GetStartedLambdaIntegration</code> Lambda function. 
                     </p>
                     
                     <p class="title"><b>To create the <code class="code">GetStartedLambdaIntegration</code> Lambda function for Lambda
                           custom integration</b></p>
                     <ol>
                        <li>
                           <p>Open the AWS Lambda console at
                              <a href="https://console.aws.amazon.com/lambda/" target="_blank">https://console.aws.amazon.com/lambda/</a>.
                           </p>
                        </li>
                        <li>
                           
                           <p>Do one of the following:</p>
                           
                           <div class="itemizedlist">
                              
                              
                              
                              <ul class="itemizedlist" type="disc">
                                 <li class="listitem">
                                    
                                    <p>If the welcome page appears, choose <b>Get Started
                                          Now</b> and then choose <b>Create a
                                          function</b>.
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>If the <b>Lambda &gt; Functions</b> list page appears,
                                       choose <b>Create a function</b>.
                                    </p>
                                    
                                 </li>
                              </ul>
                           </div>
                           
                        </li>
                        <li>
                           
                           <p> From <b>Select blueprint</b>, choose <b>Author from
                                 scratch</b>. 
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>In the <b>Configure triggers</b> pane, choose
                              <b>Next</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>In the <b>Configure function</b> pane, do the following:
                           </p>
                           
                           <ol>
                              <li>
                                 
                                 <p>Under <b>Basic information</b>: 
                                 </p>
                                 
                                 <div class="itemizedlist">
                                    
                                    
                                    
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p>For <b>Name</b>, type
                                             <strong class="userinput"><code>GetStartedLambdaIntegration</code></strong> as the
                                             Lambda function name.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p>For <b>Description</b>, type <strong class="userinput"><code>Backend
                                                   for the Getting Started walkthrough with Lambda custom
                                                   integration</code></strong>. This is optional and you can leave
                                             it blank.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p> For <b>Runtime</b>, choose <b>Node.js
                                                6.10</b>. 
                                          </p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 
                              </li>
                              <li>
                                 
                                 <p>Under <b>Lambda function code</b>:
                                 </p>
                                 
                                 <div class="itemizedlist">
                                    
                                    
                                    
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p>Choose <b>Edit code inline</b>, if it is not
                                             already shown, under <b>Content entry
                                                type</b>.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p>Copy the Lambda function code listed in the beginning of this
                                             section and paste it in the inline code editor.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p>Leave the default choices for all other fields in this
                                             section.
                                          </p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 
                              </li>
                              <li>
                                 
                                 <p> Under <b>Lambda function handler and role</b>: 
                                 </p>
                                 
                                 <div class="itemizedlist">
                                    
                                    
                                    
                                    
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p> Leave the default of <code class="literal">index.handler</code> for <b>Handler</b>.
                                             
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p>For <b>Role</b>, choose <code class="literal">Create new role from template(s)</code>.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p>For <b>Role name</b>, type a name for your role
                                             (for example,
                                             <strong class="userinput"><code>GetStartedLambdaIntegrationRole</code></strong>).
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p>For <b>Policy templates</b>, choose <code class="literal">Simple Microservice permissions</code>. 
                                          </p>
                                          
                                          <div class="aws-note">
                                             <p class="aws-note">Tip</p>
                                             <p> To use an existing IAM role, choose <code class="literal">Choose an existing role</code> for
                                                <b>Role</b> and then select an entry from
                                                the drop-down list of existing roles. Alternatively, to
                                                create a custom role, choose <code class="literal">Create
                                                   a Custom Role</code> and follow the instructions.
                                                
                                             </p>
                                          </div>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 
                              </li>
                              <li>
                                 
                                 <p> For <b>Tags</b>, leave them blank. 
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p> For <b>Advanced settings</b> leave the defaults.
                                    
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p> Choose <b>Next</b>. 
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>Choose <b>Create function</b>. Note of the AWS Region
                                    where you created this function. You need it later. 
                                 </p>
                                 
                              </li>
                           </ol>
                           
                        </li>
                        <li>
                           
                           <p> To test the newly created function, as a best practice, choose
                              <b>Actions</b> and select <b>Configure test
                                 event</b>. 
                           </p>
                           
                           <ol>
                              <li>
                                 
                                 <p>For <b>Input test event</b>, replace any default code
                                    statements with the following, and then choose <b>Save and
                                       test</b>.
                                 </p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">{
  &quot;name&quot;: &quot;Jonny&quot;,
  &quot;city&quot;: &quot;Seattle&quot;,
  &quot;time&quot;: &quot;morning&quot;,
  &quot;day&quot;: &quot;Wednesday&quot;
}</code></pre>
                                 </li>
                              <li>
                                 
                                 <p> Choose <b>Test</b> to invoke the function. The
                                    <b>Execution result: succeeded</b> section is shown.
                                    Expand <b>Detail</b> and you see the following
                                    output.
                                 </p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">{
    &quot;greeting&quot;: &quot;Good morning, Jonny of Seattle. Happy Wednesday!&quot;
}</code></pre>
                                 <p>The output is also written to CloudWatch Logs. </p>
                                 
                              </li>
                           </ol>
                           
                        </li>
                     </ol>
                     
                     <p> As a side exercise, you can use the IAM console to view the IAM role (<code class="literal">GetStartedLambdaIntegrationRole</code>) that was created as part
                        of the Lambda function creation. Attached to this IAM role are two inline policies.
                        One
                        stipulates the most basic permissions for Lambda execution. It permits calling the
                        CloudWatch
                        <code class="code">CreateLogGroup</code> for any CloudWatch resources of your account in the region
                        where the Lambda function is created. This policy also allows creating the CloudWatch
                        streams
                        and logging events for the <code class="code">HelloWorldForLambdaIntegration</code> Lambda function. 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">{
    &quot;Version&quot;: &quot;2012-10-17&quot;,
    &quot;Statement&quot;: [
        {
            &quot;Effect&quot;: &quot;Allow&quot;,
            &quot;Action&quot;: &quot;logs:CreateLogGroup&quot;,
            &quot;Resource&quot;: &quot;arn:aws:logs:<em class="replaceable"><code>region</code></em>:<em class="replaceable"><code>account-id</code></em>:*&quot;
        },
        {
            &quot;Effect&quot;: &quot;Allow&quot;,
            &quot;Action&quot;: [
                &quot;logs:CreateLogStream&quot;,
                &quot;logs:PutLogEvents&quot;
            ],
            &quot;Resource&quot;: [
                &quot;arn:aws:logs:<em class="replaceable"><code>region</code></em>:<em class="replaceable"><code>account-id</code></em>:log-group:/aws/lambda/GetStartedLambdaIntegration:*&quot;
            ]
        }
    ]
}</code></pre>
                     <p>The other policy document applies to invoking another AWS service that is not used
                        in this example. You can skip it for now. 
                     </p>
                     
                     <p> Associated with the IAM role is a trusted entity, which is <code class="literal">lambda.amazonaws.com</code>. Here is the trust relationship: 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">
{
  &quot;Version&quot;: &quot;2012-10-17&quot;,
  &quot;Statement&quot;: [
    {
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Principal&quot;: {
        &quot;Service&quot;: &quot;lambda.amazonaws.com&quot;
      },
      &quot;Action&quot;: &quot;sts:AssumeRole&quot;
    }
  ]
}
        </code></pre>
                     <p> The combination of this trust relationship and the inline policy makes it possible
                        for the Lambda function to invoke a <code class="code">console.log()</code> function to log events to
                        CloudWatch Logs. 
                     </p>
                     
                     <p>If you did not use the AWS Management Console to create the Lambda function, you need
                        to follow
                        these examples to create the required IAM role and policies and then manually attach
                        the role to your function.
                     </p>
                     
                     
                     <h2 id="getting-started-new-api">Create an API with the Lambda Custom
                        Integration
                     </h2>
                     
                     <p> With the Lambda function (<code class="code">GetStartedLambdaIntegration</code>) created and
                        tested, you are ready to expose the function through an API Gateway API. For illustration
                        purposes, we expose the Lambda function with a generic HTTP method. We use the request
                        body, a URL path variable, a query string, and a header to receive required input
                        data
                        from the client. We turn on the API Gateway request validator for the API to ensure
                        that all
                        of the required data is properly defined and specified. We configure a mapping template
                        for API Gateway to transform the client-supplied request data into the valid format
                        as
                        required by the backend Lambda function.
                     </p>
                     
                     <p>The API is named <code class="code">GetStartedLambdaIntegrationAPI</code>. 
                     </p>
                     
                     <p class="title"><b>To create an API with Lambda custom integration with a Lambda function</b></p>
                     <ol>
                        <li>
                           
                           <p>Launch the API Gateway console.</p>
                           
                        </li>
                        <li>
                           
                           <p> Choose <b>Create new API</b>.
                           </p>
                           
                           <ol>
                              <li>
                                 
                                 <p>Type <code class="code">GetStartedLambdaIntegrationAPI</code> for <b>API
                                       name</b>. 
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>Type a description of the API for <b>Description</b> or
                                    leave it blank.
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>Choose <b>Create API</b>.
                                 </p>
                                 
                              </li>
                           </ol>
                           
                        </li>
                        <li>
                           
                           <p>Choose the root resource (<code class="code">/</code>) under
                              <b>Resources</b>. From the <b>Actions</b> menu,
                              choose <b>Create Resource</b>. 
                           </p>
                           
                           <ol>
                              <li>
                                 
                                 <p>Type <code class="code">city</code> for <b>Resource Name</b>.
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>Replace <b>Resource Path</b> with <code class="code">{city}</code>.
                                    This is an example of the templated path variable used to take input
                                    from the client. Later, we show how to map this path variable into the
                                    Lambda function input using a mapping template. 
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p> Select the <b>Enable API Gateway Cors</b> option.
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p> Choose <b>Create Resource</b>.
                                 </p>
                                 
                              </li>
                           </ol>
                           
                        </li>
                        <li>
                           
                           <p> With the newly created <code class="code">/{city}</code> resource highlighted, choose
                              <b>Create Method</b> from <b>Actions</b>. 
                           </p>
                           
                           <ol>
                              <li>
                                 
                                 <p> Choose <code class="code">ANY</code> from the HTTP method drop-down menu. The
                                    <code class="code">ANY</code> HTTP verb is a placeholder for a valid HTTP method
                                    that a client submits at run time. This example shows that
                                    <code class="code">ANY</code> method can be used for Lambda custom integration as
                                    well as for Lambda proxy integration. 
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p> To save the setting, choose the check mark. </p>
                                 
                              </li>
                           </ol>
                           
                        </li>
                        <li>
                           
                           <p> In <b>Method Execution</b>, for the <code class="code">ANY /{city}</code>
                              method, do the following: 
                           </p>
                           
                           <ol>
                              <li>
                                 
                                 <p>Choose <b>Lambda Function</b> for <code class="code">Integration
                                       type</code>.
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>Leave the <b>Use Lambda Proxy integration</b> box clear
                                    to use custom Lambda custom integration.
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>Choose the region where you created the Lambda function; for example,
                                    <code class="code">us-west-2</code>.
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>Type the name of your Lambda function in <b>Lambda
                                       Function</b>; for example,
                                    <code class="code">GetStartedLambdaIntegration</code>.
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>Choose <b>Save</b>. 
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>Choose <b>OK</b> in <b>Add Permission to Lambda
                                       Function</b> to have API Gateway set up the required access
                                    permissions for the API to invoke the integrated Lambda function. 
                                 </p>
                                 
                              </li>
                           </ol>
                           
                        </li>
                        <li>
                           
                           <p> In <b>Method Execution</b>, choose <b>Method
                                 Request</b> and configure as follows: 
                           </p>
                           
                           <div class="itemizedlist">
                              
                              
                              
                              
                              <ul class="itemizedlist" type="disc">
                                 <li class="listitem">
                                    
                                    <p>A query string parameter (<code class="code">time</code>)
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>To set up a header parameter (<code class="code">day</code>) 
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>To define a payload property (<code class="code">callerName</code>)
                                    </p>
                                    
                                 </li>
                              </ul>
                           </div>
                           
                           <p> At run time, the client can use these request parameters and the request body
                              to provide time of the day, the day of the week, and the name of the caller. You
                              already configured the /{city} path variable. 
                           </p>
                           
                           <ol>
                              <li>
                                 
                                 <p> Under <b>Settings</b> choose the pencil icon to choose
                                    <code class="code">Validate body, query string parameters, and headers</code>
                                    from the <b>Request Validator</b> drop-down menu. This
                                    lets API Gateway perform basic request validation before forwarding the
                                    request to the Lambda function. 
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>Expand the <b>URL Query String Parameters</b> section.
                                    Choose <b>Add query string</b>. Type <code class="code">time</code> for
                                    <b>Name</b>. Select the <b>Required</b>
                                    option and choose the check-mark icon to save the setting. Leave
                                    <b>Caching</b> cleared to avoid an unnecessary charge
                                    for this exercise.
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>Expand the <b>HTTP Request Headers</b> section. Choose
                                    <b>Add header</b>. Type <code class="code">day</code> for
                                    <b>Name</b>. Select the <b>Required</b>
                                    option and choose the check-mark icon to save the setting. Leave
                                    <b>Caching</b> cleared to avoid an unnecessary charge
                                    for this exercise. 
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>To define the method request payload, do the following: </p>
                                 
                                 <ol>
                                    <li>
                                       
                                       <p>To define a model, choose <b>Models</b> under
                                          the API from the API Gateway primary navigation pane, and then choose
                                          <b>Create</b>. 
                                       </p>
                                       
                                    </li>
                                    <li>
                                       
                                       <p> Type <code class="code">GetStartedLambdaIntegrationUserInput</code> for
                                          <b>Model name</b>.
                                       </p>
                                       
                                    </li>
                                    <li>
                                       
                                       <p>Type <code class="code">application/json</code> for <b>Content
                                             type</b>.
                                       </p>
                                       
                                    </li>
                                    <li>
                                       
                                       <p>Type a description for <b>Model description</b>
                                          or leave it blank.
                                       </p>
                                       
                                    </li>
                                    <li>
                                       
                                       <p> Copy the following schema definition to the <b>Model
                                             schema</b> editor:
                                       </p>
                                       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">{
  &quot;$schema&quot;: &quot;http://json-schema.org/draft-04/schema#&quot;,
  &quot;title&quot;: &quot;GetStartedLambdaIntegrationInputModel&quot;,
  &quot;type&quot;: &quot;object&quot;,
  &quot;properties&quot;: {
    &quot;callerName&quot;: { &quot;type&quot;: &quot;string&quot; }
  }
}</code></pre>
                                       </li>
                                    <li>
                                       
                                       <p>Choose <b>Save</b> to finish defining the input
                                          model.
                                       </p>
                                       
                                    </li>
                                    <li>
                                       
                                       <p> Go back to <b>Method Request</b> and expand
                                          <b>Request body</b>. Choose <b>Add
                                             model</b>. Type <code class="code">application/json</code> for
                                          <b>Content type</b>. Choose
                                          <code class="code">GetStartedLambdaIntegrationInput</code> for
                                          <b>Model name</b>. Choose the check-mark icon
                                          to save the setting. 
                                       </p>
                                       
                                    </li>
                                 </ol>
                                 
                              </li>
                           </ol>
                           
                        </li>
                        <li>
                           
                           <p>In <b>Method Execution</b> for the <code class="code">ANY /{city}</code>
                              method, choose <b>Integration Request</b> to set up a body-mapping
                              template. This maps the previously configured method request parameter of
                              <code class="code">nameQuery</code> or <code class="code">nameHeader</code> to the JSON payload, as
                              required by the backend Lambda function. 
                           </p>
                           
                           <ol>
                              <li>
                                 
                                 <p>Expand the <b>Body Mapping Templates</b> section. Choose
                                    <b>Add mapping template</b>. Type
                                    <code class="code">application/json</code> for <b>Content-Type</b>.
                                    Choose the check-mark icon to save the setting. 
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>Type the following mapping template in the VTL script editor. Choose
                                    <b>Save</b> to finish the setup. 
                                 </p>
                                 
                              </li>
                           </ol>
                           
                        </li>
                        <li>
                           
                           <p>Choose <b>Integration Request</b> to set up a mapping template
                              to transform the client-supplied request data to the input format of the
                              integrated Lambda function: 
                           </p>
                           
                           <ol>
                              <li>
                                 
                                 <p>Expand the <b>Body mapping templates</b> section.
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>Check the recommended <code class="code">When there are no templates defined</code>
                                    for <b>Request body passthrough</b>.
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>Choose <b>Add mapping template</b>.
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>Type <code class="code">application/json</code> for
                                    <b>Content-type</b>.
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>Choose the check-mark icon to save the setting.</p>
                                 
                              </li>
                              <li>
                                 
                                 <p>Choose <code class="code">GetStartedLambaIntegrationUserInput</code> from
                                    <b>Generate template</b> to generate an initial
                                    mapping template. This option is available because you defined a model
                                    schema, without which you would need to write the mapping template from
                                    scratch.
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>Modify the mapping script in the mapping template editor as
                                    follows:
                                 </p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">#set($inputRoot = $input.path(&apos;$&apos;))
{
  &quot;city&quot;: &quot;$input.params(&apos;city&apos;)&quot;,
  &quot;time&quot;: &quot;$input.params(&apos;time&apos;)&quot;,
  &quot;day&quot;:  &quot;$input.params(&apos;day&apos;)&quot;,
  &quot;name&quot;: &quot;$inputRoot.callerName&quot;
}</code></pre>
                                 </li>
                           </ol>
                           
                        </li>
                     </ol>
                     
                     
                     
                     <h2 id="getting-started-new-get">Test Invoking the API Method</h2>
                     
                     <p> The API Gateway console provides a testing facility for you to test invoking the
                        API before
                        it is deployed. You use the Test feature of the console to test the API by submitting
                        the following request: 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">POST /Seattle?time=morning
day:Wednesday

{
    &quot;callerName&quot;: &quot;John&quot;
}</code></pre>
                     <p> In this test request, you set <code class="code">ANY</code> to <code class="code">POST</code>, set
                        <code class="code">{city}</code> to <code class="code">Seattle</code>, assign <code class="code">Wednesday</code> as the
                        <code class="code">day</code> header value, and assign <code class="code">&quot;John&quot;</code> as the
                        <code class="code">callerName</code> value. 
                     </p>
                     
                     <p class="title"><b>To test invoking the <code class="code">ANY /{city}</code> method</b></p>
                     <ol>
                        <li>
                           
                           <p> In <b>Method Execution</b>, choose <b>Test</b>.
                              
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Choose <code class="code">POST</code> from the <b>Method</b> drop-down
                              list.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Type <code class="code">Seattle</code> for the <code class="code">{city}</code> path variable.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Type <code class="code">morning</code> for the <code class="code">day</code> query string
                              parameter.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Type <code class="code">{ &quot;callerName&quot;:&quot;John&quot; }</code> for <b>Request
                                 Body</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Choose <b>Test</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Verify that the returned response payload is as follows:</p>
                           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">{
  &quot;greeting&quot;: &quot;Good morning, John of Seattle. Happy Wednesday!&quot;
}</code></pre>
                           </li>
                        <li>
                           
                           <p>You can also view the logs to examine how API Gateway processes the request and
                              response.
                           </p>
                           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">Execution log for request test-request
Thu Aug 31 01:07:25 UTC 2017 : Starting execution for request: test-invoke-request
Thu Aug 31 01:07:25 UTC 2017 : HTTP Method: POST, Resource Path: /Seattle
Thu Aug 31 01:07:25 UTC 2017 : Method request path: {city=Seattle}
Thu Aug 31 01:07:25 UTC 2017 : Method request query string: {time=morning}
Thu Aug 31 01:07:25 UTC 2017 : Method request headers: {day=Wednesday}
Thu Aug 31 01:07:25 UTC 2017 : Method request body before transformations: { &quot;callerName&quot;: &quot;John&quot; }
Thu Aug 31 01:07:25 UTC 2017 : Request validation succeeded for content type application/json
Thu Aug 31 01:07:25 UTC 2017 : Endpoint request URI: https://lambda.us-west-2.amazonaws.com/2015-03-31/functions/arn:aws:lambda:us-west-2:123456789012:function:GetStartedLambdaIntegration/invocations
Thu Aug 31 01:07:25 UTC 2017 : Endpoint request headers: {x-amzn-lambda-integration-tag=test-request, Authorization=****************************************************************************************************************************************************************************************************************************************************************************************************************************************338c72, X-Amz-Date=20170831T010725Z, x-amzn-apigateway-api-id=beags1mnid, X-Amz-Source-Arn=arn:aws:execute-api:us-west-2:123456789012:beags1mnid/null/POST/{city}, Accept=application/json, User-Agent=AmazonAPIGateway_beags1mnid, X-Amz-Security-Token=FQoDYXdzELL//////////wEaDMHGzEdEOT/VvGhabiK3AzgKrJw+3zLqJZG4PhOq12K6W21+QotY2rrZyOzqhLoiuRg3CAYNQ2eqgL5D54+63ey9bIdtwHGoyBdq8ecWxJK/YUnT2Rau0L9HCG5p7FC05h3IvwlFfvcidQNXeYvsKJTLXI05/yEnY3ttIAnpNYLOezD9Es8rBfyruHfJfOqextKlsC8DymCcqlGkig8qLKcZ0hWJWVwiPJiFgL7laabXs++ZhCa4hdZo4iqlG729DE4gaV1mJVdoAagIUwLMo+y4NxFDu0r7I0/EO5nYcCrppGVVBYiGk7H4T6sXuhTkbNNqVmXtV3ch5bOlh7 [TRUNCATED]
Thu Aug 31 01:07:25 UTC 2017 : Endpoint request body after transformations: {
  &quot;city&quot;: &quot;Seattle&quot;,
  &quot;time&quot;: &quot;morning&quot;,
  &quot;day&quot;: &quot;Wednesday&quot;,
  &quot;name&quot; : &quot;John&quot;
}
Thu Aug 31 01:07:25 UTC 2017 : Sending request to https://lambda.us-west-2.amazonaws.com/2015-03-31/functions/arn:aws:lambda:us-west-2:123456789012:function:GetStartedLambdaIntegration/invocations
Thu Aug 31 01:07:25 UTC 2017 : Received response. Integration latency: 328 ms
Thu Aug 31 01:07:25 UTC 2017 : Endpoint response body before transformations: {&quot;greeting&quot;:&quot;Good morning, John of Seattle. Happy Wednesday!&quot;}
Thu Aug 31 01:07:25 UTC 2017 : Endpoint response headers: {x-amzn-Remapped-Content-Length=0, x-amzn-RequestId=c0475a28-8de8-11e7-8d3f-4183da788f0f, Connection=keep-alive, Content-Length=62, Date=Thu, 31 Aug 2017 01:07:25 GMT, X-Amzn-Trace-Id=root=1-59a7614d-373151b01b0713127e646635;sampled=0, Content-Type=application/json}
Thu Aug 31 01:07:25 UTC 2017 : Method response body after transformations: {&quot;greeting&quot;:&quot;Good morning, John of Seattle. Happy Wednesday!&quot;}
Thu Aug 31 01:07:25 UTC 2017 : Method response headers: {X-Amzn-Trace-Id=sampled=0;root=1-59a7614d-373151b01b0713127e646635, Content-Type=application/json}
Thu Aug 31 01:07:25 UTC 2017 : Successfully completed execution
Thu Aug 31 01:07:25 UTC 2017 : Method completed with status: 200

</code></pre>
                           <p>The logs show the incoming request before the mapping and the integration
                              request after the mapping. When a test fails, the logs are useful for evaluating
                              whether the original input is correct or the mapping template works correctly.
                              
                           </p>
                           
                        </li>
                     </ol>
                     
                     
                     <h2 id="getting-started-deploy-api">Deploy the API</h2>
                     
                     <p> The test invocation is a simulation and has limitations. For example, it bypasses
                        any
                        authorization mechanism enacted on the API. To test the API execution in real time,
                        you
                        must deploy the API first. To deploy an API, you create a stage to create a snapshot
                        of
                        the API at that time. The stage name also defines the base path after the API&apos;s default
                        host name. The API&apos;s root resource is appended after the stage name. When you modify
                        the
                        API, you must redeploy it to a new or existing stage before the changes take effect.
                        
                     </p>
                     
                     <p class="title"><b>To deploy the API to a stage</b></p>
                     <ol>
                        <li>
                           
                           <p> Choose the API from the <b>APIs</b> pane or choose a resource
                              or method from the <b>Resources</b> pane. Choose <b>Deploy
                                 API</b> from the <b>Actions</b> drop-down menu.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>For <b>Deployment stage</b>, choose <b>New
                                 Stage</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>For <b>Stage name</b>, type a name; for example,
                              <strong class="userinput"><code>test</code></strong>.
                           </p>
                           
                           <div class="aws-note">
                              <p class="aws-note">Note</p>
                              <p>The input must be UTF-8 encoded (i.e., unlocalized) text.</p>
                           </div>
                           
                        </li>
                        <li>
                           
                           <p>For <b>Stage description</b>, type a description or leave it
                              blank. 
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>For <b>Deployment description</b>, type a description or leave
                              it blank. 
                           </p>
                           
                        </li>
                        <li>
                           
                           <p> Choose <b>Deploy</b>. After the API is successfully deployed,
                              you see the API&apos;s base URL (the default host name plus the stage name) displayed
                              as <b>Invoke URL</b> at the top of the <b>Stage
                                 Editor</b>. The general pattern of this base URL is
                              <code class="code">https://<em class="replaceable"><code>api-id</code></em>.<em class="replaceable"><code>region</code></em>.amazonaws.com/<em class="replaceable"><code>stageName</code></em></code>.
                              For example, the base URL of the API (<code class="code">beags1mnid</code>) created in the
                              <code class="code">us-west-2</code> region and deployed to the <code class="code">test</code> stage is
                              <code class="code">https://beags1mnid.execute-api.us-west-2.amazonaws.com/test</code>.
                           </p>
                           
                        </li>
                     </ol>
                     
                     
                     <h2 id="getting-started-test">Test the API in a Deployment Stage</h2>
                     
                     <p>There are several ways you can test a deployed API. For GET requests using only URL
                        path variables or query string parameters, you can type the API resource URL in a
                        browser. For other methods, you must use more advanced REST API testing utilities,
                        such
                        as <a href="https://www.getpostman.com/" target="_blank">POSTMAN</a> or <a href="https://curl.haxx.se/" target="_blank">cURL</a>.
                     </p>
                     
                     <p class="title"><b>To test the API using cURL</b></p>
                     <ol>
                        <li>
                           
                           <p>Open a terminal window on your local computer connected to the
                              internet.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>To test <code class="code">POST /Seattle?time=evening</code>:
                           </p>
                           
                           <p>Copy the following cURL command and paste it into the terminal window.</p>
                           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">curl -v -X POST \
  &apos;https://beags1mnid.execute-api.us-west-2.amazonaws.com/test/Seattle?time=evening&apos; \
  -H &apos;content-type: application/json&apos; \
  -H &apos;day: Thursday&apos; \
  -H &apos;x-amz-docs-region: us-west-2&apos; \
  -d &apos;{
	&quot;callerName&quot;: &quot;John&quot;
}&apos;</code></pre>
                           <p>You should get a successful response with the following payload:</p>
                           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">{&quot;greeting&quot;:&quot;Good evening, John of Seattle. Happy Thursday!&quot;}</code></pre>
                           <p>If you change <code class="code">POST</code> to <code class="code">PUT</code> in this method request,
                              you get the same response.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>To test <code class="code">GET /Boston?time=morning</code>:
                           </p>
                           
                           <p>Copy the following cURL command and paste it into the terminal window.</p>
                           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">curl -X GET \
  &apos;https://beags1mnid.execute-api.us-west-2.amazonaws.com/test/Boston?time=morning&apos; \
  -H &apos;content-type: application/json&apos; \
  -H &apos;day: Thursday&apos; \
  -H &apos;x-amz-docs-region: us-west-2&apos; \
  -d &apos;{
	&quot;callerName&quot;: &quot;John&quot;
}&apos;</code></pre>
                           <p>You get a <code class="code">400 Bad Request</code> response with the following error
                              message:
                           </p>
                           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">{&quot;message&quot;: &quot;Invalid request body&quot;}</code></pre>
                           <p>This is because the <code class="code">GET</code> request that you submitted cannot take a
                              payload and fails the request validation.
                           </p>
                           
                        </li>
                     </ol>
                     
                     
                     <h2 id="getting-started-clean-up">Clean Up</h2>
                     
                     <p>If you no longer need the Lambda functions you created for this walkthrough, you can
                        delete them now. You can also delete the accompanying IAM resources.
                     </p>
                     
                     <div class="aws-note">
                        <p class="aws-note">Warning</p>
                        <p>If you plan to complete the other walkthroughs in this series, do not delete the
                           Lambda execution role or the Lambda invocation role. If you delete a Lambda function
                           that your APIs rely on, those APIs will no longer work. Deleting a Lambda function
                           cannot be undone. If you want to use the Lambda function again, you must re-create
                           the function.
                        </p>
                        <p>If you delete an IAM resource that a Lambda function relies on, that Lambda
                           function will no longer work, and any APIs that rely on that function will no longer
                           work. Deleting an IAM resource cannot be undone. If you want to use the IAM
                           resource again, you must re-create the resource. 
                        </p>
                     </div>
                     
                     <p class="title"><b>To delete the Lambda functions</b></p>
                     <ol>
                        <li>
                           <p>Sign in to the AWS Management Console and open the AWS Lambda console at
                              <a href="https://console.aws.amazon.com/lambda/" target="_blank">https://console.aws.amazon.com/lambda/</a>.
                           </p>
                        </li>
                        <li>
                           
                           <p>From the list of functions, choose
                              <b>GetHelloWorld</b>, choose
                              <b>Actions</b>, and then choose <b>Delete
                                 function</b>. When prompted, choose <b>Delete</b>
                              again.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>From the list of functions, choose
                              <b>GetHelloWithName</b>, choose
                              <b>Actions</b>, and then choose <b>Delete
                                 function</b>. When prompted, choose <b>Delete</b>
                              again.
                           </p>
                           
                        </li>
                     </ol>
                     
                     <p class="title"><b>To delete the associated IAM resources</b></p>
                     <ol>
                        <li>
                           <p>Open the IAM console at
                              <a href="https://console.aws.amazon.com/iam/" target="_blank">https://console.aws.amazon.com/iam/</a>.
                           </p>
                        </li>
                        <li>
                           
                           <p>From <b>Details</b>, choose <b>Roles</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>From the list of roles, choose
                              <b>APIGatewayLambdaExecRole</b>, choose <b>Role
                                 Actions</b>, and then choose <b>Delete Role</b>. When
                              prompted, choose <b>Yes, Delete</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>From <b>Details</b>, choose
                              <b>Policies</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>From the list of policies, choose
                              <b>APIGatewayLambdaExecPolicy</b>, choose
                              <b>Policy Actions</b>, and then choose
                              <b>Delete</b>. When prompted, choose
                              <b>Delete</b>.
                           </p>
                           
                        </li>
                     </ol>
                     
                     <p>You have now reached the end of this walkthrough.</p>
                     
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be enabled. Please refer to your browser's
                                    Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="apigateway-cross-account-lambda-integrations.html">&#xAB; Previous </a><a class="awstoc" accesskey="n" href="getting-started-http-integrations.html">Next &#xBB;</a></div>
                     <div id="copyright-main-footer">&#xA9; 2018, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="Create a Lambda Function for the Lambda
                Custom Integration"><a class="pagetoc" href="#getting-started-new-lambda">Create a Lambda Function for the Lambda
                              Custom Integration</a></li>
                        <li class="pagetoc" name="Create an API with the Lambda Custom
                Integration"><a class="pagetoc" href="#getting-started-new-api">Create an API with the Lambda Custom
                              Integration</a></li>
                        <li class="pagetoc" name="Test Invoking the API Method"><a class="pagetoc" href="#getting-started-new-get">Test Invoking the API Method</a></li>
                        <li class="pagetoc" name="Deploy the API"><a class="pagetoc" href="#getting-started-deploy-api">Deploy the API</a></li>
                        <li class="pagetoc" name="Test the API in a Deployment Stage"><a class="pagetoc" href="#getting-started-test">Test the API in a Deployment Stage</a></li>
                        <li class="pagetoc" name="Clean Up"><a class="pagetoc" href="#getting-started-clean-up">Clean Up</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='Amazon API Gateway';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='Developer Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   
</body></html>