<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Build an API Gateway API with
         Cross-Account Lambda Proxy Integration - Amazon API Gateway
      </title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="home" href="#top">
      <link rel="up" href="getting-started-with-lambda-integration.html" title="Build an API Gateway API with Lambda Integration">
      <link rel="prev" href="api-gateway-create-api-as-simple-proxy-for-lambda.html" title="
                Build an API Gateway API with Lambda Proxy Integration 
            ">
      <link rel="next" href="getting-started-lambda-non-proxy-integration.html" title="Build an API Gateway API with
            Custom Lambda Integration">
      <meta name="description" content="Learn how to build and test an API with cross-account Lambda proxy integration using the API Gateway console.">
      <meta name="deployment_region" content="IAD">
      <meta name="product" content="Amazon API Gateway">
      <meta name="guide" content="Developer Guide">
      <meta name="guide-locale" content="en_us">
      <link rel="icon" type="image/ico" href="/images/favicon.ico">
      <link rel="shortcut icon" type="image/ico" href="/images/favicon.ico">
      <link rel="canonical" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-cross-account-lambda-integrations.html">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/font-awesome.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/google-font.css">
      <link id="code-style" rel="stylesheet" type="text/css" href="../../../css/light.css">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.theme.css">
      <link rel="stylesheet" type="text/css" href="../../../css/colorbox.css">
      <link rel="stylesheet" type="text/css" href="../../../css/awsdocs.css"><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="/js/jquery-ui.min.js"></script><script type="text/javascript" src="/js/handlebars.js"></script><script type="text/javascript" src="/js/jquery.colorbox.js"></script><script type="text/javascript" src="/js/awsdocs.min.js?v=20170615"></script></head>
   <body id="top">
      
      <div id="content-container">
         
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tbody><tr>
                           <td>
                              <div class="breadcrumb"><a href="http://aws.amazon.com/documentation">AWS Documentation</a> &#xBB; <a href="http://aws.amazon.com/documentation/apigateway">Amazon API Gateway</a> &#xBB; <a href="index.html">Developer Guide</a> &#xBB; <a href="getting-started.html">Getting Started with Amazon API Gateway</a> &#xBB; <a href="getting-started-with-lambda-integration.html">Build an API Gateway API with Lambda Integration</a> &#xBB; <span class="breadcrumb">Build an API Gateway API with
                                    Cross-Account Lambda Proxy Integration</span></div>
                           </td>
                        </tr>
                     </tbody></table>
                     <div></div>
                     <h1 class="topictitle" id="apigateway-cross-account-lambda-integrations">Build an API Gateway API with
                        Cross-Account Lambda Proxy Integration
                     </h1>
                     <p>You can now use an AWS Lambda function from a different AWS account as your API
                        integration backend. Each account can be in any region where Amazon API Gateway is
                        available. This
                        makes it easy to centrally manage and share Lambda backend functions across multiple
                        APIs.
                     </p>
                     <p>In this section, we show how to configure cross-account Lambda proxy integration using
                        the
                        Amazon API Gateway console.
                     </p>
                     <p>First, we create the example API from <a href="api-gateway-create-api-from-example.html">Build an API Gateway API from an Example</a> in one account. We then create a Lambda function in another account. Finally, we
                        use
                        cross-account Lambda integration to allow the example API to use the Lambda function
                        we
                        created in the second account.
                     </p>
                     
                     <h2 id="apigateway-cross-account-lambda-integrations-create-api">Create API for
                        API Gateway Cross-Account Lambda Integration
                     </h2>
                     
                     
                     <p>First, you&apos;ll create the example API as described in <a href="api-gateway-create-api-from-example.html">Build an API Gateway API from an Example</a>.
                     </p>
                     
                     
                     <p class="title"><b>To create the example API</b></p>
                     <ol>
                        <li>
                           
                           <p> Sign in to the API Gateway console. </p>
                           
                        </li>
                        <li>
                           
                           <p>Choose <b>Create API</b> from the API Gateway
                              <b>APIs</b> home page: 
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Under <b>Create new API</b>, choose <b>Examples
                                 API</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>For <b>Endpoint Type</b>, choose <b>Edge
                                 optimized</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Choose <b>Import</b> to create the example API.
                           </p>
                           
                        </li>
                     </ol>
                     
                     
                     <h2 id="apigateway-cross-account-lambda-integrations-create-lambda-function">Create Lambda Integration Function in Another Account</h2>
                     
                     <p>Now you&apos;ll create a Lambda function in a different account from the one in which you
                        created the example API.
                     </p>
                     
                     <p class="title"><b>Creating a Lambda function in another account</b></p>
                     <ol>
                        <li>
                           
                           <p>Log in to the Lambda console in a different account from the one where you
                              created your API Gateway API.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Choose <b>Create function</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Choose <b>Author from scratch</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Under <b>Author from scratch</b>, do the following:
                           </p>
                           
                           <ol>
                              <li>
                                 
                                 <p>In the <b>Name</b> input field, type a function
                                    name.
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>From the <b>Runtime</b> drop-down list, choose a
                                    supported runtime. In this example, we use <b>Node.js
                                       6.10</b>.
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p> From the <b>Role</b> drop-down list, choose
                                    <b>Choose an existing role</b>, <b>Create new
                                       role from template(s)</b> or <b>Create a custom
                                       role</b>. Then, follow the ensuing instructions for the
                                    choice.
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>Choose <b>Create function</b> to continue.
                                 </p>
                                 
                                 <p>For this example, we will skip the <b>Designer</b>
                                    section and move to the <b>Function code</b> section
                                    next.
                                 </p>
                                 
                              </li>
                           </ol>
                           
                        </li>
                        <li>
                           
                           <p>Scroll down to the <b>Function code</b> pane.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Copy-paste a function implentation such as one of the API Gateway examples for <a href="api-gateway-create-api-as-simple-proxy-for-lambda.html#api-gateway-proxy-integration-lambda-function-nodejs">Node.js</a> and <a href="api-gateway-create-api-as-simple-proxy-for-lambda.html#api-gateway-proxy-integration-lambda-function-java">Java</a>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Choose the correct runtime from the <b>Runtime</b> drop-down
                              menu.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Choose <b>Save</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Note the full ARN for your function (in the upper right corner of the Lambda
                              function pane). You&apos;ll need it when you create your cross-account Lambda
                              integration.
                           </p>
                           
                        </li>
                     </ol>
                     
                     
                     <h2 id="apigateway-cross-account-lambda-integrations-create-integration2">Configure Cross-Account Lambda Integration</h2>
                     
                     <p>Once you have a Lambda integration function in a different account, you can use the
                        the
                        API Gateway console to add it to your API in your first account.
                     </p>
                     
                     <p class="title"><b>Configuring your cross-account Lambda integration</b></p>
                     <ol>
                        <li>
                           
                           <p>In the API Gateway console, choose your API.</p>
                           
                        </li>
                        <li>
                           
                           <p>Choose <b>Resources</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>In the <b>Resources</b> pane, choose the top-level
                              <code class="code">GET</code> method. 
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>In the <b>Method Execution</b> pane, choose
                              <b>Integration Request</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>For <b>Integration type</b>, choose <b>Lambda
                                 Function</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Check <b>Use Lambda Proxy integration</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Leave <b>Lambda Region</b> set to your account&apos;s region.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>For <b>Lambda Function</b>, copy/paste the full ARN for the Lambda
                              function you created in your second account and choose the checkmark.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>You&apos;ll see a popup that says <b>Add Permission to Lambda Function: You
                                 have selected a Lambda function from another account. Please ensure that you
                                 have the appropriate Function Policy on this function. You can do this by
                                 running the following AWS CLI command from account
                                 <em class="replaceable"><code>123456789012</code></em>:</b>, followed by an
                              <code class="code">aws lambda add-permission</code> command string.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Copy-paste the <code class="code">aws lambda add-permission</code> command string into an
                              AWS CLI window that is configured for your second account. This will grant your
                              first account access to your second account&apos;s Lambda function.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>In the popup from the previous step in the Lambda console, choose
                              <b>OK</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>To see the updated policy for your function in the Lambda console, </p>
                           
                           <ol>
                              <li>
                                 
                                 <p>Choose your integration function.</p>
                                 
                              </li>
                              <li>
                                 
                                 <p>In the <b>Designer</b> pane, choose the key icon.
                                 </p>
                                 
                              </li>
                           </ol>
                           
                           <p>In the <b>Function policy</b> pane, you should now see an
                              <code class="code">Allow</code> policy with a <code class="code">Condition</code> clause in which the
                              in the <code class="code">AWS:SourceArn</code> is the ARN for your API&apos;s <code class="code">GET</code>
                              method.
                           </p>
                           
                        </li>
                     </ol>
                     
                     
                     
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be enabled. Please refer to your browser's
                                    Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="api-gateway-create-api-as-simple-proxy-for-lambda.html">&#xAB; Previous </a><a class="awstoc" accesskey="n" href="getting-started-lambda-non-proxy-integration.html">Next &#xBB;</a></div>
                     <div id="copyright-main-footer">&#xA9; 2018, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="Create API for
                API Gateway Cross-Account Lambda Integration"><a class="pagetoc" href="#apigateway-cross-account-lambda-integrations-create-api">Create API for Cross-Account Lambda Integration</a></li>
                        <li class="pagetoc" name="Create Lambda Integration Function in Another Account"><a class="pagetoc" href="#apigateway-cross-account-lambda-integrations-create-lambda-function">Create Lambda Integration Function in Another Account</a></li>
                        <li class="pagetoc" name="Configure Cross-Account Lambda Integration"><a class="pagetoc" href="#apigateway-cross-account-lambda-integrations-create-integration2">Configure Cross-Account Lambda Integration</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='Amazon API Gateway';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='Developer Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   
</body></html>