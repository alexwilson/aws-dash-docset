<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Set up a Method Request in
         API Gateway - Amazon API Gateway
      </title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="home" href="#top">
      <link rel="up" href="how-to-method-settings.html" title="Set up API Methods in API Gateway ">
      <link rel="prev" href="how-to-method-settings.html" title="Set up API Methods in API Gateway ">
      <link rel="next" href="api-gateway-method-settings-method-response.html" title="Set up Method Responses in
                API Gateway">
      <meta name="description" content="Setting up a method request involves performing the following tasks, after creating a RestApi resource:">
      <meta name="deployment_region" content="IAD">
      <meta name="product" content="Amazon API Gateway">
      <meta name="guide" content="Developer Guide">
      <meta name="guide-locale" content="en_us">
      <link rel="icon" type="image/ico" href="/images/favicon.ico">
      <link rel="shortcut icon" type="image/ico" href="/images/favicon.ico">
      <link rel="canonical" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-method-settings-method-request.html">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/font-awesome.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/google-font.css">
      <link id="code-style" rel="stylesheet" type="text/css" href="../../../css/light.css">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.theme.css">
      <link rel="stylesheet" type="text/css" href="../../../css/colorbox.css">
      <link rel="stylesheet" type="text/css" href="../../../css/awsdocs.css"><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="/js/jquery-ui.min.js"></script><script type="text/javascript" src="/js/handlebars.js"></script><script type="text/javascript" src="/js/jquery.colorbox.js"></script><script type="text/javascript" src="/js/awsdocs.min.js?v=20170615"></script></head>
   <body id="top">
      
      <div id="content-container">
         
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tbody><tr>
                           <td>
                              <div class="breadcrumb"><a href="http://aws.amazon.com/documentation">AWS Documentation</a> &#xBB; <a href="http://aws.amazon.com/documentation/apigateway">Amazon API Gateway</a> &#xBB; <a href="index.html">Developer Guide</a> &#xBB; <a href="how-to-create-api.html">Creating an API in Amazon API Gateway</a> &#xBB; <a href="how-to-method-settings.html">Set up API Methods in API Gateway </a> &#xBB; <span class="breadcrumb">Set up a Method Request in
                                    API Gateway</span></div>
                           </td>
                        </tr>
                     </tbody></table>
                     <div></div>
                     <h1 class="topictitle" id="api-gateway-method-settings-method-request">Set up a Method Request in
                        API Gateway
                     </h1>
                     <p>Setting up a method request involves performing the following tasks, after creating
                        a
                        <a href="./apigateway/api-reference/resource/rest-api/" target="_blank">RestApi</a> resource:
                     </p>
                     <div class="orderedlist">
                        
                        
                        
                        <ol>
                           <li>
                              
                              <p> Creating a new API or choosing an existing API <a href="./apigateway/api-reference/resource/resource/" target="_blank">Resource</a> entity. 
                              </p>
                              
                           </li>
                           <li>
                              
                              <p> Creating an API <a href="./apigateway/api-reference/resource/method/" target="_blank">Method</a>
                                 resource that is a specific HTTP verb on the new or chosen API
                                 <code class="code">Resource</code>. This task can be further divided into the following
                                 sub tasks:
                              </p>
                              
                              <div class="itemizedlist">
                                 
                                 
                                 
                                 
                                 
                                 
                                 <ul class="itemizedlist" type="disc">
                                    <li class="listitem">
                                       
                                       <p> Adding an HTTP method to the method request</p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p> Configuring request parameters</p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p> Defining a model for the request body</p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p> Enacting an authorization scheme</p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p> Enabling request validation </p>
                                       
                                    </li>
                                 </ul>
                              </div>
                              
                           </li>
                        </ol>
                     </div>
                     <p>You can perform these tasks using the following methods: </p>
                     <div class="itemizedlist">
                        
                        
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p>
                                 <a href="how-to-set-up-method-using-console.html#how-to-method-settings-callers-console">API Gateway
                                    console</a></p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p> AWS CLI commands (<a href="./cli/latest/reference/apigateway/create-resource.html" target="_blank">create-resource</a> and <a href="./cli/latest/reference/apigateway/put-method.html" target="_blank">put-method</a>)
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p> AWS SDK functions (for example, in Node.js, <a href="./AWSJavaScriptSDK/latest/AWS/APIGateway.html#createResource-property" target="_blank">createResource</a> and <a href="./AWSJavaScriptSDK/latest/AWS/APIGateway.html#putMethod-property" target="_blank">putMethod</a>)
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p> API Gateway REST API (<a href="./apigateway/api-reference/link-relation/resource-create/" target="_blank">resource:create</a> and <a href="./apigateway/api-reference/link-relation/method-put/" target="_blank">method:put</a>).
                              </p>
                              
                           </li>
                        </ul>
                     </div>
                     <p>For examples of using these tools, see <a href="create-api-resources-methods.html"> Initialize API Setup in API Gateway </a>.
                     </p>
                     <div class="highlights" id="inline-topiclist">
                        <p><strong>Topics</strong></p>
                        <ul>
                           <li><a href="#setup-method-resources">Set up API Resources</a></li>
                           <li><a href="#setup-method-add-http-method">Set up an HTTP Method</a></li>
                           <li><a href="#setup-method-request-parameters">Set up Method Request Parameters</a></li>
                           <li><a href="#setup-method-request-model">Set up Method Request Model</a></li>
                           <li><a href="#setup-method-request-authorization">Set up Method Request
                                 Authorization</a></li>
                           <li><a href="#setup-method-request-validation">Set up Method Request Validation</a></li>
                        </ul>
                     </div>
                     
                     <h2 id="setup-method-resources">Set up API Resources</h2>
                     
                     <p>In an API Gateway API, you expose addressable resources as a tree of API <a href="./apigateway/api-reference/resource/resources/" target="_blank">Resources</a> entities, with the root
                        resource (<code class="code">/</code>) at the top of the hierarchy. The root resource is relative
                        to the API&apos;s base URL, which consists of the API endpoint and a stage name. In the
                        API Gateway console, this base URI is referred to as the <b>Invoke URI</b>
                        and is displayed in the API&apos;s stage editor after the API is deployed. 
                     </p>
                     
                     <p>The API endpoint can be a default host name or a custom domain name. The default
                        host name is of the following format:
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight"><em class="replaceable"><code>{api-id}</code></em>.execute-api.<em class="replaceable"><code>{region}</code></em>.amazonaws.com</code></pre>
                     <p>In this format, the <em class="replaceable"><code>{api-id}</code></em> represents the API
                        identifier that is generated by API Gateway. The
                        <code class="code"><em class="replaceable"><code>{region}</code></em></code> variable represents the AWS
                        Region (for example, <code class="code">us-east-1</code>) that you chose when creating the API. A
                        custom domain name is any user-friendly name under a valid internet domain. For
                        example, if you have registered an internet domain of <code class="code">example.com</code>, any
                        of <code class="code">*.example.com</code> is a valid custom domain name. For more information,
                        see <a href="how-to-custom-domains.html">create a custom domain name</a>. 
                     </p>
                     
                     
                     <p>For the <a href="api-gateway-create-api-from-example.html">PetStore sample
                           API</a>, the root resource (<code class="code">/</code>) exposes the pet store. The
                        <code class="code">/pets</code> resource represents the collection of pets available in the
                        pet store. The <code class="code">/pets/{petId}</code> exposes an individual pet of a given
                        identifier (<code class="code">petId</code>). The path parameter of <code class="code">{petId}</code> is part
                        of the request parameters. 
                     </p>
                     
                     <p>To set up an API resource, you choose an existing resource as its parent and then
                        create the child resource under this parent resource. You start with the root
                        resource as a parent, add a resource to this parent, add another resource to this
                        child resource as the new parent, and so on, to its parent identifier. Then you add
                        the named resource to the parent. 
                     </p>
                     
                     <p>With AWS CLI, you can call the <code class="code">get-resources</code> command to find out which
                        resources of an API are available:
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">aws apigateway get-resources --rest-api-id <em class="replaceable"><code>&lt;apiId&gt;</code></em> \
                             --region <em class="replaceable"><code>&lt;region&gt;</code></em></code></pre>
                     <p>The result is a list of the currently available resources of the API. For our
                        PetStore sample API, this list looks like following:
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">{
    &quot;items&quot;: [
        {
            &quot;path&quot;: &quot;/pets&quot;, 
            &quot;resourceMethods&quot;: {
                &quot;GET&quot;: {}
            }, 
            &quot;id&quot;: &quot;6sxz2j&quot;, 
            &quot;pathPart&quot;: &quot;pets&quot;, 
            &quot;parentId&quot;: &quot;svzr2028x8&quot;
        }, 
        {
            &quot;path&quot;: &quot;/pets/{petId}&quot;, 
            &quot;resourceMethods&quot;: {
                &quot;GET&quot;: {}
            }, 
            &quot;id&quot;: &quot;rjkmth&quot;, 
            &quot;pathPart&quot;: &quot;{petId}&quot;, 
            &quot;parentId&quot;: &quot;6sxz2j&quot;
        }, 
        {
            &quot;path&quot;: &quot;/&quot;, 
            &quot;id&quot;: &quot;svzr2028x8&quot;
        }
    ]
}</code></pre>
                     <p>Each item lists the identifiers of the resource (<code class="code">id</code>) and, except for
                        the root resource, its immediate parent (<code class="code">parentId</code>), as well as the
                        resource name (<code class="code">pathPart</code>). The root resource is special in that it does
                        not have any parent. After choosing a resource as the parent, call the following
                        command to add a child resource. 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">aws apigateway create-resource --rest-api-id <em class="replaceable"><code>&lt;apiId&gt;</code></em> \
                             --region <em class="replaceable"><code>&lt;region&gt;</code></em> \
                             --parent-id <em class="replaceable"><code>&lt;parentId&gt;</code></em> \
                             --path-part <em class="replaceable"><code>&lt;resourceName&gt;</code></em></code></pre>
                     <p>For example, to add pet food for sale on the PetStore website, add a
                        <code class="code">food</code> resource to the root (/) by setting <code class="code">path-part</code> to
                        <code class="code">food</code> and <code class="code">parent-id</code> to <code class="code">svzr2028x8</code>. The
                        result looks like the following:
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">{
    &quot;path&quot;: &quot;/food&quot;, 
    &quot;pathPart&quot;: &quot;food&quot;, 
    &quot;id&quot;: &quot;xdsvhp&quot;, 
    &quot;parentId&quot;: &quot;svzr2028x8&quot;
}</code></pre>
                     
                     <h3 id="api-gateway-proxy-resource">Use a Proxy Resource to Streamline
                        API Setup
                     </h3>
                     
                     <p>As business grows, the PetStore owner may decide to add food, toys, and other
                        pet-related items for sale. To support this, you can add <code class="code">/food</code>,
                        <code class="code">/toys</code>, and other resources under the root resource. Under each
                        sale category, you may also want to add more resources, such as
                        <code class="code">/food/{type}/{item}</code>, <code class="code">/toys/{type}/{item}</code>, etc.
                        This can get tedious. If you decide to add a middle layer <code class="code">{subtype}</code>
                        to the resource paths to change the path hierarchy into
                        <code class="code">/food/{type]/{subtype}/{item}</code>,
                        <code class="code">/toys/{type}/{subtype}/{item}</code>, etc., the changes will break the
                        existing API set up. To avoid this, you can use an API Gateway <a href="api-gateway-set-up-simple-proxy.html">proxy resource</a> to expose a
                        set of API resources all at once.
                     </p>                
                     
                     <p>API Gateway defines a proxy resource as a placeholder for a resource to be specified
                        when the request is submitted. A proxy resource is expressed by a special path
                        parameter of <code class="code">{proxy+}</code>, often referred to as a greedy path
                        parameter. The <code class="code">+</code> sign indicates whichever child resources are
                        appended to it. The <code class="code">/parent/{proxy+}</code> placeholder stands for any
                        resource matching the path pattern of <code class="code">/parent/*</code>. The greedy path
                        parameter name, <code class="code">proxy</code>, can be replaced by another string in the
                        same way you treat a regular path parameter name. 
                     </p>
                     
                     <p>Using the AWS CLI, you call the following command to set up a proxy resource
                        under the root (<code class="code">/{proxy+}</code>):
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">aws apigateway create-resource --rest-api-id <em class="replaceable"><code>&lt;apiId&gt;</code></em> \
                             --region <em class="replaceable"><code>&lt;region&gt;</code></em> \
                             --parent-id <em class="replaceable"><code>&lt;rootResourceId&gt;</code></em> \
                             --path-part {proxy+}</code></pre>
                     <p>The result is similar to the following:</p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">{
    &quot;path&quot;: &quot;/{proxy+}&quot;, 
    &quot;pathPart&quot;: &quot;{proxy+}&quot;, 
    &quot;id&quot;: &quot;234jdr&quot;, 
    &quot;parentId&quot;: &quot;svzr2028x8&quot;
}</code></pre>
                     <p>For the <code class="code">PetStore</code> API example, you can use <code class="code">/{proxy+}</code>
                        to represent both the <code class="code">/pets</code> and <code class="code">/pets/{petId}</code>. This
                        proxy resource can also reference any other (existing or to-be-added) resources,
                        such as <code class="code">/food/{type}/{item}</code>, <code class="code">/toys/{type}/{item}</code>,
                        etc., or <code class="code">/food/{type]/{subtype}/{item}</code>,
                        <code class="code">/toys/{type}/{subtype}/{item}</code>, etc. The backend developer
                        determines the resource hierarchy and the client developer is responsible for
                        understanding it. API Gateway simply passes whatever the client submitted to the
                        backend. 
                     </p>
                     
                     <p>An API can have more than one proxy resource. For example, the following proxy
                        resources are allowed within an API.
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">/{proxy+}
/parent/{proxy+}
/parent/{child}/{proxy+}</code></pre>
                     <p>When a proxy resource has non-proxy siblings, the sibling resources are
                        excluded from the representation of the proxy resource. For the preceding
                        examples, <code class="code">/{proxy+}</code> refers to any resources under the root resource
                        except for the <code class="code">/parent[/*]</code> resources. In other words, a method
                        request against a specific resource takes precedence over a method
                        request against a generic resource at the same level of the resource
                        hierarchy.
                     </p>
                     
                     <p>A proxy resource cannot have any child resource. Any API resource after
                        <code class="code">{proxy+}</code> is redundant and ambiguous. The following proxy
                        resources are not allowed within an API.
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">/{proxy+}/child
/parent/{proxy+}/{child}
/parent/{child}/{proxy+}/{grandchild+}</code></pre>
                     
                     
                     <h2 id="setup-method-add-http-method">Set up an HTTP Method</h2>
                     
                     <p>An API method request is encapsulated by the API Gateway <a href="./apigateway/api-reference/resource/method/" target="_blank">Method</a> resource. To set up the
                        method request, you must first instantiate the <code class="code">Method</code> resource, setting
                        at least an HTTP method and an authorization type on the method. 
                     </p>
                     
                     <p>Closely associated with the proxy resource, API Gateway supports an HTTP method of
                        <code class="code">ANY</code>. This <code class="code">ANY</code> method represents any HTTP method that
                        is to be supplied at run time. It allows you to use a single API method setup for
                        all of the supported HTTP methods of <code class="code">DELETE</code>, <code class="code">GET</code>,
                        <code class="code">HEAD</code>, <code class="code">OPTIONS</code>, <code class="code">PATCH</code>, <code class="code">POST</code>,
                        and <code class="code">PUT</code>. 
                     </p>
                     
                     <p>You can set up the <code class="code">ANY</code> method on a non-proxy resource as well.
                        Combining the <code class="code">ANY</code> method with a proxy resource, you get a single API
                        method setup for all of the supported HTTP methods against any resources of an API.
                        Furthermore, the backend can evolve without breaking the existing API setup. 
                     </p>
                     
                     <p> Before setting up an API method, consider who can call the method. Set the
                        authorization type according to your plan. For open access, set it to
                        <code class="code">NONE</code>. To use IAM permissions, set the authorization type to
                        <code class="code">AWS_IAM</code>. To use a Lambda function-based Lambda authorizer, set this
                        property to <code class="code">CUSTOM</code>. To leverage an Amazon Cognito user pool set the
                        authorization type to <code class="code">COGNITO_USER_POOLS</code>. 
                     </p>
                     
                     <p>The following AWS CLI command shows how to create a method request of the
                        <code class="code">ANY</code> verb against a specified resource (<code class="code">6sxz2j</code>), using
                        the IAM permissions to control its access. 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">aws apigateway put-method --rest-api-id vaz7da96z6 \
       --resource-id 6sxz2j \
       --http-method ANY \
       --authorization-type AWS_IAM \
       --region us-west-2</code></pre>
                     <p>To create an API method request with a different authorization type,  see <a href="api-gateway-method-settings-method-request.html#setup-method-request-authorization">Set up Method Request
                           Authorization</a>.
                     </p>
                     
                     
                     <h2 id="setup-method-request-parameters">Set up Method Request Parameters</h2>
                     
                     <p>Method request parameters are a way for a client to provide input data or
                        execution context necessary to complete the method request. A method parameter can
                        be a path parameter, a header, or a query string parameter. As part of method
                        request setup, you must declare required request parameters to make them available
                        for the client. For non-proxy integration, you can translate these request
                        parameters to a form that is compatible with the backend requirement. 
                     </p>
                     
                     <p>For example, for the <code class="code">GET /pets/{petId}</code> method request, the
                        <code class="code">{petId}</code> path variable is a required request parameter. You can
                        declare this path parameter when calling the <code class="code">put-method</code> command of the
                        AWS CLI. This is illustrated as follows:
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">aws apigateway put-method --rest-api-id vaz7da96z6 \
       --resource-id rjkmth \
       --http-method GET \
       --authorization-type &quot;NONE&quot; \
       --region us-west-2 \
       --request-parameters method.request.path.petId=true</code></pre>
                     <p>If a parameter is not required, you can set it to <code class="code">false</code> in
                        <code class="code">request-parameters</code>. For example, if the <code class="code">GET /pets</code>
                        method uses an optional query string parameter of <code class="code">type</code>, and an optional
                        header parameter of <code class="code">breed</code>, you can declare them using the following CLI
                        command, assuming that the <code class="code">/pets</code> resource <code class="code">id</code> is
                        <code class="code">6sxz2j</code>:
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">aws apigateway put-method --rest-api-id vaz7da96z6 \
       --resource-id 6sxz2j \
       --http-method GET \
       --authorization-type &quot;NONE&quot; \
       --region us-west-2 \
       --request-parameters method.request.querystring.type=false,method.request.header.breed=false</code></pre>
                     <p>Instead of this abbreviated form, you can use a JSON string to set the
                        <code class="code">request-parameters</code> value:
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">&apos;{&quot;method.request.querystring.type&quot;:false,&quot;method.request-header.breed&quot;:false}&apos;</code></pre>
                     <p>With this setup, the client can query pets by type: </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">GET /pets?type=dog</code></pre>
                     <p> And the client can query dogs of the poodle breed as follows:</p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">GET /pets?type=dog
breed:poodle</code></pre>
                     <p>For information on how to map method request parameters to integration request
                        parameters, see <a href="how-to-integration-settings.html">Set up API Integrations in API Gateway</a>.
                     </p>
                     
                     
                     
                     <h2 id="setup-method-request-model">Set up Method Request Model</h2>
                     
                     <p>For an API method that can take input data in a payload, you can use a model. A
                        model is expressed in a <a href="https://tools.ietf.org/html/draft-zyp-json-schema-04" target="_blank">JSON schema draft 4</a> and
                        describes the data structure of the request body. With a model, a client can
                        determine how to construct a method request payload as input. More importantly,
                        API Gateway uses the model to <a href="api-gateway-method-request-validation.html">validate a request</a>, <a href="how-to-generate-sdk.html">generate an
                           SDK</a>, and initialize a mapping template for setting up the integration in
                        the API Gateway console. For information about how to create a <a href="./apigateway/api-reference/resource/model/" target="_blank">model</a>, see <a href="models-mappings.html">Models and Mapping Templates</a>. 
                     </p>
                     
                     <p>Depending on the content types, a method payload can have different formats. A
                        model is indexed against the media type of the applied payload. To set up method
                        request models, add key-value pairs of the
                        <code class="code">&quot;<em class="replaceable"><code>&lt;media-type&gt;</code></em>&quot;:&quot;<em class="replaceable"><code>&lt;model-name&gt;</code></em>&quot;</code>
                        format to the <code class="code">requestModels</code> map when calling the AWS CLI
                        <code class="code">put-method</code> command. 
                     </p>
                     
                     <p>For example, to set a model on the JSON payload of the <code class="code">POST /pets</code>
                        method request of the PetStore example API, you can call the following AWS CLI
                        command:
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">aws apigateway put-method \
       --rest-api-id vaz7da96z6 \
       --resource-id 6sxz2j \
       --http-method POST \
       --authorization-type &quot;NONE&quot; \
       --region us-west-2 \
       --request-models &apos;{&quot;application/json&quot;:&quot;petModel&quot;}&apos;</code></pre>
                     <p>Here, <code class="code">petModel</code> is the <code class="code">name</code> property value of a <a href="./apigateway/api-reference/resource/model/" target="_blank"><code class="code">Model</code></a> resource
                        describing a pet. The actual schema definition is expressed as a JSON string value
                        of the <a href="./apigateway/api-reference/resource/model/#schema" target="_blank"><code class="code">schema</code></a>
                        property of the <code class="code">Model</code> resource. 
                     </p>
                     
                     <p> In a Java, or other strongly typed SDK, of the API, the input data is cast as the
                        <code class="code">petModel</code> class derived from the schema definition. With the request
                        model, the input data in the generated SDK is cast into the <code class="code">Empty</code>
                        class, which is derived from the default <code class="code">Empty</code> model. In this case, the
                        client cannot instantiate the correct data class to provide the required input. 
                     </p>
                     
                     
                     
                     <h2 id="setup-method-request-authorization">Set up Method Request
                        Authorization
                     </h2>
                     
                     
                     <p> To control who can call the API method, you can configure the <a href="./apigateway/api-reference/resource/method/#authorizationType" target="_blank">authorization type</a>
                        on the method. You can use this type to enact one of the supported authorizers,
                        including IAM roles and policies (<code class="code">AWS_IAM</code>, an Amazon Cognito user pool
                        (<code class="code">COGNITO_USER_POOLS</code>), or a Lambda function-based Lambda authorizer
                        (<code class="code">CUSTOM</code>). The API Gateway console sets <code class="code">NONE</code> for open access
                        as the default. 
                     </p>
                     
                     <p>To use IAM permissions to authorize access to the API method, set the
                        <code class="code">authorization-type</code> input property to <code class="code">AWS_IAM</code>. When
                        this option is set, API Gateway verifies the caller &apos;s signature on the request, based
                        on
                        the caller&apos;s IAM user&apos;s access key identifier and secret key. If the verified user
                        has permission to call the method, the request is accepted. Otherwise, the request
                        is rejected and the caller receives an unauthorized error response. The call to the
                        method does not succeed unless the caller has been granted permission to invoke the
                        API method or if the caller is allowed to assume a role that has been granted the
                        permission. The caller has permissions to call this and any other API methods
                        created by anyone of the same AWS account if the caller has the following IAM
                        policy attached to his or her IAM user: 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">{
    &quot;Version&quot;: &quot;2012-10-17&quot;,
    &quot;Statement&quot;: [
        {
            &quot;Effect&quot;: &quot;Allow&quot;,
            &quot;Action&quot;: [
                &quot;execute-api:Invoke&quot;
            ],
            &quot;Resource&quot;: &quot;arn:aws:execute-api:*:*:*&quot;
        }
    ]
}</code></pre>
                     <p>For more information, see <a href="permissions.html">Control Access to an API with IAM Permissions</a>.
                     </p>
                     
                     <p> At present, such a policy can be granted to only the IAM users of the API
                        owner&apos;s account. Users from a different AWS account can call the API methods if
                        they are allowed to assume a role of the API owner account and the assumed role has
                        the proper permissions for the <code class="code">execute-api:Invoke</code> action. For
                        information on cross-account permissions, see <a href="./IAM/latest/UserGuide/id_roles_use.html" target="_blank">Using
                           IAM Roles</a>. 
                     </p>
                     
                     
                     <p>You can use AWS CLI, an AWS SDK, or a REST API client, such as <a href="https://www.getpostman.com/" target="_blank">Postman</a>, which implements <a href="./general/latest/gr/signature-version-4.html" target="_blank">Signature Version 4 Signing</a>. 
                     </p>
                     
                     <p>To use a Lambda authorizer to authorize access to the API method, set the
                        <code class="code">authorization-type</code> input property to <code class="code">CUSTOM</code> and set
                        the <a href="./apigateway/api-reference/resource/method/#authorizerId" target="_blank"><code class="code">authorizer-id</code></a> input property to the <a href="./apigateway/api-reference/resource/authorizer/#id" target="_blank"><code class="code">id</code></a> property
                        value of a Lambda authorizer that already exists. The referenced Lambda authorizer
                        can be of the <code class="code">TOKEN</code> or <code class="code">REQUEST</code> type. For information about
                        creating a Lambda authorizer, see <a href="apigateway-use-lambda-authorizer.html">Use API Gateway Lambda Authorizers</a>.
                     </p>
                     
                     <p>To use an Amazon Cognito user pool to authorize access to the API method, set the
                        <code class="code">authorization-type</code> input property to
                        <code class="code">COGNITO_USER_POOLS</code> and set the <a href="./apigateway/api-reference/resource/method/#authorizerId" target="_blank"><code class="code">authorizer-id</code></a> input property to the <a href="./apigateway/api-reference/resource/authorizer/#id" target="_blank"><code class="code">id</code></a> property
                        value of the <code class="code">COGNITO_USER_POOLS</code> authorizer that was already created.
                        For information about creating an Amazon Cognito user pool authorizer, see <a href="apigateway-integrate-with-cognito.html">Use Amazon Cognito User Pools</a>.
                     </p>
                     
                     
                     <h2 id="setup-method-request-validation">Set up Method Request Validation</h2>
                     
                     <p>You can enable request validation when setting up an API method request. You need
                        to first to create a <a href="./apigateway/api-reference/resource/request-validator/" target="_blank">request
                           validator</a>:
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">aws apigateway create-request-validator \
    --rest-api-id 7zw9uyk9kl \
    --name bodyOnlyValidator \
    --validate-request-body  \
    --no-validate-request-parameters
</code></pre>
                     <p>This CLI command creates a body-only request validator. Example output is as
                        follows:
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">{
    &quot;validateRequestParameters&quot;: true, 
    &quot;validateRequestBody&quot;: true, 
    &quot;id&quot;: &quot;jgpyy6&quot;, 
    &quot;name&quot;: &quot;bodyOnlyValidator&quot;
}</code></pre>
                     <p>With this request validator, you can enable request validation as part of the
                        method request setup: 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">aws apigateway put-method \
    --rest-api-id 7zw9uyk9kl 
    --region us-west-2 
    --resource-id xdsvhp 
    --http-method PUT 
    --authorization-type &quot;NONE&quot; 
    --request-parameters &apos;{&quot;method.request.querystring.type&quot;: false, &quot;method.request.querystring.page&quot;:false}&apos; 
    --request-models &apos;{&quot;application/json&quot;:&quot;petModel&quot;}&apos;
    --request-validator-id jgpyy6</code></pre>
                     <p>To be included in request validation, a request parameter must be declared as
                        required. If the query string parameter for the page is used in request validation,
                        the <code class="code">request-parameters</code> map of the preceding example must be specified
                        as <code class="code">&apos;{&quot;method.request.querystring.type&quot;: false,
                           &quot;method.request.querystring.page&quot;:true}&apos;</code>.
                     </p>
                     
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be enabled. Please refer to your browser's
                                    Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="how-to-method-settings.html">&#xAB; Previous </a><a class="awstoc" accesskey="n" href="api-gateway-method-settings-method-response.html">Next &#xBB;</a></div>
                     <div id="copyright-main-footer">&#xA9; 2018, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="Set up API Resources"><a class="pagetoc" href="#setup-method-resources">Set up API Resources</a></li>
                        <li class="pagetoc" name="Set up an HTTP Method"><a class="pagetoc" href="#setup-method-add-http-method">Set up an HTTP Method</a></li>
                        <li class="pagetoc" name="Set up Method Request Parameters"><a class="pagetoc" href="#setup-method-request-parameters">Set up Method Request Parameters</a></li>
                        <li class="pagetoc" name="Set up Method Request Model"><a class="pagetoc" href="#setup-method-request-model">Set up Method Request Model</a></li>
                        <li class="pagetoc" name="Set up Method Request
                    Authorization"><a class="pagetoc" href="#setup-method-request-authorization">Set up Method Request
                              Authorization</a></li>
                        <li class="pagetoc" name="Set up Method Request Validation"><a class="pagetoc" href="#setup-method-request-validation">Set up Method Request Validation</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='Amazon API Gateway';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='Developer Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   
</body></html>