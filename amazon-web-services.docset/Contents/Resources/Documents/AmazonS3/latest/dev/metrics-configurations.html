<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Metrics Configurations for Buckets - Amazon Simple Storage Service</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="home" href="#top">
      <link rel="up" href="monitoring-overview.html" title="Monitoring Amazon S3">
      <link rel="prev" href="cloudwatch-monitoring.html" title="Monitoring Metrics with Amazon CloudWatch">
      <link rel="next" href="cloudtrail-logging.html" title="Logging Amazon S3 API Calls by Using AWS CloudTrail">
      <meta name="description" content="Describes what metrics configurations are, how to use them, and contains links to additional resources about metrics configurations.">
      <meta name="deployment_region" content="IAD">
      <meta name="product" content="Amazon Simple Storage Service">
      <meta name="guide" content="Developer Guide">
      <meta name="guide-locale" content="en_us">
      <link rel="icon" type="image/ico" href="/images/favicon.ico">
      <link rel="shortcut icon" type="image/ico" href="/images/favicon.ico">
      <link rel="canonical" href="https://docs.aws.amazon.com/AmazonS3/latest/dev/metrics-configurations.html">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/font-awesome.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/google-font.css">
      <link id="code-style" rel="stylesheet" type="text/css" href="../../../css/light.css">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.theme.css">
      <link rel="stylesheet" type="text/css" href="../../../css/colorbox.css">
      <link rel="stylesheet" type="text/css" href="../../../css/awsdocs.css"><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="/js/jquery-ui.min.js"></script><script type="text/javascript" src="/js/handlebars.js"></script><script type="text/javascript" src="/js/jquery.colorbox.js"></script><script type="text/javascript" src="/js/awsdocs.min.js?v=20170615"></script></head>
   <body id="top">
      
      <div id="content-container">
         
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tbody><tr>
                           <td>
                              <div class="breadcrumb"><a href="http://aws.amazon.com/documentation">AWS Documentation</a> &#xBB; <a href="http://aws.amazon.com/documentation/s3">Amazon Simple Storage Service (S3)</a> &#xBB; <a href="index.html">Developer Guide</a> &#xBB; <a href="monitoring-overview.html">Monitoring Amazon S3</a> &#xBB; <span class="breadcrumb">Metrics Configurations for Buckets</span></div>
                           </td>
                        </tr>
                     </tbody></table>
                     <div></div>
                     <h1 class="topictitle" id="metrics-configurations">Metrics Configurations for Buckets</h1>
                     <p>The CloudWatch request metrics for Amazon S3 enable you to receive 1-minute CloudWatch
                        metrics, set
                        CloudWatch alarms, and access CloudWatch dashboards to view near real-time operations
                        and
                        performance of your Amazon S3 storage. For applications that depend on Cloud storage,
                        these
                        metrics let you quickly identify and act on operational issues. When enabled, these
                        1-minute metrics are available at the Amazon S3 bucket-level, by default.
                     </p>
                     <p>You must create a metrics configuration for a bucket if you want to get the CloudWatch
                        request metrics for the objects in that bucket. You can also define a filter for the
                        metrics collected &#x2013;using a shared prefix or object tags&#x2013; allowing you to
                        align metrics filters to specific business applications, workflows, or internal
                        organizations.
                     </p>
                     <p>For more information about the CloudWatch metrics that are available and the differences
                        between storage and request metrics, see <a href="cloudwatch-monitoring.html">Monitoring Metrics with Amazon CloudWatch</a>.
                     </p>
                     <p>Keep the following in mind when using metrics configurations:</p>
                     <div class="itemizedlist">
                        
                        
                        
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p>You can have a maximum of 1000 metrics configurations per bucket.</p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>You can choose which objects in a bucket to include in metrics configurations
                                 by using filters. Filtering on a shared prefix or object tag allows you to align
                                 metrics filters to specific business applications, workflows, or internal
                                 organizations. To request metrics for the entire bucket, create a metrics
                                 configuration without a filter.
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>Metrics configurations are necessary only to enable request metrics.
                                 Bucket-level daily storage metrics are always turned on, and are provided at no
                                 additional cost. Currently, it&apos;s not possible to get daily storage metrics for a
                                 filtered subset of objects.
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>Each metrics configuration enables the full set of <a href="cloudwatch-monitoring.html#s3-request-cloudwatch-metrics">available request metrics</a>.
                                 Operation-specific metrics (such as <code class="code">PostRequests</code>) will only be
                                 reported if there are requests of that type for your bucket or your
                                 filter.
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>Request metrics are reported for object-level operations, and are also
                                 reported for operations that list bucket contents, like <a href="./AmazonS3/latest/API/v2-RESTBucketGET.html" target="_blank">GET Bucket (List Objects)</a>,
                                 <a href="./AmazonS3/latest/API/RESTBucketGETVersion.html" target="_blank">GET Bucket Object
                                    Versions</a>, and <a href="./AmazonS3/latest/API/mpUploadListMPUpload.html" target="_blank">List Multipart Uploads</a>, but are not reported for other operations
                                 on buckets.
                              </p>
                              
                           </li>
                        </ul>
                     </div>
                     
                     <h2 id="metrics-configurations-delivery">Best-Effort CloudWatch Metrics
                        Delivery
                     </h2>
                     
                     <p> CloudWatch metrics are delivered on a best-effort basis. Most requests for an Amazon
                        S3
                        object that have request metrics result in a data point being sent to CloudWatch.
                     </p>
                     
                     
                     <p>The completeness and timeliness of metrics is not guaranteed. The data point for a
                        particular request might be returned with a time stamp that is later than when the
                        request was actually processed. Or the data point for a minute might be delayed
                        before being available through CloudWatch, or it might not be delivered at all. CloudWatch
                        request metrics give you an idea of the nature of traffic against your bucket in
                        near real time. It is not meant to be a complete accounting of all requests.
                     </p>
                     
                     
                     <p>It follows from the best-effort nature of this feature that the reports available
                        at the <a href="https://console.aws.amazon.com/billing/home?#/" target="_blank">Billing &amp; Cost
                           Management Dashboard</a> might include one or more access requests that do
                        not appear in the bucket metrics.
                     </p>
                     
                     
                     <h2 id="metrics-configurations-filter">Filtering Metrics Configurations</h2>
                     
                     
                     
                     <p>When working with CloudWatch metric configurations, you have the option of filtering
                        the
                        configuration into groups of related objects within a single bucket. You can filter
                        objects in a bucket for inclusion in a metrics configuration based on one or more
                        of
                        the following elements:
                     </p>
                     
                     
                     <div class="itemizedlist">
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p><b>Object key name prefix</b> &#x2013; While the
                                 Amazon S3 data model is a flat structure, you can infer hierarchy by using a
                                 prefix. The Amazon S3 console supports these prefixes with the concept of
                                 folders. If you filter by prefix, objects that have the same prefix are
                                 included in the metrics configuration.
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p><b>Tag</b> &#x2013; You can add tags, key value
                                 name pairs, to objects. Tags allow you to find and organize objects easily.
                                 These tags can also be used as a filter for metrics configurations.
                              </p>
                              
                           </li>
                        </ul>
                     </div>
                     
                     
                     <p>If you specify a filter, only requests that operate on single objects can match
                        the filter and be included in the reported metrics. Requests like <a href="./AmazonS3/latest/API/multiobjectdeleteapi.html" target="_blank">Delete Multiple Objects</a> and
                        List requests don&apos;t return any metrics for configurations with filters.
                     </p>
                     
                     
                     <p>To request more complex filtering, choose two or more elements. Only objects that
                        have all of those elements are included in the metrics configuration. If you don&apos;t
                        set filters, all of the objects in the bucket are included in the metrics
                        configuration.
                     </p>
                     
                     
                     
                     <h2 id="add-metrics-configurations">How to Add Metrics Configurations</h2>
                     
                     
                     
                     <p>You can add metrics configurations to a bucket through the Amazon S3 console, with
                        the
                        AWS CLI, or with the Amazon S3 REST API. For information about how to do this in the
                        AWS Management Console, see the <a href="./AmazonS3/latest/user-guide/configure-metrics.html" target="_blank"> Amazon S3
                           Console User Guide</a>. 
                     </p>
                     
                     
                     <p class="title"><b>Add Metrics Configurations with the AWS CLI</b></p>
                     <ol>
                        <li>
                           
                           <p>Install and set up the AWS CLI. For instructions, see <a href="./cli/latest/userguide/cli-chap-getting-set-up.html" target="_blank">Getting Set Up with the
                                 AWS Command Line Interface</a> in the
                              <em>AWS Command Line Interface User Guide</em>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Open a terminal.</p>
                           
                        </li>
                        <li>
                           
                           <p>Run the following command to add a metrics configuration:</p>
                           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">aws s3api put-bucket-metrics-configuration --endpoint http://s3-us-west-2.amazonaws.com --bucket <em class="replaceable"><code>bucket-name</code></em> --id <em class="replaceable"><code>metrics-config-id</code></em> --metrics-configuration &apos;{&quot;Id&quot;:&quot; <em class="replaceable"><code>metrics-config-id</code></em> &quot;,&quot;Filter&quot;:{&quot;Prefix&quot;:&quot;<em class="replaceable"><code>prefix1</code></em>&quot;}}&apos;</code></pre>
                           </li>
                        <li>
                           
                           <p>To verify that the configuration was added, execute the following
                              command:
                           </p>
                           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">aws s3api get-bucket-metrics-configuration --endpoint http://s3-us-west-2.amazonaws.com --bucket <em class="replaceable"><code>bucket-name</code></em> --id <em class="replaceable"><code>metrics-config-id</code></em></code></pre>
                           
                           <p>This returns the following response:</p>
                           
                           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">{
    &quot;MetricsConfiguration&quot;: {
        &quot;Filter&quot;: {
            &quot;Prefix&quot;: &quot;<em class="replaceable"><code>prefix1</code></em>&quot;
        },
        &quot;Id&quot;: &quot;<em class="replaceable"><code>metrics-config-id</code></em>&quot;
    }
}
</code></pre>
                           
                           </li>
                     </ol>
                     
                     
                     <p>You can also add metrics configurations programmatically with the Amazon S3 REST API.
                        For more information, see the following topics in the Amazon Simple Storage Service
                        API Reference:
                     </p>
                     
                     <div class="itemizedlist">
                        
                        
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p><a href="./AmazonS3/latest/API/RESTBucketPUTMetricConfiguration.html" target="_blank">PUT Bucket
                                    Metric Configuration</a></p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p><a href="./AmazonS3/latest/API/RESTBucketGETMetricConfiguration.html" target="_blank">GET Bucket
                                    Metric Configuration</a></p>
                              
                           </li>
                           <li class="listitem">
                              
                              
                              <p><a href="./AmazonS3/latest/API/RESTListBucketMetricsConfiguration.html" target="_blank">List
                                    Bucket Metric Configuration</a></p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p><a href="./AmazonS3/latest/API/RESTDeleteBucketMetricsConfiguration.html" target="_blank">DELETE
                                    Bucket Metric Configuration</a></p>
                              
                           </li>
                        </ul>
                     </div>
                     
                     
                     
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be enabled. Please refer to your browser's
                                    Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="cloudwatch-monitoring.html">&#xAB; Previous </a><a class="awstoc" accesskey="n" href="cloudtrail-logging.html">Next &#xBB;</a></div>
                     <div id="copyright-main-footer">&#xA9; 2018, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="Best-Effort CloudWatch Metrics
                Delivery"><a class="pagetoc" href="#metrics-configurations-delivery">Best-Effort CloudWatch Metrics
                              Delivery</a></li>
                        <li class="pagetoc" name="Filtering Metrics Configurations"><a class="pagetoc" href="#metrics-configurations-filter">Filtering Metrics Configurations</a></li>
                        <li class="pagetoc" name="How to Add Metrics Configurations"><a class="pagetoc" href="#add-metrics-configurations">How to Add Metrics Configurations</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='Amazon Simple Storage Service';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='Developer Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   
</body></html>