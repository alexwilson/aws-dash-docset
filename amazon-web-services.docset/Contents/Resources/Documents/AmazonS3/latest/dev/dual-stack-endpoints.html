<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Using Amazon S3 Dual-Stack Endpoints - Amazon Simple Storage Service</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="home" href="#top">
      <link rel="up" href="ipv6-access.html" title="Making Requests to Amazon S3 over IPv6">
      <link rel="prev" href="ipv6-access.html" title="Making Requests to Amazon S3 over IPv6">
      <link rel="next" href="MakingAuthenticatedRequests.html" title="Making Requests Using the AWS SDKs">
      <meta name="description" content="Explains how to make requests to Amazon S3 dual-stack endpoints.">
      <meta name="deployment_region" content="IAD">
      <meta name="product" content="Amazon Simple Storage Service">
      <meta name="guide" content="Developer Guide">
      <meta name="guide-locale" content="en_us">
      <link rel="icon" type="image/ico" href="/images/favicon.ico">
      <link rel="shortcut icon" type="image/ico" href="/images/favicon.ico">
      <link rel="canonical" href="https://docs.aws.amazon.com/AmazonS3/latest/dev/dual-stack-endpoints.html">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/font-awesome.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/google-font.css">
      <link id="code-style" rel="stylesheet" type="text/css" href="../../../css/light.css">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.theme.css">
      <link rel="stylesheet" type="text/css" href="../../../css/colorbox.css">
      <link rel="stylesheet" type="text/css" href="../../../css/awsdocs.css"><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="/js/jquery-ui.min.js"></script><script type="text/javascript" src="/js/handlebars.js"></script><script type="text/javascript" src="/js/jquery.colorbox.js"></script><script type="text/javascript" src="/js/awsdocs.min.js?v=20170615"></script></head>
   <body id="top">
      
      <div id="content-container">
         
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tbody><tr>
                           <td>
                              <div class="breadcrumb"><a href="http://aws.amazon.com/documentation">AWS Documentation</a> &#xBB; <a href="http://aws.amazon.com/documentation/s3">Amazon Simple Storage Service (S3)</a> &#xBB; <a href="index.html">Developer Guide</a> &#xBB; <a href="MakingRequests.html">Making Requests</a> &#xBB; <a href="ipv6-access.html">Making Requests to Amazon S3 over IPv6</a> &#xBB; <span class="breadcrumb">Using Amazon S3 Dual-Stack Endpoints</span></div>
                           </td>
                        </tr>
                     </tbody></table>
                     <div></div>
                     <h1 class="topictitle" id="dual-stack-endpoints">Using Amazon S3 Dual-Stack Endpoints</h1>
                     <p>Amazon S3 dual-stack endpoints support requests to S3 buckets over IPv6 and IPv4.
                        This section describes how to use dual-stack endpoints.
                     </p>
                     <div class="highlights" id="inline-topiclist">
                        <p><strong>Topics</strong></p>
                        <ul>
                           <li><a href="#dual-stack-endpoints-description">Amazon S3 Dual-Stack Endpoints</a></li>
                           <li><a href="#dual-stack-endpoints-cli">Using Dual-Stack Endpoints from the AWS CLI</a></li>
                           <li><a href="#dual-stack-endpoints-sdks">Using Dual-Stack Endpoints from the AWS
                                 SDKs</a></li>
                           <li><a href="#dual-stack-endpoints-examples-rest-api">Using Dual-Stack Endpoints from the
                                 REST API</a></li>
                        </ul>
                     </div>
                     
                     <h2 id="dual-stack-endpoints-description">Amazon S3 Dual-Stack Endpoints</h2>
                     
                     
                     
                     <p>When you make a request to a dual-stack endpoint, the bucket URL resolves to an IPv6
                        or an IPv4 address. For more information about accessing a bucket over IPv6, see
                        <a href="ipv6-access.html">Making Requests to Amazon S3 over IPv6</a>.
                     </p>
                     
                     <p>When using the REST API, you directly access an Amazon S3 endpoint by using the endpoint
                        name
                        (URI). You can access an S3 bucket through a dual-stack endpoint by using a virtual
                        hosted-style or a path-style endpoint name. Amazon S3 supports only regional
                        dual-stack endpoint names, which means that you must specify the region as part of
                        the name. 
                     </p> 
                     
                     <p>Use the following naming conventions for the dual-stack virtual hosted-style and
                        path-style endpoint names:
                     </p>
                     
                     <div class="itemizedlist">
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p>Virtual hosted-style dual-stack endpoint: </p>
                              
                              <p>
                                 <em class="replaceable"><code>bucketname</code></em>.s3.dualstack.<em class="replaceable"><code>aws-region</code></em>.amazonaws.com
                              </p>
                              
                              <p>&#xA0;</p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>Path-style dual-stack endpoint: </p>
                              
                              <p>s3.dualstack.<em class="replaceable"><code>aws-region</code></em>.amazonaws.com/<em class="replaceable"><code>bucketname</code></em></p>
                              
                           </li>
                        </ul>
                     </div>
                     
                     <p>For more information about endpoint name style, see <a href="UsingBucket.html#access-bucket-intro">Accessing a Bucket</a>. For a list of
                        Amazon S3 endpoints, see <a href="./general/latest/gr/rande.html#s3_region" target="_blank">Regions and
                           Endpoints</a> in the <em>AWS General Reference</em>. 
                     </p>
                     
                     
                     <div class="aws-note">
                        <p class="aws-note">Important</p>
                        <p>You can use transfer acceleration with dual-stack endpoints. For more
                           information, see <a href="transfer-acceleration.html#transfer-acceleration-getting-started">Getting Started with
                              Amazon S3 Transfer Acceleration</a>.
                        </p>
                     </div> 
                     
                     <p>When using the AWS Command Line Interface (AWS CLI) and AWS SDKs, you can use a parameter
                        or
                        flag to change to a dual-stack endpoint. You can also specify the dual-stack endpoint
                        directly as an override of the Amazon S3 endpoint in the config file. The following
                        sections
                        describe how to use dual-stack endpoints from the AWS CLI and the AWS SDKs.
                     </p>
                     
                     
                     <h2 id="dual-stack-endpoints-cli">Using Dual-Stack Endpoints from the AWS CLI</h2>
                     
                     
                     
                     
                     <p>This section provides examples of AWS CLI commands used to make requests to a dual-stack
                        endpoint. For instructions on setting up the AWS CLI, see <a href="setup-aws-cli.html">Setting Up the AWS CLI</a>.
                     </p>
                     
                     <p>You set the configuration value <code class="code">use_dualstack_endpoint</code> to
                        <code class="code">true</code> in a profile in your AWS Config file to direct all Amazon S3 requests
                        made by the <code class="code">s3</code> and <code class="code">s3api</code> AWS CLI commands to the dual-stack
                        endpoint for the specified region. You specify the region in the config file or in
                        a
                        command using the <code class="code">--region</code> option. 
                     </p>
                     
                     <p>When using dual-stack endpoints with the AWS CLI, both <code class="code">path</code> and
                        <code class="code">virtual</code> addressing styles are supported. The addressing style, set in
                        the config file, controls if the bucket name is in the hostname or part of the URL.
                        By
                        default, the CLI will attempt to use virtual style where possible, but will fall back
                        to
                        path style if necessary. For more information, see <a href="./cli/latest/topic/s3-config.html" target="_blank">AWS CLI Amazon S3
                           Configuration</a>.
                     </p>
                     
                     <p>You can also make configuration changes by using a command, as shown in the
                        following example, which sets <code class="code">use_dualstack_endpoint</code> to <code class="code">true</code>
                        and <code class="code">addressing_style</code> to <code class="code">virtual</code> in the default profile.
                     </p>
                     
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="">$ aws configure set default.s3.use_dualstack_endpoint true
$ aws configure set default.s3.addressing_style virtual</code></pre>
                     <p>If you want to use a dual-stack endpoint for specified AWS CLI commands only
                        (not all commands), you can use either of the following methods: 
                     </p>
                     
                     <div class="itemizedlist">
                        
                         
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              <p>You can use the dual-stack endpoint per command by setting the <code class="code">--endpoint-url</code>
                                 parameter to
                                 <code class="code">https://s3.dualstack.<em class="replaceable"><code>aws-region</code></em>.amazonaws.com</code>
                                 or
                                 <code class="code">http://s3.dualstack.<em class="replaceable"><code>aws-region</code></em>.amazonaws.com</code>
                                 for any <code class="code">s3</code> or <code class="code">s3api</code> command.
                              </p>
                              <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">$ aws s3api list-objects --bucket <em class="replaceable"><code>bucketname</code></em> --endpoint-url https://s3.dualstack.<em class="replaceable"><code>aws-region</code></em>.amazonaws.com</code></pre>
                              </li>
                           <li class="listitem">
                              <p>You can set up separate profiles in your AWS Config file. For example, 
                                 create one profile that sets <code class="code">use_dualstack_endpoint</code> to <code class="code">true</code> and a profile that does not set <code class="code">use_dualstack_endpoint</code>.
                                 When you run a command, specify which profile you want to use, depending upon whether
                                 or not you want to use the dual-stack endpoint. 
                                 
                              </p>
                              
                           </li>
                        </ul>
                     </div>
                     
                     <div class="aws-note">
                        <p class="aws-note">Note</p>
                        <p>When using the AWS CLI you currently cannot use transfer acceleration with dual-stack
                           endpoints.
                           However, support for the AWS CLI is coming soon. For more information, see <a href="transfer-acceleration-examples.html#transfer-acceleration-examples-aws-cli">Using Transfer Acceleration from the AWS Command Line Interface (AWS CLI) </a>. 
                        </p>
                     </div>
                     
                     
                     <h2 id="dual-stack-endpoints-sdks">Using Dual-Stack Endpoints from the AWS
                        SDKs
                     </h2>
                     
                     
                     
                     <p>This section provides examples of how to access a dual-stack endpoint by using the
                        AWS SDKs. 
                     </p>
                     
                     
                     <h3 id="dual-stack-endpoints-examples-java">AWS SDK for Java Dual-Stack Endpoint Example</h3>
                     
                     
                     
                     <p>The following example shows how to enable dual-stack endpoints when creating
                        an Amazon S3 client using the AWS SDK for Java.
                     </p>
                     
                     <p>For instructions on creating and testing a working Java sample, see <a href="UsingTheMPJavaAPI.html#TestingJavaSamples">Testing the Amazon S3 Java Code Examples</a>. 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="java ">import com.amazonaws.AmazonServiceException;
import com.amazonaws.SdkClientException;
import com.amazonaws.auth.profile.ProfileCredentialsProvider;
import com.amazonaws.services.s3.AmazonS3;
import com.amazonaws.services.s3.AmazonS3ClientBuilder;

public class DualStackEndpoints {

    public static void main(String[] args) {
        String clientRegion = &quot;*** Client region ***&quot;;
        String bucketName = &quot;*** Bucket name ***&quot;;

        try {
            // Create an Amazon S3 client with dual-stack endpoints enabled.
            AmazonS3 s3Client = AmazonS3ClientBuilder.standard()
                    .withCredentials(new ProfileCredentialsProvider())
                    .withRegion(clientRegion)
                    .withDualstackEnabled(true)
                    .build();

            s3Client.listObjects(bucketName);
        }
        catch(AmazonServiceException e) {
            // The call was transmitted successfully, but Amazon S3 couldn&apos;t process 
            // it, so it returned an error response.
            e.printStackTrace();
        }
        catch(SdkClientException e) {
            // Amazon S3 couldn&apos;t be contacted for a response, or the client
            // couldn&apos;t parse the response from Amazon S3.
            e.printStackTrace();
        }
    }
}
</code></pre>
                     <p>If you are using the AWS SDK for Java on Windows, you might have to set the following
                        Java virtual machine (JVM) property: 
                     </p>      
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="">java.net.preferIPv6Addresses=true</code></pre>  
                     
                     
                     <h3 id="dual-stack-endpoints-examples-dotnet">AWS .NET SDK Dual-Stack Endpoint
                        Example
                     </h3>
                     
                     
                     <p>When using the AWS SDK for .NET you use the <code class="code">AmazonS3Config</code> class
                        to enable the use of a dual-stack endpoint as shown in the following example. 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="">var config = new AmazonS3Config
{
    UseDualstackEndpoint = true,
    RegionEndpoint = RegionEndpoint.USWest2
};

using (var s3Client = new AmazonS3Client(config))
{
    var request = new ListObjectsRequest
    {
        BucketName = &#x201C;myBucket&#x201D;
    };

    var response = await s3Client.ListObjectsAsync(request);
}</code></pre>
                     
                     <p>For a full .NET sample for listing objects, see 
                        <a href="ListingObjectKeysUsingNetSDK.html">Listing Keys Using the AWS SDK for .NET</a>.
                        
                     </p>
                     
                     <div class="aws-note">
                        <p class="aws-note">Note</p>
                        <p>You currently cannot use transfer acceleration with dual-stack endpoints. 
                           The .NET SDK will throw an exception if you configure both <code class="code">UseAccelerateEndpoint</code> 
                           and <code class="code">UseDualstackEndpoint</code> on the config object. For more
                           information, see <a href="transfer-acceleration-examples.html#transfer-acceleration-examples-dotnet">Using Transfer Acceleration from the AWS SDK
                              for .NET</a>.
                        </p>
                     </div>
                     
                     <p>For information about how to create and test a working .NET sample, see <a href="UsingTheMPDotNetAPI.html#TestingDotNetApiSamples">Running the Amazon S3 .NET Code Examples</a>. 
                     </p>
                     
                     
                     <h2 id="dual-stack-endpoints-examples-rest-api">Using Dual-Stack Endpoints from the
                        REST API
                     </h2>
                     
                     
                     <p>For information about making requests to dual-stack endpoints by using
                        the REST API, see <a href="RESTAPI.html#rest-api-dual-stack">Making Requests to Dual-Stack Endpoints by Using the REST
                           				API</a>.
                     </p>
                     
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be enabled. Please refer to your browser's
                                    Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="ipv6-access.html">&#xAB; Previous </a><a class="awstoc" accesskey="n" href="MakingAuthenticatedRequests.html">Next &#xBB;</a></div>
                     <div id="copyright-main-footer">&#xA9; 2018, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="Amazon S3 Dual-Stack Endpoints"><a class="pagetoc" href="#dual-stack-endpoints-description">Dual-Stack Endpoints</a></li>
                        <li class="pagetoc" name="Using Dual-Stack Endpoints from the AWS CLI"><a class="pagetoc" href="#dual-stack-endpoints-cli">Using Dual-Stack Endpoints (AWS CLI)</a></li>
                        <li class="pagetoc" name="Using Dual-Stack Endpoints from the AWS
            SDKs"><a class="pagetoc" href="#dual-stack-endpoints-sdks">Using Dual-Stack Endpoints (AWS SDKs)</a></li>
                        <li class="pagetoc" name="Using Dual-Stack Endpoints from the
            REST API"><a class="pagetoc" href="#dual-stack-endpoints-examples-rest-api">Using Dual-Stack Endpoints from the
                              REST API</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='Amazon Simple Storage Service';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='Developer Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   
</body></html>