<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Example Bucket Policies for VPC Endpoints for Amazon S3 - Amazon Simple Storage Service</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="home" href="#top">
      <link rel="up" href="example-bucket-policies.html" title="Bucket Policy Examples">
      <link rel="prev" href="example-bucket-policies.html" title="Bucket Policy Examples">
      <link rel="next" href="example-policies-s3.html" title="User Policy Examples">
      <meta name="description" content="An example of bucket policies for Amazon VPC endpoints for Amazon S3.">
      <meta name="deployment_region" content="IAD">
      <meta name="product" content="Amazon Simple Storage Service">
      <meta name="guide" content="Developer Guide">
      <meta name="guide-locale" content="en_us">
      <link rel="icon" type="image/ico" href="/images/favicon.ico">
      <link rel="shortcut icon" type="image/ico" href="/images/favicon.ico">
      <link rel="canonical" href="https://docs.aws.amazon.com/AmazonS3/latest/dev/example-bucket-policies-vpc-endpoint.html">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/font-awesome.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/google-font.css">
      <link id="code-style" rel="stylesheet" type="text/css" href="../../../css/light.css">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.theme.css">
      <link rel="stylesheet" type="text/css" href="../../../css/colorbox.css">
      <link rel="stylesheet" type="text/css" href="../../../css/awsdocs.css"><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="/js/jquery-ui.min.js"></script><script type="text/javascript" src="/js/handlebars.js"></script><script type="text/javascript" src="/js/jquery.colorbox.js"></script><script type="text/javascript" src="/js/awsdocs.min.js?v=20170615"></script></head>
   <body id="top">
      
      <div id="content-container">
         
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tbody><tr>
                           <td>
                              <div class="breadcrumb"><a href="http://aws.amazon.com/documentation">AWS Documentation</a> &#xBB; <a href="http://aws.amazon.com/documentation/s3">Amazon Simple Storage Service (S3)</a> &#xBB; <a href="index.html">Developer Guide</a> &#xBB; <a href="s3-access-control.html">Managing Access Permissions to Your Amazon S3 Resources</a> &#xBB; <a href="using-iam-policies.html">Using Bucket Policies and User Policies</a> &#xBB; <a href="example-bucket-policies.html">Bucket Policy Examples</a> &#xBB; <span class="breadcrumb">Example Bucket Policies for VPC Endpoints for Amazon S3</span></div>
                           </td>
                        </tr>
                     </tbody></table>
                     <div></div>
                     <h1 class="topictitle" id="example-bucket-policies-vpc-endpoint">Example Bucket Policies for VPC Endpoints for Amazon S3</h1>
                     <p>You can use Amazon S3 bucket policies to control access to buckets from specific Amazon
                        Virtual Private Cloud (Amazon VPC) 
                        endpoints, or specific VPCs. This section contains example bucket policies that can
                        be used
                        to control S3 bucket access from VPC endpoints. To learn how to set up VPC endpoints,
                        go to the <a href="./AmazonVPC/latest/UserGuide/vpc-endpoints.html" target="_blank">VPC Endpoints</a> 
                        topic in the <em>Amazon VPC User Guide</em>.
                        
                     </p>
                     <p>Amazon VPC enables you to launch Amazon Web Services (AWS) resources into a virtual
                        network that you
                        define. A VPC endpoint enables you to create a private connection between your VPC
                        and another
                        AWS service without requiring access over the Internet, through a VPN connection,
                        through a
                        NAT instance, or through AWS Direct Connect. 
                     </p>
                     <p>A VPC endpoint for Amazon S3 is a logical entity within a VPC that allows connectivity
                        only to Amazon S3.
                        The VPC endpoint routes requests to Amazon S3 and routes responses back to the VPC.
                        
                        VPC endpoints change only how requests are routed. Amazon S3 public endpoints 
                        and DNS names will continue to work with VPC endpoints. For important information
                        about using Amazon VPC endpoints with Amazon S3, 
                        go to the <a href="./AmazonVPC/latest/UserGuide/vpc-endpoints.html#vpc-endpoints-s3" target="_blank">Endpoints for Amazon S3</a> 
                        topic in the <em>Amazon VPC User Guide</em>.
                        
                     </p>
                     <p>VPC endpoints for Amazon S3 provides two ways to control access to your Amazon S3
                        data:
                        
                        
                     </p>
                     <div class="itemizedlist">
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              <p>You can control the requests, users, or groups that are allowed through a
                                 specific VPC endpoint. For information on this type of access control, 
                                 go to the <a href="./AmazonVPC/latest/UserGuide/vpc-endpoints.html#vpc-endpoints-access" target="_blank">VPC Endpoints - Controlling Access to Services</a> 
                                 topic in the <em>Amazon VPC User Guide</em>.
                              </p>
                           </li>
                           <li class="listitem">
                              <p>You can control which VPCs or VPC endpoints have access to your S3 buckets by using
                                 S3
                                 bucket policies. For examples of this type of bucket policy access control, see the
                                 following topics on restricting access.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="highlights" id="inline-topiclist">
                        <p><strong>Topics</strong></p>
                        <ul>
                           <li><a href="#example-bucket-policies-restrict-accesss-vpc-endpoint">Restricting Access to a Specific VPC Endpoint</a></li>
                           <li><a href="#example-bucket-policies-restrict-access-vpc">Restricting Access to a Specific VPC</a></li>
                           <li><a href="#example-bucket-policies-restrict-access-vpc-related-resources">Related Resources</a></li>
                        </ul>
                     </div>
                     <h2 id="example-bucket-policies-restrict-accesss-vpc-endpoint">Restricting Access to a Specific VPC Endpoint</h2>
                     
                     
                     <p>The following is an example of an S3 bucket policy that allows access to a specific
                        bucket, <code class="code">examplebucket</code>, only from the VPC endpoint with the ID
                        <code class="code">vpce-1a2b3c4d</code>. The policy uses the <code class="code">aws:sourceVpce</code> condition key to
                        restrict access to the specified VPC endpoint. The <code class="code">aws:sourceVpce</code> condition
                        key does not require an ARN for the VPC endpoint resource, only the VPC endpoint ID.
                        
                        For more information about using conditions in a policy, see 
                        <a href="amazon-s3-policy-keys.html">Specifying Conditions in a Policy</a>.
                     </p>
                     
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">{
   &quot;Version&quot;: &quot;2012-10-17&quot;,
   &quot;Id&quot;: &quot;Policy1415115909152&quot;,
   &quot;Statement&quot;: [
     {
       &quot;Sid&quot;: &quot;Access-to-specific-VPCE-only&quot;,
       &quot;Action&quot;: &quot;s3:*&quot;,
       &quot;Effect&quot;: &quot;Deny&quot;,
       &quot;Resource&quot;: [&quot;arn:aws:s3:::<em class="replaceable"><code>examplebucket</code></em>&quot;,
                    &quot;arn:aws:s3:::<em class="replaceable"><code>examplebucket</code></em>/*&quot;],
       &quot;Condition&quot;: {
         &quot;StringNotEquals&quot;: {
           &quot;aws:sourceVpce&quot;: &quot;<em class="replaceable"><code>vpce-1a2b3c4d</code></em>&quot;
         }
       },
       &quot;Principal&quot;: &quot;*&quot;
     }
   ]
}</code></pre>
                     <h2 id="example-bucket-policies-restrict-access-vpc">Restricting Access to a Specific VPC</h2>
                     
                     
                     <p>You can create a bucket policy that restricts access to a specific VPC by using the
                        <code class="code">aws:sourceVpc</code> condition key. This is useful if you have multiple VPC endpoints configured in the
                        same VPC, and you want to manage access to your S3 buckets for all of your endpoints.
                        The
                        following is an example of a policy that allows VPC <code class="code">vpc-111bbb22</code> to access
                        <code class="code">examplebucket</code>. The <code class="code">vpc-111bbb22</code> condition
                        key does not require an ARN for the VPC resource, only the VPC ID.
                     </p>
                     
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">{
   &quot;Version&quot;: &quot;2012-10-17&quot;,
   &quot;Id&quot;: &quot;Policy1415115909153&quot;,
   &quot;Statement&quot;: [
     {
       &quot;Sid&quot;: &quot;Access-to-specific-VPC-only&quot;,
       &quot;Action&quot;: &quot;s3:*&quot;,
       &quot;Effect&quot;: &quot;Deny&quot;,
       &quot;Resource&quot;: [&quot;arn:aws:s3:::<em class="replaceable"><code>examplebucket</code></em>&quot;,
                    &quot;arn:aws:s3:::<em class="replaceable"><code>examplebucket</code></em>/*&quot;],
       &quot;Condition&quot;: {
         &quot;StringNotEquals&quot;: {
           &quot;aws:sourceVpc&quot;: &quot;<em class="replaceable"><code>vpc-111bbb22</code></em>&quot;
         }
       },
       &quot;Principal&quot;: &quot;*&quot;
     }
   ]
}</code></pre>
                     <h2 id="example-bucket-policies-restrict-access-vpc-related-resources">Related Resources</h2>
                     
                     
                     <div class="itemizedlist">  
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              <p><a href="./AmazonVPC/latest/UserGuide/vpc-endpoints.html" target="_blank">VPC Endpoints</a> in the
                                 <em>Amazon VPC User Guide</em></p>
                           </li>
                           <li class="listitem">
                              <p><a href="example-bucket-policies.html">Bucket Policy Examples</a></p>
                           </li>
                        </ul>
                     </div>
                     
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be enabled. Please refer to your browser's
                                    Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="example-bucket-policies.html">&#xAB; Previous </a><a class="awstoc" accesskey="n" href="example-policies-s3.html">Next &#xBB;</a></div>
                     <div id="copyright-main-footer">&#xA9; 2018, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="Restricting Access to a Specific VPC Endpoint"><a class="pagetoc" href="#example-bucket-policies-restrict-accesss-vpc-endpoint">Restricting Access to a Specific VPC Endpoint</a></li>
                        <li class="pagetoc" name="Restricting Access to a Specific VPC"><a class="pagetoc" href="#example-bucket-policies-restrict-access-vpc">Restricting Access to a Specific VPC</a></li>
                        <li class="pagetoc" name="Related Resources"><a class="pagetoc" href="#example-bucket-policies-restrict-access-vpc-related-resources">Related Resources</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='Amazon Simple Storage Service';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='Developer Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   
</body></html>