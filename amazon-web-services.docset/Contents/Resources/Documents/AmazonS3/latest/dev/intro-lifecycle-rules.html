<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Lifecycle Configuration Elements - Amazon Simple Storage Service</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="home" href="#top">
      <link rel="up" href="object-lifecycle-mgmt.html" title="Object Lifecycle Management">
      <link rel="prev" href="lifecycle-and-other-bucket-config.html" title="Lifecycle and Other Bucket
                    Configurations">
      <link rel="next" href="lifecycle-configuration-examples.html" title="Examples of Lifecycle
            Configuration">
      <meta name="description" content="Explains the elements of Amazon S3 lifecycle configuration.">
      <meta name="deployment_region" content="IAD">
      <meta name="product" content="Amazon Simple Storage Service">
      <meta name="guide" content="Developer Guide">
      <meta name="guide-locale" content="en_us">
      <link rel="icon" type="image/ico" href="/images/favicon.ico">
      <link rel="shortcut icon" type="image/ico" href="/images/favicon.ico">
      <link rel="canonical" href="https://docs.aws.amazon.com/AmazonS3/latest/dev/intro-lifecycle-rules.html">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/font-awesome.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/google-font.css">
      <link id="code-style" rel="stylesheet" type="text/css" href="../../../css/light.css">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.theme.css">
      <link rel="stylesheet" type="text/css" href="../../../css/colorbox.css">
      <link rel="stylesheet" type="text/css" href="../../../css/awsdocs.css"><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="/js/jquery-ui.min.js"></script><script type="text/javascript" src="/js/handlebars.js"></script><script type="text/javascript" src="/js/jquery.colorbox.js"></script><script type="text/javascript" src="/js/awsdocs.min.js?v=20170615"></script></head>
   <body id="top">
      
      <div id="content-container">
         
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tbody><tr>
                           <td>
                              <div class="breadcrumb"><a href="http://aws.amazon.com/documentation">AWS Documentation</a> &#xBB; <a href="http://aws.amazon.com/documentation/s3">Amazon Simple Storage Service (S3)</a> &#xBB; <a href="index.html">Developer Guide</a> &#xBB; <a href="UsingObjects.html">Working with Amazon S3 Objects</a> &#xBB; <a href="object-lifecycle-mgmt.html">Object Lifecycle Management</a> &#xBB; <span class="breadcrumb">Lifecycle Configuration Elements</span></div>
                           </td>
                        </tr>
                     </tbody></table>
                     <div></div>
                     <h1 class="topictitle" id="intro-lifecycle-rules">Lifecycle Configuration Elements</h1>
                     <div class="highlights" id="inline-topiclist">
                        <p><strong>Topics</strong></p>
                        <ul>
                           <li><a href="#intro-lifecycle-rule-id">ID Element</a></li>
                           <li><a href="#intro-lifecycle-rule-status">Status Element</a></li>
                           <li><a href="#intro-lifecycle-rules-filter">Filter Element</a></li>
                           <li><a href="#intro-lifecycle-rules-actions">Elements to Describe Lifecycle
                                 Actions</a></li>
                        </ul>
                     </div>
                     <p>You specify a lifecycle configuration as XML, consisting of one or more lifecycle
                        rules. 
                     </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="">&lt;LifecycleConfiguration&gt;
    &lt;Rule&gt;
         ...
    &lt;/Rule&gt;
    &lt;Rule&gt;
         ...
    &lt;/Rule&gt;
&lt;/LifecycleConfiguration&gt;</code></pre><p>Each rule consists of the following:</p>
                     <div class="itemizedlist">
                        
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p>Rule metadata that include a rule ID, and status indicating whether the rule is
                                 enabled or disabled. If a rule is disabled, Amazon S3 doesn&apos;t perform any actions
                                 specified in the rule.
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>Filter identifying objects to which the rule applies. You can specify a filter by
                                 using an
                                 object key prefix, one or more object tags, or both. 
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>One or more transition or expiration actions with a date or a time period in the
                                 object&apos;s lifetime when you want Amazon S3 to perform the specified action. 
                              </p>
                              
                           </li>
                        </ul>
                     </div>
                     <p>The following sections describe the XML elements in a lifecycle configuration.
                        For example lifecycle configurations, see <a href="lifecycle-configuration-examples.html">Examples of Lifecycle
                           Configuration</a>.
                     </p>
                     <h2 id="intro-lifecycle-rule-id">ID Element</h2>
                     
                     
                     <p>A lifecycle configuration can have up to 1,000 rules. The &lt;ID&gt; element uniquely
                        identifies a rule. ID length is limited to 255 characters.
                     </p>
                     
                     <h2 id="intro-lifecycle-rule-status">Status Element</h2>
                     
                     
                     <p>The &lt;Status&gt; element value can be either Enabled or Disabled. If a rule is
                        disabled, Amazon S3 doesn&apos;t perform any of the actions defined in the rule.
                     </p>
                     
                     <h2 id="intro-lifecycle-rules-filter">Filter Element</h2>
                     
                     
                     <p>A lifecycle rule can apply to all or a subset of objects in a bucket based on the
                        &lt;Filter&gt; element that you specify in the lifecycle rule. 
                     </p>
                     
                     <p>You can filter objects by key prefix, object tags, or a combination of both (in which
                        case Amazon S3 uses a logical AND to combine the filters). Consider the following
                        examples:
                     </p>
                     
                     
                     <div class="itemizedlist">
                        
                        
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p><b>Specifying a filter using key prefixes</b>
                                 &#x2013;  This example shows a lifecycle rule that applies to a subset of objects
                                 based on the key name prefix (<code class="code">logs/</code>). For example, the lifecycle rule applies to
                                 objects <code class="code">logs/mylog.txt</code>, <code class="code">logs/temp1.txt</code>, and
                                 <code class="code">logs/test.txt</code>. The rule does not apply to the object
                                 <code class="code">example.jpg</code>.
                              </p>
                              
                              <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">&lt;LifecycleConfiguration&gt;
    &lt;Rule&gt;
        &lt;Filter&gt;
           &lt;Prefix&gt;logs/&lt;/Prefix&gt;
        &lt;/Filter&gt;
        <em class="replaceable"><code>transition/expiration actions.</code></em>
         ...
    &lt;/Rule&gt;
    ...
&lt;/LifecycleConfiguration&gt;</code></pre>
                              
                              <p>If you want to apply a lifecycle action to a subset of objects based on
                                 different key name prefixes, specify separate rules. In each rule, specify a
                                 prefix-based filter. For example, to describe a lifecycle action for objects
                                 with key prefixes <code class="code">projectA/</code> and <code class="code">projectB/</code>, 
                                 you specify two rules as shown following: 
                              </p>
                              
                              <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">&lt;LifecycleConfiguration&gt;
    &lt;Rule&gt;
        &lt;Filter&gt;
           &lt;Prefix&gt;projectA/&lt;/Prefix&gt;
        &lt;/Filter&gt;
        <em class="replaceable"><code>transition/expiration actions.</code></em>
         ...
    &lt;/Rule&gt;

    &lt;Rule&gt;
        &lt;Filter&gt;
           &lt;Prefix&gt;projectB/&lt;/Prefix&gt;
        &lt;/Filter&gt;
        <em class="replaceable"><code>transition/expiration actions.</code></em>
         ...
    &lt;/Rule&gt;
&lt;/LifecycleConfiguration&gt;</code></pre>
                              
                              
                              <p>For more information about object keys, see <a href="UsingMetadata.html#object-keys">Object Keys</a>. 
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p><b>Specifying a filter based on object tags</b>
                                 &#x2013; In the following example, the lifecycle rule specifies a filter
                                 based on a tag (<em class="replaceable"><code>key</code></em>) and value
                                 (<em class="replaceable"><code>value</code></em>). The rule then applies only to a subset
                                 of objects with the specific tag.
                              </p>
                              
                              <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">&lt;LifecycleConfiguration&gt;
    &lt;Rule&gt;
        &lt;Filter&gt;
           &lt;Tag&gt;
              &lt;Key&gt;<em class="replaceable"><code>key</code></em>&lt;/Key&gt;
              &lt;Value&gt;<em class="replaceable"><code>value</code></em>&lt;/Value&gt;
           &lt;/Tag&gt;
        &lt;/Filter&gt;
        <em class="replaceable"><code>transition/expiration actions.</code></em>
        ...
    &lt;/Rule&gt;
&lt;/LifecycleConfiguration&gt;</code></pre>
                              
                              <p>You can specify a filter based on multiple tags. You must wrap the tags in
                                 the &lt;AND&gt; element shown in the following example. The rule directs Amazon S3
                                 to perform lifecycle actions on objects with two tags (with the specific tag
                                 key and value).
                              </p>
                              
                              <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">&lt;LifecycleConfiguration&gt;
    &lt;Rule&gt;
      &lt;Filter&gt;
         &lt;And&gt;
            &lt;Tag&gt;
               &lt;Key&gt;<em class="replaceable"><code>key1</code></em>&lt;/Key&gt;
               &lt;Value&gt;<em class="replaceable"><code>value1</code></em>&lt;/Value&gt;
            &lt;/Tag&gt;
            &lt;Tag&gt;
               &lt;Key&gt;<em class="replaceable"><code>key2</code></em>&lt;/Key&gt;
               &lt;Value&gt;<em class="replaceable"><code>value2</code></em>&lt;/Value&gt;
            &lt;/Tag&gt;
             ...
          &lt;/And&gt;
      &lt;/Filter&gt;
      <em class="replaceable"><code>transition/expiration actions.</code></em>
    &lt;/Rule&gt;
&lt;/Lifecycle&gt;</code></pre>
                              
                              <p>The lifecycle rule applies to objects that have both of the tags
                                 specified. Amazon S3 performs a logical AND. Note the following:
                              </p>
                              
                              
                              <div class="itemizedlist">
                                 
                                 
                                 
                                 <ul class="itemizedlist" type="disc">
                                    <li class="listitem">
                                       
                                       <p>Each tag must match both key and value exactly.</p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p>The rule applies to a subset of objects that have one or more
                                          tags specified in the rule. If an object has additional tags specified,
                                          it doesn&apos;t matter.
                                       </p>
                                       
                                       
                                    </li>
                                 </ul>
                              </div>
                              
                              
                              
                              <div class="aws-note">
                                 <p class="aws-note">Note</p>
                                 <p>When you specify multiple tags in a filter, each tag key must be
                                    unique.
                                 </p>
                              </div>
                              
                              
                           </li>
                           <li class="listitem">
                              
                              <p><b>Specifying a filter based on both prefix and one or
                                    more tags</b> &#x2013;  In a lifecycle rule, you can specify a
                                 filter based on both the key prefix and one or more tags. Again, you must wrap
                                 all of these in the &lt;And&gt; element as shown following: 
                              </p>
                              
                              <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">&lt;LifecycleConfiguration&gt;
    &lt;Rule&gt;
        &lt;Filter&gt;
          &lt;And&gt;
             &lt;Prefix&gt;<em class="replaceable"><code>key-prefix</code></em>&lt;/Prefix&gt;
             &lt;Tag&gt;
                &lt;Key&gt;<em class="replaceable"><code>key1</code></em>&lt;/Key&gt;
                &lt;Value&gt;<em class="replaceable"><code>value1</code></em>&lt;/Value&gt;
             &lt;/Tag&gt;
             &lt;Tag&gt;
                &lt;Key&gt;<em class="replaceable"><code>key2</code></em>&lt;/Key&gt;
                &lt;Value&gt;<em class="replaceable"><code>value2</code></em>&lt;/Value&gt;
             &lt;/Tag&gt;
              ...
          &lt;/And&gt;
        &lt;/Filter&gt;
        &lt;Status&gt;Enabled&lt;/Status&gt;
        <em class="replaceable"><code>transition/expiration actions.</code></em>
    &lt;/Rule&gt;
&lt;/LifecycleConfiguration&gt;
</code></pre>
                              
                              <p>Amazon S3 combines these filters using a logical AND. That is, the rule applies
                                 to subset of objects with a specific key prefix and specific tags. A filter can
                                 have only one prefix, and zero or more tags.
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>You can specify an empty filter, in which case the rule applies to all
                                 objects in the bucket.
                              </p>
                              
                              <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">&lt;LifecycleConfiguration&gt;
    &lt;Rule&gt;
        &lt;Filter&gt;
        &lt;/Filter&gt;
        &lt;Status&gt;Enabled&lt;/Status&gt;
        <em class="replaceable"><code>transition/expiration actions.</code></em>
    &lt;/Rule&gt;
&lt;/LifecycleConfiguration&gt;
</code></pre>
                              
                              </li>
                        </ul>
                     </div>
                     
                     
                     
                     <h2 id="intro-lifecycle-rules-actions">Elements to Describe Lifecycle
                        Actions
                     </h2>
                     
                     
                     <p>You can direct Amazon S3 to perform specific actions in an object&apos;s lifetime by specifying
                        one or more of the following predefined actions in a lifecycle rule. The effect of
                        these
                        actions depends on the versioning state of your bucket. 
                     </p>
                     
                     <div class="itemizedlist">
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p><b>Transition</b> action element &#x2013; You specify
                                 the <code class="code">Transition</code> action to transition objects from one storage class
                                 to another. For more information about transitioning objects, see <a href="lifecycle-transition-general-considerations.html#lifecycle-general-considerations-transition-sc">Supported
                                    Transitions and Related Constraints</a>. When a
                                 specified date or time period in the object&apos;s lifetime is reached, Amazon S3 performs
                                 the transition. 
                              </p>
                              
                              <p>For a versioned bucket (versioning-enabled or versioning-suspended bucket),
                                 the <code class="code">Transition</code> action applies to the current object version. To
                                 manage noncurrent versions, Amazon S3 defines the
                                 <code class="code">NoncurrentVersionTransition</code> action (described below).
                              </p>
                              
                           </li>
                        </ul>
                     </div>
                     
                     <div class="itemizedlist">
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p><b>Expiration action element</b> &#x2013; The
                                 <code class="code">Expiration</code> action expires objects identified in the rule
                                 and applies to eligible objects in any of the Amazon S3 storage classes. For more
                                 information about 
                                 storage classes, see <a href="storage-class-intro.html">Storage Classes</a>.
                                 Amazon S3 makes all expired objects unavailable. Whether the
                                 objects are permanently removed depends on the versioning state of the bucket. 
                              </p>
                              
                              <div class="aws-note">
                                 <p class="aws-note">Important</p>
                                 <p>Object expiration lifecycle polices do not remove incomplete multipart uploads. To
                                    remove
                                    incomplete multipart uploads you must use the <b>AbortIncompleteMultipartUpload</b> lifecycle configuration
                                    action that is described later in this section. 
                                 </p>
                              </div>
                              
                              
                              <div class="itemizedlist">
                                 
                                 
                                 
                                 <ul class="itemizedlist" type="disc">
                                    <li class="listitem">
                                       
                                       <p><b>Non-versioned bucket</b> &#x2013; The
                                          <code class="code">Expiration</code> action results in Amazon S3 permanently
                                          removing the object. 
                                       </p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p><b>Versioned bucket</b> &#x2013; For a
                                          versioned bucket (that is, versioning-enabled or versioning-suspended), there
                                          are several considerations that guide how Amazon S3 handles the
                                          <code class="code">expiration</code> action. For more information, see 
                                          <a href="Versioning.html">Using Versioning</a>. Regardless of the versioning state,
                                          the following applies:
                                       </p>
                                       
                                       
                                       <div class="itemizedlist">
                                          
                                          
                                          
                                          
                                          <ul class="itemizedlist" type="disc">
                                             <li class="listitem">
                                                
                                                <p>The <code class="code">Expiration</code> action applies only to the
                                                   current version (it has no impact on noncurrent object
                                                   versions).
                                                </p>
                                                
                                             </li>
                                             <li class="listitem">
                                                
                                                <p>Amazon S3 doesn&apos;t take any action if there are one or more
                                                   object versions and the delete marker is the current
                                                   version.
                                                </p>
                                                
                                             </li>
                                             <li class="listitem">
                                                
                                                <p>If the current object version is the only object
                                                   version and it is also a delete marker (also referred as
                                                   an <em>expired object delete marker</em>, where all object
                                                   versions are deleted and you only have a delete marker
                                                   remaining), Amazon S3 removes the expired object delete
                                                   marker. You can also use the expiration action to direct
                                                   Amazon S3 to remove any expired object delete markers.
                                                   For an example, see <a href="lifecycle-configuration-examples.html#lifecycle-config-conceptual-ex7">Example 7: Removing Expired Object
                                                      Delete Markers</a>.
                                                   
                                                </p>
                                                
                                             </li>
                                          </ul>
                                       </div>
                                       
                                       
                                       <p>Also consider the following when setting up Amazon S3 to manage
                                          expiration:
                                       </p>
                                       
                                       
                                       <div class="itemizedlist">
                                          
                                          
                                          
                                          <ul class="itemizedlist" type="disc">
                                             <li class="listitem">
                                                
                                                <p><b>Versioning-enabled
                                                      bucket</b>
                                                   
                                                </p>
                                                
                                                <p>If the current object version is not a delete marker,
                                                   Amazon S3 adds a delete marker with a unique version ID. This makes
                                                   the current version noncurrent, and the delete marker&#xA0;the
                                                   current version. 
                                                </p>
                                                
                                             </li>
                                             <li class="listitem">
                                                
                                                <p><b>Versioning-suspended
                                                      bucket</b>
                                                   
                                                </p>
                                                
                                                <p>In a versioning-suspended bucket, the expiration
                                                   action causes Amazon S3 to create a delete marker with null as the
                                                   version ID. This delete marker replaces any object version with
                                                   a null version ID in the version hierarchy, which effectively
                                                   deletes the object. 
                                                </p>
                                                
                                                
                                             </li>
                                          </ul>
                                       </div>
                                       
                                       
                                    </li>
                                 </ul>
                              </div>
                              
                              
                           </li>
                        </ul>
                     </div>
                     
                     <p>In addition, Amazon S3 provides the following actions that you can use to manage noncurrent
                        object versions in a versioned bucket (that is, versioning-enabled and versioning-suspended
                        buckets).
                     </p>
                     
                     <div class="itemizedlist">
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p><b>NoncurrentVersionTransition</b> action element
                                 &#x2013; Use this action to specify how long (from the time the objects became
                                 noncurrent) you want the objects to remain in the current storage class before
                                 Amazon S3 transitions them to the specified storage class. For more information about
                                 transitioning objects, see <a href="lifecycle-transition-general-considerations.html#lifecycle-general-considerations-transition-sc">Supported
                                    Transitions and Related Constraints</a>. 
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p><b>NoncurrentVersionExpiration</b> action element
                                 &#x2013; Use this action to specify how long (from the time the objects became
                                 noncurrent) you want to retain noncurrent object versions before Amazon S3
                                 permanently removes them. The deleted object can&apos;t be recovered. 
                              </p>
                              
                              <p>This delayed removal of noncurrent objects can be helpful when you need to
                                 correct any accidental deletes or overwrites. For example, you can configure an
                                 expiration rule to delete noncurrent versions five days after they become
                                 noncurrent. For example, suppose that on 1/1/2014 10:30 AM UTC, you create an
                                 object called <code>photo.gif</code> (version ID 111111). On 1/2/2014
                                 11:30 AM UTC, you accidentally delete <code class="code">photo.gif</code> (version ID
                                 111111), which creates a delete marker with a new version ID (such as version ID
                                 4857693). You now have five days to recover the original version of
                                 <code class="code">photo.gif</code> (version ID 111111) before the deletion is permanent.
                                 On 1/8/2014 00:00 UTC, the lifecycle rule for expiration executes and
                                 permanently deletes <code>photo.gif</code> (version ID 111111), five
                                 days after it became a noncurrent version. 
                              </p>
                              
                              <div class="aws-note">
                                 <p class="aws-note">Important</p>
                                 <p>Object expiration lifecycle policies do not remove incomplete multipart uploads. To
                                    remove
                                    incomplete multipart uploads, you must use the <b>AbortIncompleteMultipartUpload</b> lifecycle configuration
                                    action that is described later in this section. 
                                 </p>
                              </div>
                              
                           </li>
                        </ul>
                     </div>
                     
                     <p>In addition to the transition and expiration actions, you can use the following
                        lifecycle configuration action to direct Amazon S3 to abort incomplete multipart
                        uploads. 
                     </p>
                     
                     
                     <div class="itemizedlist">
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p><b>AbortIncompleteMultipartUpload</b> action
                                 element &#x2013; Use this element to set a maximum time (in days) that you want
                                 to allow multipart uploads to remain in progress. If the applicable multipart
                                 uploads (determined by the key name <code class="code">prefix</code> specified in the
                                 lifecycle rule) are not successfully completed within the predefined time
                                 period, Amazon S3 aborts the incomplete multipart uploads. For more information, see
                                 <a href="mpuoverview.html#mpu-abort-incomplete-mpu-lifecycle-config">Aborting Incomplete Multipart
                                    Uploads Using a Bucket Lifecycle Policy</a>. 
                              </p>
                              
                              
                              <div class="aws-note">
                                 <p class="aws-note">Note</p>
                                 <p>You cannot specify this lifecycle action in a rule that specifies
                                    a filter based on object tags.
                                    
                                 </p>
                              </div>
                              
                              
                              
                           </li>
                           <li class="listitem">
                              
                              <p><b>ExpiredObjectDeleteMarker</b> action element
                                 &#x2013; In a versioning-enabled bucket, a delete marker with zero
                                 noncurrent versions is referred to as the expired object delete marker. You
                                 can use this lifecycle action to direct S3 to remove the expired object
                                 delete markers. For an example, see <a href="lifecycle-configuration-examples.html#lifecycle-config-conceptual-ex7">Example 7: Removing Expired Object
                                    Delete Markers</a>.
                              </p>
                              
                              
                              <div class="aws-note">
                                 <p class="aws-note">Note</p>
                                 <p>You cannot specify this lifecycle action in a rule that specifies
                                    a filter based on object tags. 
                                 </p>
                              </div>
                              
                              
                           </li>
                        </ul>
                     </div>
                     
                     
                     
                     <h3 id="non-current-days-calculations">How Amazon S3 Calculates How
                        Long an Object Has Been Noncurrent
                     </h3>
                     
                     
                     
                     <p> In a versioning-enabled bucket, you can have multiple versions of an
                        object, there is always one current version, and zero or more noncurrent versions.
                        Each time you upload an object, the current version is retained as the noncurrent
                        version and the newly added version, the successor, becomes the current version. To
                        determine the number of days an object is noncurrent, Amazon S3 looks at when its
                        successor was created. Amazon S3 uses the number of days since its successor was created
                        as the number of days an object is noncurrent. 
                     </p>
                     
                     
                     <div class="aws-note">
                        <p class="aws-note">Restoring Previous Versions of an Object When Using Lifecycle
                           Configurations
                        </p>
                        <p> As explained in detail in the topic <a href="RestoringPreviousVersions.html">Restoring Previous Versions</a>,
                           you can use either of the following two methods to retrieve previous versions of an
                           object:
                        </p>
                        <div class="orderedlist">
                           
                           
                           
                           <ol>
                              <li>
                                 
                                 <p>By copying a noncurrent version of the object into the same
                                    bucket. The copied object becomes the current version of that
                                    object, and all object versions are preserved.
                                 </p>
                                 
                              </li>
                              <li>
                                 
                                 <p>By permanently deleting the current version of the object.
                                    When you delete the current object version, you, in effect, turn
                                    the noncurrent version into the current version of that
                                    object.
                                 </p>
                                 
                              </li>
                           </ol>
                        </div>
                        <p>When using lifecycle configuration rules with versioning-enabled buckets,
                           we recommend as a best practice that you use the first method. 
                        </p>
                        <p> Because of Amazon S3&apos;s eventual consistency semantics, a current version
                           that you permanently deleted may not disappear until the changes propagate (Amazon
                           S3 
                           may be unaware of this deletion). In the meantime, the lifecycle rule that you configured
                           to expire noncurrent objects may permanently remove noncurrent objects, including
                           the
                           one you want to restore. So, copying the old version, as recommended in the first
                           method, is the safer
                           alternative.
                        </p>
                     </div>            
                     
                     <p>The following table summarizes the behavior of the
                        lifecycle configuration rule actions on objects in relation to the versioning state
                        of the bucket containing the object.
                     </p>
                     
                     <div class="table">
                        <p class="title"><b>Lifecycle Actions and Bucket Versioning State</b></p>
                        <div class="table-contents">
                           <table id="w70aac18c23c15c23c24">
                              
                              <tbody><tr>
                                 
                                 <th>Action</th>
                                 
                                 <th>Nonversioned Bucket (Versioning Not Enabled)</th>
                                 
                                 <th>Versioning-Enabled Bucket</th>
                                 
                                 <th>Versioning-Suspended Bucket</th>
                                 
                              </tr>
                              
                              
                              <tr>
                                 
                                 <td>
                                    
                                    <p><code class="code">Transition</code></p>
                                    
                                    <p>When a specified date or time period in the object&apos;s lifetime
                                       is reached.
                                    </p>
                                    
                                 </td>
                                 
                                 <td>Amazon S3 transitions the object to the specified storage
                                    class.
                                 </td>
                                 
                                 <td>Amazon S3 transitions the current version of the object to the
                                    specified storage class.
                                 </td>
                                 
                                 <td>Same behavior as a versioning-enabled bucket.</td>
                                 
                              </tr>
                              
                              <tr>
                                 
                                 <td>
                                    
                                    <p><code class="code">Expiration</code></p>
                                    
                                    <p>When a specified date or time period in the object&apos;s lifetime
                                       is reached.
                                    </p>
                                    
                                 </td>
                                 
                                 <td>Expiration deletes the object, and the deleted object cannot be
                                    recovered.
                                 </td>
                                 
                                 <td>If the current version is not a delete marker, Amazon S3 creates
                                    a delete marker, which becomes the current version, and the existing
                                    current version is retained as a noncurrent version.
                                 </td>
                                 
                                 <td>The lifecycle creates a delete marker with <code class="code">null</code> version
                                    ID, which becomes the current version. If the version ID of the
                                    current version of the object is <code class="code">null</code>, the Expiration
                                    action permanently deletes this version. Otherwise, the current
                                    version is retained as a noncurrent version.
                                 </td>
                                 
                              </tr>
                              
                              
                              
                              <tr>
                                 
                                 <td>
                                    
                                    <p><code class="code">NoncurrentVersionTransition</code></p>
                                    
                                    <p>When the specified number of days from when the object becomes
                                       noncurrent is reached.
                                    </p>
                                    
                                 </td>
                                 
                                 <td><code class="code">NoncurrentVersionTransition</code> has no effect.
                                 </td>
                                 
                                 <td>
                                    
                                    <p>Amazon S3 transitions the noncurrent object versions to the specified
                                       storage class.
                                    </p>
                                    
                                 </td>
                                 
                                 <td>Same behavior as a versioning-enabled bucket.</td>
                                 
                              </tr>
                              
                              <tr>
                                 
                                 <td>
                                    
                                    <p><code class="code">NoncurrentVersionExpiration</code></p>
                                    
                                    <p>When the specified number of days from when the object becomes
                                       noncurrent is reached.
                                    </p>
                                    
                                 </td>
                                 
                                 <td><code class="code">NoncurrentVersionExpiration</code> has no effect.
                                 </td>
                                 
                                 <td><code class="code">NoncurrentVersionExpiration</code> action deletes the noncurrent version of
                                    the object, and the deleted object cannot be recovered.
                                 </td>
                                 
                                 <td>Same behavior as a versioning-enabled bucket.</td>
                                 
                              </tr>
                              
                           </tbody></table>
                        </div>
                     </div>
                     
                     <h3 id="intro-lifecycle-rules-number-of-days">Lifecycle Rules: Based on an
                        Object&apos;s Age
                     </h3>
                     
                     
                     <p>You can specify a time period, in number of days from the creation (or
                        modification) of the objects, when Amazon S3 can take the action. 
                     </p>
                     
                     <p>When you specify the number of days in the <code class="code">Transition</code> and
                        <code class="code">Expiration</code> actions in a lifecycle configuration, note the
                        following:
                     </p>
                     
                     
                     <div class="itemizedlist">
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p>It is the number of days since object creation when the action will occur.</p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>Amazon S3 calculates the time by adding the number of days specified in the
                                 rule to the object creation time and rounding the resulting time to the
                                 next day midnight UTC. For example, if an object was created at
                                 1/15/2014 10:30 AM UTC and you specify 3 days in a transition rule, then
                                 the transition date of the object would be calculated as 1/19/2014 00:00
                                 UTC. 
                              </p>
                              
                           </li>
                        </ul>
                     </div>
                     
                     
                     <div class="aws-note">
                        <p class="aws-note">Note</p>
                        <p>Amazon S3 maintains only the last modified date for each object. For example, the
                           Amazon S3 console shows the <b>Last Modified</b> date in the object
                           <b>Properties</b> pane. When you initially create a new
                           object, this date reflects the date the object is created. If you replace the
                           object, the date changes accordingly. So when we use the term <em>creation
                              date</em>, it is synonymous with the term <em>last modified
                              date</em>. 
                        </p>
                     </div>
                     
                     <p>When specifying the number of days in the <code class="code">NoncurrentVersionTransition</code>
                        and <code class="code">NoncurrentVersionExpiration</code> actions in a lifecycle configuration,
                        note the following:
                     </p>
                     
                     
                     <div class="itemizedlist">
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p>It is the number of days from when the version of the object becomes
                                 noncurrent (that is, since the object was overwritten or deleted), as
                                 the time when Amazon S3 will perform the action on the specified
                                 object or objects.
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>Amazon S3 calculates the time by adding the number of days specified in the
                                 rule to the time when the new successor version of the object is created
                                 and rounding the resulting time to the next day midnight UTC. For
                                 example, in your bucket, you have a current version of an object that
                                 was created at 1/1/2014 10:30 AM UTC, if the new successor version of
                                 the object that replaces the current version is created at 1/15/2014
                                 10:30 AM UTC and you specify 3 days in a transition rule, then the
                                 transition date of the object would be calculated as 1/19/2014 00:00
                                 UTC. 
                              </p>
                              
                           </li>
                        </ul>
                     </div>
                     
                     
                     
                     <h3 id="intro-lifecycle-rules-date">Lifecycle Rules: Based on a Specific
                        Date
                     </h3>
                     
                     
                     
                     
                     <p>When specifying an action in a lifecycle rule, you can specify a date when you
                        want Amazon S3to take the action. When the specific date arrives, S3 applies the action
                        to all qualified objects (based on the filter criteria). 
                     </p>
                     
                     <p>If you specify a lifecycle action with a date that is in the past, all qualified
                        objects become immediately eligible for that lifecycle action.
                     </p>
                     
                     
                     <div class="aws-note">
                        <p class="aws-note">Important</p>
                        <p>The date-based action is not a one-time action. S3 continues to apply the
                           date-based action even after the date has passed, as long as the rule status
                           is Enabled.
                        </p>
                        <p>For example, suppose that you specify a date-based Expiration action to
                           delete all objects (assume no filter specified in the rule). On the specified
                           date, S3 expires all the objects in the bucket. S3 also continues to expire any
                           new objects you create in the bucket. To stop the lifecycle action, you must
                           remove the action from the lifecycle configuration, disable the rule, or delete
                           the rule from the lifecycle configuration.
                        </p>
                     </div>
                     
                     
                     <p>The date value must conform to the ISO 8601 format. The time is always midnight
                        UTC. 
                     </p>
                     
                     <div class="aws-note">
                        <p class="aws-note">Note</p>
                        <p>You can&apos;t create the date-based lifecycle rules using the Amazon S3 console, but
                           you can view, disable, or delete such rules. 
                        </p>
                     </div>
                     
                     
                     
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be enabled. Please refer to your browser's
                                    Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="lifecycle-and-other-bucket-config.html">&#xAB; Previous </a><a class="awstoc" accesskey="n" href="lifecycle-configuration-examples.html">Next &#xBB;</a></div>
                     <div id="copyright-main-footer">&#xA9; 2018, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="ID Element"><a class="pagetoc" href="#intro-lifecycle-rule-id">ID Element</a></li>
                        <li class="pagetoc" name="Status Element"><a class="pagetoc" href="#intro-lifecycle-rule-status">Status Element</a></li>
                        <li class="pagetoc" name="Filter Element"><a class="pagetoc" href="#intro-lifecycle-rules-filter">Filter Element</a></li>
                        <li class="pagetoc" name="Elements to Describe Lifecycle
            Actions"><a class="pagetoc" href="#intro-lifecycle-rules-actions">Elements to Describe Lifecycle
                              Actions</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='Amazon Simple Storage Service';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='Developer Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   
</body></html>