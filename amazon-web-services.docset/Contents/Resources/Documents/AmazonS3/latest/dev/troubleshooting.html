<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Troubleshooting Amazon S3 - Amazon Simple Storage Service</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="home" href="#top">
      <link rel="up" href="Welcome.html" title="What Is Amazon S3?">
      <link rel="prev" href="ErrorBestPractices.html" title="Amazon S3 Error Best Practices">
      <link rel="next" href="ServerLogs.html" title="Server Access Logging">
      <meta name="description" content="Troubleshooting common Amazon S3 issues.">
      <meta name="deployment_region" content="IAD">
      <meta name="product" content="Amazon Simple Storage Service">
      <meta name="guide" content="Developer Guide">
      <meta name="guide-locale" content="en_us">
      <link rel="icon" type="image/ico" href="/images/favicon.ico">
      <link rel="shortcut icon" type="image/ico" href="/images/favicon.ico">
      <link rel="canonical" href="https://docs.aws.amazon.com/AmazonS3/latest/dev/troubleshooting.html">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/font-awesome.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/google-font.css">
      <link id="code-style" rel="stylesheet" type="text/css" href="../../../css/light.css">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.theme.css">
      <link rel="stylesheet" type="text/css" href="../../../css/colorbox.css">
      <link rel="stylesheet" type="text/css" href="../../../css/awsdocs.css"><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="/js/jquery-ui.min.js"></script><script type="text/javascript" src="/js/handlebars.js"></script><script type="text/javascript" src="/js/jquery.colorbox.js"></script><script type="text/javascript" src="/js/awsdocs.min.js?v=20170615"></script></head>
   <body id="top">
      
      <div id="content-container">
         
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tbody><tr>
                           <td>
                              <div class="breadcrumb"><a href="http://aws.amazon.com/documentation">AWS Documentation</a> &#xBB; <a href="http://aws.amazon.com/documentation/s3">Amazon Simple Storage Service (S3)</a> &#xBB; <a href="index.html">Developer Guide</a> &#xBB; <span class="breadcrumb">Troubleshooting Amazon S3</span></div>
                           </td>
                        </tr>
                     </tbody></table>
                     <div></div>
                     <h1 class="topictitle" id="troubleshooting">Troubleshooting Amazon S3</h1>
                     <p>This section describes how to troubleshoot Amazon S3 and explains how to get request
                        IDs that
                        you&apos;ll need when you contact AWS Support.
                     </p>
                     <div class="highlights" id="inline-topiclist">
                        <p><strong>Topics</strong></p>
                        <ul>
                           <li><a href="#troubleshooting-by-symptom">Troubleshooting Amazon S3 by Symptom</a></li>
                           <li><a href="#get-request-ids">Getting Amazon S3 Request IDs for AWS Support</a></li>
                           <li><a href="#related-troubleshooting-topics">Related Topics</a></li>
                        </ul>
                     </div>
                     <h2 id="troubleshooting-by-symptom">Troubleshooting Amazon S3 by Symptom</h2>
                     
                     
                     <p>The following topics lists symptoms to help you troubleshoot some of the issues that
                        you
                        might encounter when working with Amazon S3.
                     </p>
                     
                     <div class="highlights" id="inline-topiclist">
                        <p><strong>Symptoms</strong></p>
                        <ul>
                           <li><a href="#troubleshooting-by-symptom-increase-503-reponses">Significant Increases in
                                 HTTP 503 Responses to Requests to Buckets with Versioning Enabled</a></li>
                           <li><a href="#troubleshooting-by-symptom-increase">Unexpected Behavior When Accessing Buckets Set with CORS</a></li>
                        </ul>
                     </div>
                     
                     
                     
                     <h3 id="troubleshooting-by-symptom-increase-503-reponses">Significant Increases in
                        HTTP 503 Responses to Amazon S3 Requests to Buckets with Versioning Enabled
                     </h3>
                     
                     
                     
                     <p>If you notice a significant increase in the number of HTTP 503-slow down responses
                        received for Amazon S3 PUT or DELETE object requests to a bucket that has versioning
                        enabled, you
                        might have one or more objects in the bucket for which there are millions of versions.
                        When
                        you have objects with millions of versions, Amazon S3 automatically throttles requests
                        to the
                        bucket to protect the customer from an excessive amount of request traffic, which
                        could
                        potentially impede other requests made to the same bucket. 
                     </p>
                     
                     <p>To determine which S3 objects have millions of versions, use the Amazon S3 inventory
                        tool. The inventory tool generates a report that provides a flat file list of the
                        objects in
                        a bucket. For more information, see <a href="storage-inventory.html"> Amazon S3 Inventory</a>.
                     </p>
                     
                     <p>The Amazon S3 team encourages customers to investigate applications that repeatedly
                        overwrite
                        the same S3 object, potentially creating millions of versions for that object, to
                        determine
                        whether the application is working as intended. If you have a use case that requires
                        millions of versions for one or more S3 objects, contact the AWS Support team at <a href="https://console.aws.amazon.com/support/home" target="_blank">AWS Support</a> to discuss your use case
                        and to help us assist you in determining the optimal solution for your use case
                        scenario.
                     </p>
                      
                     
                     
                     <h3 id="troubleshooting-by-symptom-increase">Unexpected Behavior When Accessing Buckets Set with CORS</h3>
                     
                     
                     
                     
                     <p> If you encounter unexpected behavior when accessing buckets set with the cross-origin
                        resource sharing (CORS) configuration, see <a href="cors-troubleshooting.html">Troubleshooting CORS Issues</a>.
                     </p>
                     
                     
                     <h2 id="get-request-ids">Getting Amazon S3 Request IDs for AWS Support</h2>
                     
                     
                     
                     <p>Whenever you need to contact AWS Support due to encountering errors or unexpected
                        behavior
                        in Amazon S3, you will need to get the request IDs associated with the failed action.
                        Getting these
                        request IDs enables AWS Support to help you resolve the problems you&apos;re experiencing.
                        Request
                        IDs come in pairs, are returned in every response that Amazon S3 processes (even the
                        erroneous
                        ones), and can be accessed through verbose logs. There are a number of common methods
                        for
                        getting your request IDs.
                     </p>
                     
                     
                     <p>After you&apos;ve recovered these logs, copy and retain those two values, because you&apos;ll
                        need
                        them when you contact AWS Support. For information about contacting AWS Support, see
                        <a href="https://aws.amazon.com/contact-us/" target="_blank">Contact Us</a>.
                     </p>
                     
                     
                     <div class="highlights" id="inline-topiclist">
                        <p><strong>Topics</strong></p>
                        <ul>
                           <li><a href="#http-request-id">Using HTTP to Obtain Request IDs</a></li>
                           <li><a href="#browser-request-id">Using a Web Browser to Obtain Request IDs</a></li>
                           <li><a href="#sdk-request-ids">Using AWS SDKs to Obtain Request IDs</a></li>
                           <li><a href="#cli-request-id">Using the AWS CLI to Obtain Request IDs</a></li>
                        </ul>
                     </div>
                     
                     
                     <h3 id="http-request-id">Using HTTP to Obtain Request IDs</h3>
                     
                     
                     <p>You can obtain your request IDs, <code class="code">x-amz-request-id</code> and
                        <code class="code">x-amz-id-2</code> by logging the bits of an HTTP request before it reaches the
                        target application. There are a variety of third-party tools that can be used to recover
                        verbose logs for HTTP requests. Choose one you trust, and run the tool, listening
                        on the
                        port that your Amazon S3 traffic travels on, as you send out another Amazon S3 HTTP
                        request.
                     </p>
                     
                     
                     <p>For HTTP requests, the pair of request IDs will look like the following examples.</p>
                     
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="">x-amz-request-id: 79104EXAMPLEB723 
x-amz-id-2: IOWQ4fDEXAMPLEQM+ey7N9WgVhSnQ6JEXAMPLEZb7hSQDASK+Jd1vEXAMPLEa3Km
</code></pre>
                     
                     <div class="aws-note">
                        <p class="aws-note">Note</p>
                        <p>HTTPS requests are encrypted and hidden in most packet captures.</p>
                     </div>
                     
                     
                     
                     
                     <h3 id="browser-request-id">Using a Web Browser to Obtain Request IDs</h3>
                     
                     
                     
                     <p>Most web browsers have developer tools that allow you to view request headers.</p>
                     
                     
                     <p>For web browser-based requests that return an error, the pair of requests IDs will
                        look
                        like the following examples.
                     </p>
                     
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="">&lt;Error&gt;&lt;Code&gt;AccessDenied&lt;/Code&gt;&lt;Message&gt;Access Denied&lt;/Message&gt;
&lt;RequestId&gt;79104EXAMPLEB723&lt;/RequestId&gt;&lt;HostId&gt;IOWQ4fDEXAMPLEQM+ey7N9WgVhSnQ6JEXAMPLEZb7hSQDASK+Jd1vEXAMPLEa3Km&lt;/HostId&gt;&lt;/Error&gt;
</code></pre>
                     
                     <p>For obtaining the request ID pair from successful requests, you&apos;ll need to use the
                        developer tools to look at the HTTP response headers. For information about developer
                        tools
                        for specific browsers, see <b>Amazon S3 Troubleshooting - How to recover your S3 request IDs</b> in the AWS
                        Developer Forums.
                     </p>
                     
                     
                     
                     <h3 id="sdk-request-ids">Using AWS SDKs to Obtain Request IDs</h3>
                     
                     
                     <p>The following sections include information for configuring logging using an AWS SDK.
                        While you can enable verbose logging on every request and response, you should not
                        enable
                        logging in production systems since large requests/responses can cause significant
                        slowdown
                        in an application.
                     </p>
                     
                     
                     <p>For AWS SDK requests, the pair of request IDs will look like the following
                        examples.
                     </p>
                     
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="">Status Code: 403, AWS Service: Amazon S3, AWS Request ID: 79104EXAMPLEB723  
AWS Error Code: AccessDenied  AWS Error Message: Access Denied  
S3 Extended Request ID: IOWQ4fDEXAMPLEQM+ey7N9WgVhSnQ6JEXAMPLEZb7hSQDASK+Jd1vEXAMPLEa3Km</code></pre>
                     
                     <h4 id="php-request-id">Using the SDK for PHP to Obtain Request IDs</h4>
                     
                     
                     <p>You can configure logging using PHP. For more information, see <a href="./aws-sdk-php/guide/latest/faq.html#how-can-i-see-what-data-is-sent-over-the-wire" target="_blank">How can I see what data is sent over the wire?</a> in the FAQ for the <em>AWS
                           SDK for PHP</em>.
                     </p>
                     
                     
                     <h4 id="java-request-id">Using the SDK for Java to Obtain Request IDs</h4>
                     
                     
                     
                     <p>You can enable logging for specific requests or responses, allowing you to catch and
                        return only the relevant headers. To do this, import the
                        <code class="code">com.amazonaws.services.s3.s3ResponseMetadata</code> class. Afterwards, you can
                        store the request in a variable before performing the actual request. Call
                        <code class="code">getCachedResponseMetadata(AmazonWebServiceRequest request).getRequestID()</code>
                        to get the logged request or response.
                     </p>
                     
                     
                     <div class="example">
                        <div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="">PutObjectRequest req = new PutObjectRequest(bucketName, key, createSampleFile());
s3.putObject(req);
S3ResponseMetadata md = s3.getCachedResponseMetadata(req);
System.out.println(&quot;Host ID: &quot; + md.getHostId() + &quot; RequestID: &quot; + md.getRequestId());</code></pre></div>
                     </div>
                     
                     <p>Alternatively, you can use verbose logging of every Java request and response. For
                        more information, see <a href="./AWSSdkDocsJava/latest/DeveloperGuide/java-dg-logging.html#sdk-net-logging-verbose" target="_blank">Verbose Wire Logging</a> in the Logging AWS SDK for Java Calls topic in the
                        <em>AWS SDK for Java Developer Guide</em>.
                     </p>
                     
                     
                     <h4 id="net-request-id">Using the AWS SDK for .NET to Obtain Request IDs</h4>
                     
                     
                     <p>You can configure logging in AWS SDK for .NET using the built-in <code class="code">System.Diagnostics</code>
                        logging tool. For more information, see the <a href="http://aws.amazon.com/blogs/developer/logging-with-the-aws-sdk-for-net/" target="_blank"> Logging with the
                           AWS SDK for .NET</a> AWS Developer Blog post.
                     </p>
                     
                     <div class="aws-note">
                        <p class="aws-note">Note</p>
                        <p>By default, the returned log contains only error information. The config file needs
                           to have <code class="code">AWSLogMetrics</code> (and optionally, <code class="code">AWSResponseLogging</code>)
                           added to get the request IDs.
                        </p>
                     </div>
                     
                     
                     <h4 id="python-request-id">Using the SDK for Python to Obtain Request IDs</h4>
                     
                     
                     <p>You can configure logging in Python by adding the following lines to your code to
                        output debug information to a file.
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="">import logging 
logging.basicConfig(filename=&quot;mylog.log&quot;, level=logging.DEBUG)</code></pre>
                     
                     <p>If you&#x2019;re using the Boto Python interface for AWS, you can set the debug level to
                        two
                        as per the Boto docs, <a href="http://docs.pythonboto.org/en/latest/boto_config_tut.html#boto" target="_blank">here</a>.
                     </p>
                     
                     
                     
                     <h4 id="ruby-request-id">Using the SDK for Ruby to Obtain Request IDs</h4>
                     
                     
                     <p>You can get your request IDs using either the SDK for Ruby - Version 1, Version 2,
                        or Version 3.
                     </p>
                     
                     <div class="itemizedlist">
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p><b>Using the SDK for Ruby - Version 1</b>&#x2013; You can
                                 enable HTTP wire logging globally with the following line of code.
                              </p>
                              <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="">s3 = AWS::S3.new(:logger =&gt; Logger.new($stdout), :http_wire_trace =&gt; true)</code></pre>
                              </li>
                           <li class="listitem">
                              
                              <p><b>Using the SDK for Ruby - Version 2 or Version 3</b>&#x2013; You can
                                 enable HTTP wire logging globally with the following line of code.
                              </p>
                              <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="">s3 = Aws::S3::Client.new(:logger =&gt; Logger.new($stdout), :http_wire_trace =&gt; true)</code></pre>
                              </li>
                        </ul>
                     </div>
                     
                     
                     
                     
                     
                     <h3 id="cli-request-id">Using the AWS CLI to Obtain Request IDs</h3>
                     
                     
                     <p>You can get your request IDs in the AWS CLI by adding <code class="code">--debug</code> to your
                        command.
                     </p>
                     
                     
                     
                     
                     <h2 id="related-troubleshooting-topics">Related Topics</h2>
                     
                     
                     <p>For other troubleshooting and support topics, see the following:</p>
                     
                     <div class="itemizedlist">
                        
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p><a href="cors-troubleshooting.html">Troubleshooting CORS Issues</a></p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p><a href="HandlingErrors.html">Handling REST and SOAP Errors</a></p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p><a href="https://aws.amazon.com/documentation/aws-support/" target="_blank">AWS Support
                                    Documentation</a></p>
                              
                           </li>
                        </ul>
                     </div>
                     
                     <p>For troubleshooting information regarding third-party tools, see <a href="https://forums.aws.amazon.com/thread.jspa?threadID=182409" target="_blank">Getting Amazon S3 request
                           IDs</a> in the AWS Developer Forums.
                     </p>
                     
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be enabled. Please refer to your browser's
                                    Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="ErrorBestPractices.html">&#xAB; Previous </a><a class="awstoc" accesskey="n" href="ServerLogs.html">Next &#xBB;</a></div>
                     <div id="copyright-main-footer">&#xA9; 2018, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="Troubleshooting Amazon S3 by Symptom"><a class="pagetoc" href="#troubleshooting-by-symptom">Troubleshooting Amazon S3 by Symptom</a></li>
                        <li class="pagetoc" name="Getting Amazon S3 Request IDs for AWS Support"><a class="pagetoc" href="#get-request-ids">Getting Amazon S3 Request IDs for AWS Support</a></li>
                        <li class="pagetoc" name="Related Topics"><a class="pagetoc" href="#related-troubleshooting-topics">Related Topics</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='Amazon Simple Storage Service';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='Developer Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   
</body></html>