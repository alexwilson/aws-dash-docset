<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Deleting or Emptying a Bucket - Amazon Simple Storage Service</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="home" href="#top">
      <link rel="up" href="UsingBucket.html" title="Working with Amazon S3 Buckets">
      <link rel="prev" href="create-bucket-get-location-example.html" title="Examples of Creating a Bucket">
      <link rel="next" href="bucket-encryption.html" title=" Amazon S3 Default Encryption for S3 Buckets">
      <meta name="description" content="Empty and delete a versioned or unversioned Amazon S3 bucket that contains objects.">
      <meta name="deployment_region" content="IAD">
      <meta name="product" content="Amazon Simple Storage Service">
      <meta name="guide" content="Developer Guide">
      <meta name="guide-locale" content="en_us">
      <link rel="icon" type="image/ico" href="/images/favicon.ico">
      <link rel="shortcut icon" type="image/ico" href="/images/favicon.ico">
      <link rel="canonical" href="https://docs.aws.amazon.com/AmazonS3/latest/dev/delete-or-empty-bucket.html">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/font-awesome.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/google-font.css">
      <link id="code-style" rel="stylesheet" type="text/css" href="../../../css/light.css">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.theme.css">
      <link rel="stylesheet" type="text/css" href="../../../css/colorbox.css">
      <link rel="stylesheet" type="text/css" href="../../../css/awsdocs.css"><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="/js/jquery-ui.min.js"></script><script type="text/javascript" src="/js/handlebars.js"></script><script type="text/javascript" src="/js/jquery.colorbox.js"></script><script type="text/javascript" src="/js/awsdocs.min.js?v=20170615"></script></head>
   <body id="top">
      
      <div id="content-container">
         
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tbody><tr>
                           <td>
                              <div class="breadcrumb"><a href="http://aws.amazon.com/documentation">AWS Documentation</a> &#xBB; <a href="http://aws.amazon.com/documentation/s3">Amazon Simple Storage Service (S3)</a> &#xBB; <a href="index.html">Developer Guide</a> &#xBB; <a href="UsingBucket.html">Working with Amazon S3 Buckets</a> &#xBB; <span class="breadcrumb">Deleting or Emptying a Bucket</span></div>
                           </td>
                        </tr>
                     </tbody></table>
                     <div></div>
                     <h1 class="topictitle" id="delete-or-empty-bucket">Deleting or Emptying a Bucket</h1>
                     <p>It is easy to delete an empty bucket. However, in some situations, you may need to
                        delete or
                        empty a bucket that contains objects. In this section, we&apos;ll explain how to delete
                        objects
                        in an unversioned bucket, and how to delete object versions and delete markers
                        in a bucket that has versioning enabled. For more information about versioning, see
                        <a href="Versioning.html">Using Versioning</a>. In some situations, you may choose to
                        empty a bucket instead of deleting it. This section explains various options you can
                        use to
                        delete or empty a bucket that contains objects.
                     </p>
                     <div class="highlights" id="inline-topiclist">
                        <p><strong>Topics</strong></p>
                        <ul>
                           <li><a href="#delete-bucket">Delete a Bucket</a></li>
                           <li><a href="#empty-bucket">Empty a Bucket</a></li>
                        </ul>
                     </div>
                     
                     <h2 id="delete-bucket">Delete a Bucket</h2>
                     
                     <p>You can delete a bucket and its content programmatically using the AWS SDKs. You can
                        also use lifecycle configuration on a bucket to empty its content and then delete
                        the
                        bucket. There are additional options, such as using Amazon S3 console and AWS CLI,
                        but there
                        are limitations on these methods based on the number of objects in your bucket and
                        the
                        bucket&apos;s versioning status.
                     </p>
                     
                     
                     <h3 id="delete-bucket-console">Delete a Bucket: Using the Amazon S3
                        Console
                     </h3>
                     
                     <p>The Amazon S3 console supports deleting a bucket that may or may not be empty. For
                        information about using the Amazon S3 console to delete a bucket, see <a href="./AmazonS3/latest/user-guide/delete-bucket.html" target="_blank">How Do I Delete an S3 Bucket?</a> in
                        the <em>Amazon Simple Storage Service Console User Guide</em>.
                     </p>
                     
                     
                     
                     <h3 id="delete-bucket-awscli">Delete a Bucket: Using the AWS CLI</h3>
                     
                     <p>You can delete a bucket that contains objects using the AWS CLI only if the bucket
                        does not have versioning enabled. If your bucket does not have versioning enabled,
                        you can use the <code class="code">rb</code> (remove bucket) AWS CLI command with
                        <code class="code">--force</code> parameter to remove a non-empty bucket. This command
                        deletes all objects first and then deletes the bucket.
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="">  $ aws s3 rb s3://bucket-name --force  </code></pre>
                     <p>For more information, see <a href="./cli/latest/userguide/using-s3-commands.html" target="_blank">Using
                           High-Level S3 Commands with the AWS Command Line Interface</a> in the
                        AWS Command Line Interface User Guide.
                     </p>
                     
                     <p>To delete a non-empty bucket that does not have versioning enabled, you have the
                        following options:
                     </p>
                     
                     <div class="itemizedlist">
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p>Delete the bucket programmatically using the AWS SDK. </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>Delete all of the objects using the bucket&apos;s lifecycle configuration and
                                 then delete the empty bucket using the Amazon S3 console. 
                              </p>
                              
                           </li>
                        </ul>
                     </div>
                     
                     
                     
                     <h3 id="delete-bucket-lifecycle">Delete a Bucket: Using Lifecycle
                        Configuration
                     </h3>
                     
                     <p>You can configure lifecycle on your bucket to expire objects, Amazon S3 then deletes
                        expired objects. You can add lifecycle configuration rules to expire all or a subset
                        of objects with a specific key name prefix. For example, to remove all objects in
                        a
                        bucket, you can set a lifecycle rule to expire objects one day after
                        creation.
                     </p>
                     
                     <p>If your bucket has versioning enabled, you can also configure the rule to expire
                        noncurrent objects. 
                     </p>
                     
                     <p>After Amazon S3 deletes all of the objects in your bucket, you can delete the bucket
                        or
                        keep it. 
                     </p>
                     
                     <div class="aws-note">
                        <p class="aws-note">Important</p>
                        <p>If you just want to empty the bucket and not delete it, make sure you remove
                           the lifecycle configuration rule you added to empty the bucket so that any new
                           objects you create in the bucket will remain in the bucket.
                        </p>
                     </div>
                     
                     <p>For more information, see <a href="object-lifecycle-mgmt.html">Object Lifecycle Management</a> and <a href="lifecycle-expire-general-considerations.html">Configuring Object
                           Expiration</a>. 
                     </p>
                     
                     
                     
                     <h3 id="delete-bucket-awssdks">Delete a Bucket: Using the AWS SDKs</h3>
                     
                     <p>You can use the AWS SDKs to delete a bucket. The following sections provide
                        examples of how to delete a bucket using the AWS SDK for Java and .NET. First, the
                        code deletes objects in the bucket and then it deletes the bucket. For information
                        about other AWS SDKs, see <a href="https://aws.amazon.com/tools/" target="_blank">Tools for Amazon Web
                           Services</a>.
                     </p>
                     
                     
                     <h4 id="delete-bucket-sdk-java">Delete a Bucket Using the
                        AWS SDK for Java
                     </h4>
                     
                     <p>The following Java example deletes a bucket that contains objects. The example
                        deletes all objects, and then it deletes the bucket. The example works for
                        buckets with or without versioning enabled.
                     </p>
                     
                     <div class="aws-note">
                        <p class="aws-note">Note</p>
                        <p>For buckets without versioning enabled, you can delete all objects
                           directly and then delete the bucket. For buckets with versioning enabled,
                           you must delete all object versions before deleting the bucket.
                        </p>
                     </div>
                     
                     <p>For instructions on creating and testing a working sample, see <a href="UsingTheMPJavaAPI.html#TestingJavaSamples">Testing the Amazon S3 Java Code Examples</a>. 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="java ">import java.util.Iterator;

import com.amazonaws.AmazonServiceException;
import com.amazonaws.SdkClientException;
import com.amazonaws.auth.profile.ProfileCredentialsProvider;
import com.amazonaws.services.s3.AmazonS3;
import com.amazonaws.services.s3.AmazonS3ClientBuilder;
import com.amazonaws.services.s3.model.ListVersionsRequest;
import com.amazonaws.services.s3.model.ObjectListing;
import com.amazonaws.services.s3.model.S3ObjectSummary;
import com.amazonaws.services.s3.model.S3VersionSummary;
import com.amazonaws.services.s3.model.VersionListing;

public class DeleteBucket {

    public static void main(String[] args) {
        String clientRegion = &quot;*** Client region ***&quot;;
        String bucketName = &quot;*** Bucket name ***&quot;;

        try {
            AmazonS3 s3Client = AmazonS3ClientBuilder.standard()
                    .withCredentials(new ProfileCredentialsProvider())
                    .withRegion(clientRegion)
                    .build();
    
            // Delete all objects from the bucket. This is sufficient
            // for unversioned buckets. For versioned buckets, when you attempt to delete objects, Amazon S3 inserts
            // delete markers for all objects, but doesn&apos;t delete the object versions.
            // To delete objects from versioned buckets, delete all of the object versions before deleting
            // the bucket (see below for an example).
            ObjectListing objectListing = s3Client.listObjects(bucketName);
            while (true) {
                Iterator&lt;S3ObjectSummary&gt; objIter = objectListing.getObjectSummaries().iterator();
                while (objIter.hasNext()) {
                    s3Client.deleteObject(bucketName, objIter.next().getKey());
                }
    
                // If the bucket contains many objects, the listObjects() call
                // might not return all of the objects in the first listing. Check to
                // see whether the listing was truncated. If so, retrieve the next page of objects 
                // and delete them.
                if (objectListing.isTruncated()) {
                    objectListing = s3Client.listNextBatchOfObjects(objectListing);
                } else {
                    break;
                }
            }
    
            // Delete all object versions (required for versioned buckets).
            VersionListing versionList = s3Client.listVersions(new ListVersionsRequest().withBucketName(bucketName));
            while (true) {
                Iterator&lt;S3VersionSummary&gt; versionIter = versionList.getVersionSummaries().iterator();
                while (versionIter.hasNext()) {
                    S3VersionSummary vs = versionIter.next();
                    s3Client.deleteVersion(bucketName, vs.getKey(), vs.getVersionId());
                }
    
                if (versionList.isTruncated()) {
                    versionList = s3Client.listNextBatchOfVersions(versionList);
                } else {
                    break;
                }
            }
    
            // After all objects and object versions are deleted, delete the bucket.
            s3Client.deleteBucket(bucketName);
        }
        catch(AmazonServiceException e) {
            // The call was transmitted successfully, but Amazon S3 couldn&apos;t process 
            // it, so it returned an error response.
            e.printStackTrace();
        }
        catch(SdkClientException e) {
            // Amazon S3 couldn&apos;t be contacted for a response, or the client couldn&apos;t
            // parse the response from Amazon S3.
            e.printStackTrace();
        }
    }
}
</code></pre>
                     
                     
                     <h2 id="empty-bucket">Empty a Bucket</h2>
                     
                     
                     <p>You can empty a bucket&apos;s content (that is, delete all content, but keep the bucket)
                        programmatically using the AWS SDK. You can also specify lifecycle configuration on
                        a
                        bucket to expire objects so that Amazon S3 can delete them. There are additional options,
                        such as using Amazon S3 console and AWS CLI, but there are limitations on this method
                        based
                        on the number of objects in your bucket and the bucket&apos;s versioning status.
                     </p>
                     
                     <div class="highlights" id="inline-topiclist">
                        <p><strong>Topics</strong></p>
                        <ul>
                           <li><a href="#empty-bucket-console">Empty a Bucket: Using the Amazon S3 console</a></li>
                           <li><a href="#empty-bucket-awscli">Empty a Bucket: Using the AWS CLI</a></li>
                           <li><a href="#empty-bucket-lifecycle">Empty a Bucket: Using Lifecycle
                                 Configuration</a></li>
                           <li><a href="#empty-bucket-awssdks">Empty a Bucket: Using the AWS SDKs</a></li>
                        </ul>
                     </div>
                     
                     <h3 id="empty-bucket-console">Empty a Bucket: Using the Amazon S3 console</h3>
                     
                     
                     <p>For information about using the Amazon S3 console to empty a bucket, see <a href="./AmazonS3/latest/user-guide/empty-bucket.html.html" target="_blank">How Do I Empty an S3 Bucket?</a> in the
                        <em>Amazon Simple Storage Service Console User Guide</em></p>
                     
                     
                     <h3 id="empty-bucket-awscli">Empty a Bucket: Using the AWS CLI</h3>
                     
                     
                     <p>You can empty a bucket using the AWS CLI only if the bucket does not have
                        versioning enabled. If your bucket does not have versioning enabled, you can use the
                        <code class="code">rm</code> (remove) AWS CLI command with the <code class="code">--recursive</code>
                        parameter to empty a bucket (or remove a subset of objects with a specific key name
                        prefix). 
                     </p>
                     
                     <p>The following <code class="code">rm</code> command removes objects with key name prefix
                        <code class="code">doc</code>, for example, <code class="code">doc/doc1</code> and
                        <code class="code">doc/doc2</code>.
                     </p>
                     
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="">$ aws s3 rm s3://bucket-name/doc --recursive</code></pre>
                     
                     <p>Use the following command to remove all objects without specifying a
                        prefix.
                     </p>
                     
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="">$ aws s3 rm s3://bucket-name --recursive</code></pre>
                     
                     <p>For more information, see <a href="./cli/latest/userguide/using-s3-commands.html" target="_blank">Using
                           High-Level S3 Commands with the AWS Command Line Interface</a> in the
                        AWS Command Line Interface User Guide.
                     </p>
                     
                     
                     <div class="aws-note">
                        <p class="aws-note">Note</p>
                        <p>You cannot remove objects from a bucket with versioning enabled. Amazon S3 adds
                           a delete marker when you delete an object, which is what this command will
                           do. For more information about versioning, see <a href="Versioning.html">Using Versioning</a>.
                        </p>
                     </div>
                     
                     
                     <p>To empty a bucket with versioning enabled, you have the following options:</p>
                     
                     
                     <div class="itemizedlist">
                        
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p>Delete the bucket programmatically using the AWS SDK. </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>Use the bucket&apos;s lifecycle configuration to request that Amazon S3 delete
                                 the objects. 
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>Use the Amazon S3 console (can only use this option if your bucket contains
                                 less than 100,000 items&#x2014;including both object versions and delete
                                 markers).
                              </p>
                              
                           </li>
                        </ul>
                     </div>
                     
                     
                     
                     <h3 id="empty-bucket-lifecycle">Empty a Bucket: Using Lifecycle
                        Configuration
                     </h3>
                     
                     
                     <p>You can configure lifecycle on your bucket to expire objects and request that Amazon
                        S3
                        delete expired objects. You can add lifecycle configuration rules to expire all or
                        a
                        subset of objects with a specific key name prefix. For example, to remove all
                        objects in a bucket, you can set lifecycle rule to expire objects one day after
                        creation.
                     </p>
                     
                     <p>If your bucket has versioning enabled, you can also configure the rule to expire
                        noncurrent objects. 
                     </p>
                     
                     
                     <div class="aws-note">
                        <p class="aws-note">Warning</p>
                        <p>After your objects expire, Amazon S3 deletes the expired objects. If you just
                           want to empty the bucket and not delete it, make sure you remove the
                           lifecycle configuration rule you added to empty the bucket so that any new
                           objects you create in the bucket will remain in the bucket.
                        </p>
                     </div>
                     
                     
                     <p>For more information, see <a href="object-lifecycle-mgmt.html">Object Lifecycle Management</a> and <a href="lifecycle-expire-general-considerations.html">Configuring Object
                           Expiration</a>.
                     </p>
                     
                     
                     <h3 id="empty-bucket-awssdks">Empty a Bucket: Using the AWS SDKs</h3>
                     
                     
                     <p>You can use the AWS SDKs to empty a bucket or remove a subset of objects with a
                        specific key name prefix.
                     </p>
                     
                     <p>For an example of how to empty a bucket using AWS SDK for Java, see <a href="delete-or-empty-bucket.html#delete-bucket-sdk-java">Delete a Bucket Using the
                           AWS SDK for Java</a>. The
                        code deletes all objects, regardless of whether the bucket has versioning enabled
                        or
                        not, and then it deletes the bucket. To just empty the bucket, make sure you remove
                        the statement that deletes the bucket. 
                     </p>
                     
                     <p>For more information about using other AWS SDKs, see <a href="https://aws.amazon.com/tools/" target="_blank">Tools for Amazon Web Services</a>.
                     </p>
                     
                     
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be enabled. Please refer to your browser's
                                    Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="create-bucket-get-location-example.html">&#xAB; Previous </a><a class="awstoc" accesskey="n" href="bucket-encryption.html">Next &#xBB;</a></div>
                     <div id="copyright-main-footer">&#xA9; 2018, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="Delete a Bucket"><a class="pagetoc" href="#delete-bucket">Delete a Bucket</a></li>
                        <li class="pagetoc" name="Empty a Bucket"><a class="pagetoc" href="#empty-bucket">Empty a Bucket</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='Amazon Simple Storage Service';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='Developer Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   
</body></html>