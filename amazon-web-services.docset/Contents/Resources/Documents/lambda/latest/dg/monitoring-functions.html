<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Using Amazon CloudWatch - AWS Lambda</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="home" href="#top">
      <link rel="up" href="troubleshooting.html" title="Monitoring and Troubleshooting Lambda-based Applications">
      <link rel="prev" href="troubleshooting.html" title="Monitoring and Troubleshooting Lambda-based Applications">
      <link rel="next" href="monitoring-functions-access-metrics.html" title="Accessing Amazon CloudWatch Metrics for AWS Lambda">
      <meta name="description" content="AWS Lambda automatically monitors Lambda functions on your behalf, reporting metrics through Amazon CloudWatch. To help you monitor your code as it executes, Lambda automatically tracks the number of requests, the latency per request, and the number of requests resulting in an error and publishes the associated CloudWatch metrics. You can leverage these metrics to set CloudWatch custom alarms. For more information about CloudWatch, see the">
      <meta name="deployment_region" content="IAD">
      <meta name="product" content="AWS Lambda">
      <meta name="guide" content="Developer Guide">
      <meta name="guide-locale" content="en_us">
      <link rel="icon" type="image/ico" href="/images/favicon.ico">
      <link rel="shortcut icon" type="image/ico" href="/images/favicon.ico">
      <link rel="canonical" href="https://docs.aws.amazon.com/lambda/latest/dg/monitoring-functions.html">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/font-awesome.min.css">
      <link rel="stylesheet" type="text/css" href="../../../css/google-font.css">
      <link id="code-style" rel="stylesheet" type="text/css" href="../../../css/light.css">
      <link rel="stylesheet" type="text/css" href="../../../css/jquery-ui.theme.css">
      <link rel="stylesheet" type="text/css" href="../../../css/colorbox.css">
      <link rel="stylesheet" type="text/css" href="../../../css/awsdocs.css"><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="/js/jquery-ui.min.js"></script><script type="text/javascript" src="/js/handlebars.js"></script><script type="text/javascript" src="/js/jquery.colorbox.js"></script><script type="text/javascript" src="/js/awsdocs.min.js?v=20170615"></script></head>
   <body id="top">
      
      <div id="content-container">
         
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tbody><tr>
                           <td>
                              <div class="breadcrumb"><a href="http://aws.amazon.com/documentation">AWS Documentation</a> &#xBB; <a href="http://aws.amazon.com/documentation/lambda">AWS Lambda</a> &#xBB; <a href="index.html">Developer Guide</a> &#xBB; <a href="troubleshooting.html">Monitoring and Troubleshooting Lambda-based Applications</a> &#xBB; <span class="breadcrumb">Using Amazon CloudWatch</span></div>
                           </td>
                        </tr>
                     </tbody></table>
                     <div></div>
                     <h1 class="topictitle" id="monitoring-functions">Using Amazon CloudWatch</h1>
                     <p>AWS Lambda automatically monitors Lambda functions on your behalf, reporting metrics
                        through
                        Amazon CloudWatch. To help you monitor your code as it executes, Lambda automatically
                        tracks the
                        number of requests, the latency per request, and the number of requests resulting
                        in an
                        error and publishes the associated CloudWatch metrics. You can leverage these metrics
                        to set CloudWatch
                        custom alarms. For more information about CloudWatch, see the <a href="./AmazonCloudWatch/latest/DeveloperGuide/" target="_blank">Amazon CloudWatch User Guide</a>.
                     </p>
                     <p>You can view request rates and error rates for each of your Lambda functions
                        by using the AWS Lambda console, the CloudWatch console, and other Amazon Web Services
                        (AWS) resources.
                        
                        The following topics describe Lambda CloudWatch metrics and how to access them.
                     </p>
                     <div class="itemizedlist">
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              <p><a href="monitoring-functions-access-metrics.html">Accessing Amazon CloudWatch Metrics for AWS Lambda</a></p>
                           </li>
                           <li class="listitem">
                              <p><a href="monitoring-functions-metrics.html">AWS Lambda Metrics</a></p>
                           </li>
                        </ul>
                     </div>
                     <p>You can insert logging statements into your code to help you validate that your code
                        is
                        working as expected. Lambda automatically integrates with Amazon CloudWatch Logs and
                        pushes all logs from
                        your code to a CloudWatch Logs group associated with a Lambda function (/aws/lambda/<em class="replaceable"><code>&lt;function name&gt;</code></em>).
                        To learn more about log groups and accessing them through the CloudWatch console,
                        see the <a href="./AmazonCloudWatch/latest/DeveloperGuide/WhatIsCloudWatchLogs.html" target="_blank">Monitoring System, Application, and Custom
                           Log Files</a> in the <em>Amazon CloudWatch User Guide</em>. For information about how to access CloudWatch log entries, 
                        see <a href="monitoring-functions-logs.html">Accessing Amazon CloudWatch Logs for AWS Lambda</a>.
                     </p>
                     <div class="aws-note">
                        <p class="aws-note">Note</p>
                        <p>If your Lambda function code is executing, but you don&apos;t see any log data being
                           generated after several minutes, this could mean your execution role for the Lambda
                           function did not grant permissions to write log data to CloudWatch Logs. For information
                           about how
                           to make sure that you have set up the execution role correctly to
                           grant these permissions, see <a href="intro-permission-model.html#lambda-intro-execution-role">Manage Permissions: Using an IAM Role
                              (Execution Role)</a>.
                        </p>
                     </div>
                     <h2 id="monitoring-functions-troubleshooting">AWS Lambda Troubleshooting Scenarios</h2>
                     
                     
                     
                     <p> This sections describes examples of how to monitor and troubleshoot your Lambda
                        functions using the logging and monitoring capabilities of CloudWatch. 
                     </p>
                     
                     <h3 id="monitoring-functions-troubleshooting-one">Troubleshooting Scenario 1: Lambda Function 
                        Not Working as Expected
                     </h3>
                     
                     
                     
                     
                     <p> In this scenario, you have just finished <a href="with-s3-example.html">Tutorial: Using AWS Lambda with Amazon S3</a>. However, the Lambda function you
                        created to upload a thumbnail image to Amazon S3 when you create an S3 object is not
                        working
                        as expected. When you upload objects to Amazon S3, you see that the thumbnail images
                        are not being uploaded. You can troubleshoot this issue in the following
                        ways. 
                     </p>
                     
                     <p class="title"><b>To determine why your Lambda function is not working as expected</b></p>
                     <ol>
                        <li>        
                           
                           <p>Check your code and verify that it is working correctly. An increased error rate would
                              indicate that it is not.
                           </p>
                           
                           
                           <p>You can test your code locally as you would any other Node.js function, or
                              you can test it within the Lambda console using the console&apos;s test invoke functionality,
                              
                              or you can use the AWS CLI <code class="code">Invoke</code> command. Each
                              time the code is executed in response to an event, it writes a log entry
                              into the log group associated with a Lambda function, which is
                              /aws/lambda/<em class="replaceable"><code>&lt;function name&gt;</code></em>. 
                           </p>
                           
                           <p>Following are some examples of errors that might show up in the logs:</p>
                           
                           <div class="itemizedlist">
                              
                              
                              
                              
                              
                              <ul class="itemizedlist" type="disc">
                                 <li class="listitem">
                                    <p>If you see a stack trace in your log, there is probably an error in your code. Review
                                       your
                                       code and debug the error that the stack trace refers to.
                                    </p>
                                 </li>
                                 <li class="listitem">
                                    <p>If you see a <code class="code">permissions denied</code> error in the log, the IAM role you have provided as an
                                       execution role may not have the necessary
                                       permissions. Check the IAM role and verify that it has all of the necessary
                                       permissions to access any AWS resources that your code references. To
                                       ensure that you have correctly set up the execution
                                       role, see <a href="intro-permission-model.html#lambda-intro-execution-role">Manage Permissions: Using an IAM Role
                                          (Execution Role)</a>. 
                                    </p>
                                 </li>
                                 <li class="listitem">
                                    <p> If you see a <code class="code">timeout exceeded</code> error in the log, your timeout setting
                                       exceeds the run time of your function code. This may be because the timeout is too
                                       low,
                                       or the code is taking too long to execute.  
                                    </p>
                                 </li>
                                 <li class="listitem">
                                    <p> If you see a <code class="code">memory exceeded</code> error in the log, your memory setting is too low. Set it to a
                                       higher value. For information about memory size limits, see <a href="API_CreateFunction.html">CreateFunction</a>. 
                                       When you change the memory setting, it can also change how you are charged for <a href="https://aws.amazon.com/lambda/pricing" target="_blank">AWS Lambda product website</a> duration.
                                    </p>
                                    <p> For information
                                       about pricing, see the <a href="https://aws.amazon.com/lambda" target="_blank">AWS Lambda product website</a>.
                                    </p>
                                 </li>
                              </ul>
                           </div>
                           
                        </li>
                        <li>
                           
                           <p>Check your Lambda function and verify that it is receiving requests. </p>
                           
                           <p> Even if your function code is working as expected and responding
                              correctly to test invokes, the function may not be receiving requests from
                              Amazon S3. If Amazon S3 is able to invoke the function, you should see an increase
                              in
                              your CloudWatch requests metrics. If you do not see an increase in your CloudWatch
                              requests, check the access permissions policy associated with the
                              function.
                           </p>
                           
                        </li>
                     </ol>
                     
                     
                     
                     <h3 id="monitoring-functions-troubleshooting-two">Troubleshooting Scenario 2: Increased Latency in Lambda Function Execution</h3>
                     
                     
                     
                     
                     <p> In this scenario, you have just finished <a href="with-s3-example.html">Tutorial: Using AWS Lambda with Amazon S3</a>. However, the Lambda function you created 
                        to upload a thumbnail image to Amazon S3 when you create an S3 object is not working
                        as expected.
                        When you upload objects to Amazon S3, you can see that the thumbnail images are being
                        uploaded, but your code is taking much longer to execute than expected. You can
                        troubleshoot this issue in a couple of different ways. For example, you could monitor
                        the latency
                        CloudWatch metric for the Lambda function to see if the latency is increasing. Or
                        you could
                        see an increase in the CloudWatch errors metric for the Lambda function, which might
                        be due to timeout errors.
                     </p>
                     
                     <p class="title"><b>To determine why there is increased latency in the execution of a Lambda
                           function</b></p>
                     <ol>
                        <li>                    
                           
                           <p>Test your code with different memory settings.</p>
                           
                           <p>If your code is taking too long to execute, it could be that it does not
                              have enough compute resources to execute its logic. Try increasing the
                              memory allocated to your function and testing the code again, using the
                              Lambda console&apos;s test invoke functionality. You can see the memory used, code
                              execution time, and memory allocated in the function log entries. 
                              Changing the memory setting can change how you are charged for duration. 
                              For information about pricing, see <a href="https://aws.amazon.com/lambda/" target="_blank">AWS Lambda</a>.
                           </p> 
                           
                        </li>
                        <li>   
                           
                           <p>Investigate the source of the execution bottleneck that is using logs.</p>
                           
                           <p>You can test your code locally, as you would with any other Node.js function, or
                              you can test it within Lambda using the test invoke capability on the Lambda
                              console, or using the <code class="code">asyncInvoke</code> command by using AWS CLI. Each time
                              the code is executed in response to an event, it writes a log entry into the
                              log group associated with a Lambda function, which is named
                              aws/lambda/<em class="replaceable"><code>&lt;function name&gt;</code></em>. Add logging statements around various parts
                              of your code, such as callouts to other services, to see how much time it takes to
                              
                              execute different parts of your code. 
                           </p>
                           
                        </li>
                     </ol>
                     
                     
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be enabled. Please refer to your browser's
                                    Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="troubleshooting.html">&#xAB; Previous </a><a class="awstoc" accesskey="n" href="monitoring-functions-access-metrics.html">Next &#xBB;</a></div>
                     <div id="copyright-main-footer">&#xA9; 2018, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="AWS Lambda Troubleshooting Scenarios"><a class="pagetoc" href="#monitoring-functions-troubleshooting">Troubleshooting Scenarios</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='AWS Lambda';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='Developer Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   
</body></html>